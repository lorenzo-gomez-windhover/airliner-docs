<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="cfshkopr" kind="page">
    <compoundname>cfshkopr</compoundname>
    <title>CFS Housekeeping Operation</title>
    <detaileddescription>
<para>The operational interface of the HK application consists of two commands, two tables and a few telemetry points. The following items detail the operational interface.</para><para><heading level="2">1. The application version number</heading>
</para><para>The application version number is displayed in the initialization event and the no-op event. Both events are &apos;informational&apos; type and are unfiltered by default.</para><para><heading level="2">2. Loading the copy table</heading>
</para><para>The copy table is loaded by way of a file. The file must be present when the application starts up. Otherwise, the app will terminate after initialization. The location of the file is specified by the platform configuration parameter named <ref refid="hk__platform__cfg_8h_1ad363a25be94649183924265a90d69302" kindref="member">HK_COPY_TABLE_FILENAME</ref>. The value of this define specifies the full path as well as the filename.</para><para>After initialization, a new copy table may be loaded at any time. The steps to load a new copy table are:<linebreak/>
<itemizedlist>
<listitem><para>Transfer the table file to the on-board file system <linebreak/>
</para></listitem><listitem><para>Send the <ref refid="cfe__tbl__msg_8h_1a9b03cc36b2894db18e00a70c89a1795f" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">cFE Table load command </ref><linebreak/>
</para></listitem><listitem><para>Send the <ref refid="cfe__tbl__msg_8h_1aafeae2981c35e35e8773a8c60b7553c9" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">cFE Table validate command </ref><linebreak/>
</para></listitem><listitem><para>Send the <ref refid="cfe__tbl__msg_8h_1ab3fa1511e81c576198b96de7f10ba397" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">cFE Table activate command </ref><linebreak/>
</para></listitem></itemizedlist>
</para><para>The HK application will clean up the items used for the old table (such as SB subscriptions) before updating and processing the new table.</para><para><heading level="2">3. Sending the No-op Command</heading>
</para><para>To verify connectivity with the Housekeeping application, the ground may send an <ref refid="hk__msgdefs_8h_1a4aaaf68fcc46a34be10ee4eda5616bff" kindref="member">HK No-op command</ref>. If the packet length field in the command is set to the value expected by the HK app, then the command counter will increment and a <ref refid="" kindref="compound">no-op informational event message </ref> will be sent. This no-op event will show the version number of the HK application.</para><para><heading level="2">4. Sending the reset counters command</heading>
</para><para>The <ref refid="hk__msgdefs_8h_1a46f0ca4aa6a39c7dae8cf6630df701f6" kindref="member">reset counters command </ref> will reset only the telemetry points listed here: <linebreak/>
 a. <ref refid="struct_h_k___hk_packet__t_1a51536f413198ecb9616aadb677a8a805" kindref="member">Command counter </ref><linebreak/>
 b. <ref refid="struct_h_k___hk_packet__t_1a6caa874846161f70ba9a7c5b4748036a" kindref="member">Command error counter </ref><linebreak/>
 c. <ref refid="struct_h_k___hk_packet__t_1a13ec0e82e1c3a1ec730ca4be0692eb83" kindref="member">Combined packets sent counter </ref><linebreak/>
 d. <ref refid="struct_h_k___hk_packet__t_1a94934404119555095e342022a5ad3af1" kindref="member">Missing Data counter </ref><linebreak/>
</para><para><heading level="2">5. Monitoring the command counter</heading>
</para><para>The <ref refid="struct_h_k___hk_packet__t_1a51536f413198ecb9616aadb677a8a805" kindref="member">command counter </ref> will increment only when the HK application receives a valid <ref refid="hk__msgdefs_8h_1a4aaaf68fcc46a34be10ee4eda5616bff" kindref="member">HK No-op command</ref>.</para><para><heading level="2">6. Monitoring the command error counter</heading>
</para><para>The <ref refid="struct_h_k___hk_packet__t_1a6caa874846161f70ba9a7c5b4748036a" kindref="member">Command error counter </ref> will increment under the following conditions: <linebreak/>
 a. Invalid command code <linebreak/>
 b. Unexpected packet length field for <ref refid="hk__msgids_8h_1af1d0c701d743a1c9dec8fbb7b9d36141" kindref="member">&apos;Send Combined Tlm&apos; </ref> command <linebreak/>
 c. Unexpected packet length field for <ref refid="hk__msgids_8h_1a8a61ed97e1521ce29e32e3e80197eaf1" kindref="member">&apos;Send HK Housekeeping&apos; </ref> command <linebreak/>
 d. Unexpected packet length field for <ref refid="hk__msgdefs_8h_1a4aaaf68fcc46a34be10ee4eda5616bff" kindref="member">&apos;HK No-op&apos;</ref> command <linebreak/>
 e. Unexpected packet length field for <ref refid="hk__msgdefs_8h_1a46f0ca4aa6a39c7dae8cf6630df701f6" kindref="member">&apos;Reset Counters&apos;</ref> command <linebreak/>
</para><para><heading level="2">7. Monitoring the &apos;Combined Packets Sent" counter</heading>
</para><para>Each time a <ref refid="hk__msgids_8h_1af1d0c701d743a1c9dec8fbb7b9d36141" kindref="member">&apos;Send Combined Tlm&apos; </ref> command is received without error the <ref refid="struct_h_k___hk_packet__t_1a13ec0e82e1c3a1ec730ca4be0692eb83" kindref="member">Combined packets sent counter </ref> will increment.</para><para><heading level="2">8. Monitoring the &apos;Missing Data" counter</heading>
</para><para>Each time a <ref refid="hk__msgids_8h_1af1d0c701d743a1c9dec8fbb7b9d36141" kindref="member">&apos;Send Combined Tlm&apos; </ref> command is received without error, the HK app begins checking the &apos;Data Present&apos; flag (located in the run-time table) for each of the data sections that make up the output packet. If a data portion is missing, HK sends a debug event (which is filtered by default) and increments the <ref refid="struct_h_k___hk_packet__t_1a94934404119555095e342022a5ad3af1" kindref="member">&apos;Missing Data&apos; </ref> counter. The event will display the Message ID of the input message that would normally provide the missing portion.<linebreak/>
</para><para><bold>NOTE:</bold> HK will report only one missing data portion in any output message. The <ref refid="struct_h_k___hk_packet__t_1a94934404119555095e342022a5ad3af1" kindref="member">&apos;Missing Data&apos; </ref> counter will advance by one count (at most) and send one event (at most) for each <ref refid="hk__msgids_8h_1af1d0c701d743a1c9dec8fbb7b9d36141" kindref="member">&apos;Send Combined Tlm&apos; </ref> command. <linebreak/>
</para><para>The HK app will not zero-out or alter the missing data section(s) in any way. The missing data values will match the last &apos;good&apos; section received.</para><para><heading level="2">9. Using the Memory Pool handle to get mempool stats</heading>
</para><para>The HK memory pool is used to allocate the memory needed to store the output packets. Each time a new copy table is processed, the memory for the output packets is dynamically allocated from the memory pool. The memory pool handle is sent down in the <ref refid="struct_h_k___hk_packet__t" kindref="compound">HK housekeeping telemetry packet</ref>. It is possible to get statistics from the cFE ES application on the memory pool used by this application. The <ref refid="cfe__es__msg_8h_1a2b1c39432940423ef68c4c183abce3d8" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">cFE ES command </ref> used to get statistics will need this memory pool handle as a command parameter.</para><para>Next: <ref refid="cfshkreq" kindref="compound">CFS Housekeeping Requirements</ref> <linebreak/>
 Prev: <ref refid="cfshkovr" kindref="compound">CFS Housekeeping Overview</ref> </para>    </detaileddescription>
  </compounddef>
</doxygen>
