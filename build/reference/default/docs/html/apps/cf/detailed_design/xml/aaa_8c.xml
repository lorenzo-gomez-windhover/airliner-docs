<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="aaa_8c" kind="file" language="C++">
    <compoundname>aaa.c</compoundname>
    <includes local="no">netinet/in.h</includes>
    <includes refid="cfdp_8h" local="yes">cfdp.h</includes>
    <includes refid="cfdp__private_8h" local="yes">cfdp_private.h</includes>
    <incdepgraph>
      <node id="3173">
        <label>misc.h</label>
        <link refid="misc_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3147">
        <label>netinet/in.h</label>
      </node>
      <node id="3160">
        <label>cfdp_syntax.h</label>
        <link refid="cfdp__syntax_8h"/>
      </node>
      <node id="3161">
        <label>cfdp_requires.h</label>
        <link refid="cfdp__requires_8h"/>
        <childnode refid="3154" relation="include">
        </childnode>
      </node>
      <node id="3163">
        <label>validate_user_config.h</label>
        <link refid="validate__user__config_8h"/>
        <childnode refid="3156" relation="include">
        </childnode>
      </node>
      <node id="3149">
        <label>cfdp_provides.h</label>
        <link refid="cfdp__provides_8h"/>
        <childnode refid="3150" relation="include">
        </childnode>
        <childnode refid="3151" relation="include">
        </childnode>
        <childnode refid="3152" relation="include">
        </childnode>
        <childnode refid="3153" relation="include">
        </childnode>
        <childnode refid="3154" relation="include">
        </childnode>
        <childnode refid="3160" relation="include">
        </childnode>
      </node>
      <node id="3165">
        <label>message_class.h</label>
        <link refid="message__class_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3151">
        <label>stdlib.h</label>
      </node>
      <node id="3164">
        <label>structures.h</label>
        <link refid="structures_8h"/>
        <childnode refid="3154" relation="include">
        </childnode>
      </node>
      <node id="3167">
        <label>event.h</label>
        <link refid="event_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3182">
        <label>callbacks.h</label>
        <link refid="callbacks_8h"/>
      </node>
      <node id="3174">
        <label>nak.h</label>
        <link refid="nak_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3154">
        <label>cfdp_data_structures.h</label>
        <link refid="cfdp__data__structures_8h"/>
        <childnode refid="3155" relation="include">
        </childnode>
        <childnode refid="3156" relation="include">
        </childnode>
      </node>
      <node id="3169">
        <label>pdu_as_string.h</label>
        <link refid="pdu__as__string_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3148">
        <label>cfdp.h</label>
        <link refid="cfdp_8h"/>
        <childnode refid="3149" relation="include">
        </childnode>
        <childnode refid="3161" relation="include">
        </childnode>
      </node>
      <node id="3175">
        <label>nak_mem.h</label>
        <link refid="nak__mem_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3180">
        <label>s1.h</label>
        <link refid="s1_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3152">
        <label>string.h</label>
      </node>
      <node id="3159">
        <label>cf_defs.h</label>
        <link refid="cf__defs_8h"/>
      </node>
      <node id="3171">
        <label>machine_list.h</label>
        <link refid="machine__list_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3146">
        <label>apps/cf/fsw/src/PRI/aaa.c</label>
        <link refid="aaa.c"/>
        <childnode refid="3147" relation="include">
        </childnode>
        <childnode refid="3148" relation="include">
        </childnode>
        <childnode refid="3162" relation="include">
        </childnode>
      </node>
      <node id="3153">
        <label>unistd.h</label>
      </node>
      <node id="3177">
        <label>aaa.h</label>
        <link refid="aaa_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
        <childnode refid="3162" relation="include">
        </childnode>
      </node>
      <node id="3166">
        <label>timer.h</label>
        <link refid="timer_8h"/>
        <childnode refid="3155" relation="include">
        </childnode>
      </node>
      <node id="3178">
        <label>r1.h</label>
        <link refid="r1_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3168">
        <label>pdu.h</label>
        <link refid="pdu_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
        <childnode refid="3162" relation="include">
        </childnode>
      </node>
      <node id="3155">
        <label>time.h</label>
      </node>
      <node id="3181">
        <label>s2.h</label>
        <link refid="s2_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3170">
        <label>machine.h</label>
        <link refid="machine_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3157">
        <label>osconfig.h</label>
      </node>
      <node id="3162">
        <label>cfdp_private.h</label>
        <link refid="cfdp__private_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
        <childnode refid="3163" relation="include">
        </childnode>
        <childnode refid="3164" relation="include">
        </childnode>
        <childnode refid="3165" relation="include">
        </childnode>
        <childnode refid="3166" relation="include">
        </childnode>
        <childnode refid="3167" relation="include">
        </childnode>
        <childnode refid="3168" relation="include">
        </childnode>
        <childnode refid="3169" relation="include">
        </childnode>
        <childnode refid="3170" relation="include">
        </childnode>
        <childnode refid="3171" relation="include">
        </childnode>
        <childnode refid="3172" relation="include">
        </childnode>
        <childnode refid="3173" relation="include">
        </childnode>
        <childnode refid="3174" relation="include">
        </childnode>
        <childnode refid="3175" relation="include">
        </childnode>
        <childnode refid="3176" relation="include">
        </childnode>
        <childnode refid="3177" relation="include">
        </childnode>
        <childnode refid="3178" relation="include">
        </childnode>
        <childnode refid="3179" relation="include">
        </childnode>
        <childnode refid="3180" relation="include">
        </childnode>
        <childnode refid="3181" relation="include">
        </childnode>
        <childnode refid="3182" relation="include">
        </childnode>
      </node>
      <node id="3172">
        <label>mib.h</label>
        <link refid="mib_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
        <childnode refid="3162" relation="include">
        </childnode>
      </node>
      <node id="3156">
        <label>cfdp_config.h</label>
        <link refid="cfdp__config_8h"/>
        <childnode refid="3157" relation="include">
        </childnode>
        <childnode refid="3158" relation="include">
        </childnode>
        <childnode refid="3159" relation="include">
        </childnode>
      </node>
      <node id="3176">
        <label>utils.h</label>
        <link refid="utils_8h"/>
      </node>
      <node id="3179">
        <label>r2.h</label>
        <link refid="r2_8h"/>
        <childnode refid="3148" relation="include">
        </childnode>
      </node>
      <node id="3150">
        <label>stdio.h</label>
      </node>
      <node id="3158">
        <label>cf_platform_cfg.h</label>
        <link refid="cf__platform__cfg_8h"/>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" prot="public" static="no">
        <name>NO</name>
        <initializer>0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="103" column="10" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="103" bodyend="-1"/>
        <referencedby refid="aaa_8h_1a4e68a443b69d9065911702f2f0112d53" compoundref="aaa_8c" startline="218" endline="244">aaa__build_metadata_from_put_req</referencedby>
        <referencedby refid="aaa_8h_1a8016d4851bbcdb64b6a4b63c9e52bf60" compoundref="aaa_8c" startline="320" endline="338">aaa__cancel_locally</referencedby>
        <referencedby refid="aaa_8h_1aeb0e512ce199b7b278cb0a92223ffbe0" compoundref="aaa_8c" startline="406" endline="505">aaa__initialize</referencedby>
        <referencedby refid="aaa_8h_1af9b859b15f97846f835fca9103693fa7" compoundref="aaa_8c" startline="388" endline="401">aaa__is_file_size_valid</referencedby>
        <referencedby refid="aaa_8h_1a292abc96e2da36a63b0688b497c2a4fc" compoundref="aaa_8c" startline="510" endline="532">aaa__is_file_structure_valid</referencedby>
        <referencedby refid="aaa_8h_1a125e9d605218cb5b893832e5698d9cc1" compoundref="aaa_8c" startline="552" endline="565">aaa__open_source_file</referencedby>
        <referencedby refid="aaa_8h_1a7ad82ee8a918e60e37786bf20fb7f348" compoundref="aaa_8c" startline="570" endline="634">aaa__open_temp_file</referencedby>
        <referencedby refid="aaa_8h_1a77aeff2d16620a5f809f7a104646e56e" compoundref="aaa_8c" startline="976" endline="1027">aaa__shutdown</referencedby>
        <referencedby refid="aaa_8h_1a87d82085dfccdcd452b27101d36975dc" compoundref="aaa_8c" startline="1068" endline="1101">aaa__transaction_has_finished</referencedby>
        <referencedby refid="cfdp__provides_8h_1a9263c3541844439cf374b3224e2fe70d" compoundref="utils_8c" startline="1186" endline="1240">cfdp_are_these_ids_equal</referencedby>
        <referencedby refid="cfdp__provides_8h_1aeccbdc8b52a76469d5d3ef06c2b8415f" compoundref="utils_8c" startline="1245" endline="1253">cfdp_are_these_trans_equal</referencedby>
        <referencedby refid="cfdp__provides_8h_1a0aa22303b87b3e2b804f07c4b88a8e63" compoundref="utils_8c" startline="1299" endline="1312">cfdp_is_a_trans_being_cancelled</referencedby>
        <referencedby refid="cfdp__provides_8h_1a8f8b521dfe86ec1ad49adcd9fdfea78e" compoundref="utils_8c" startline="1092" endline="1175">cfdp_trans_from_string</referencedby>
        <referencedby refid="event_8h_1a7f8e74a46a1a9fb9e7f6118ff5b11976" compoundref="event_8c" startline="33" endline="129">event__determine_from_pdu_struct</referencedby>
        <referencedby refid="default__filestore_8c_1a2740d8fc39236f1e6b29aa0b0c518a04" compoundref="default__filestore_8c" startline="59" endline="64">is_file_segmented</referencedby>
        <referencedby refid="utils_8c_1a1c0b4744352fc6742102ccdc1c13f59f" compoundref="utils_8c" startline="47" endline="62">m__do_strings_match</referencedby>
        <referencedby refid="default__filestore_8c_1afb5a8cf031c45bfecf68ae4291eb5d50" compoundref="default__filestore_8c" startline="30" endline="41">m__does_file_exist</referencedby>
        <referencedby refid="mib_8h_1a95e5ba6bfc01ec18598cd547e3b71476" compoundref="mib_8c" startline="380" endline="758">mib__set_parameter</referencedby>
        <referencedby refid="misc_8h_1a0e145405991d966fd522e971589f1d64" compoundref="misc_8c" startline="88" endline="93">misc__thaw_all_partners</referencedby>
        <referencedby refid="utils_8h_1acf931ef57f5f05b865356adf1807c8a1" compoundref="utils_8c" startline="76" endline="358">utils__request_from_string</referencedby>
        <referencedby refid="utils_8h_1a63c00f4c72a6c9c2c151b5f1b03dc603" compoundref="utils_8c" startline="387" endline="421">utils__strncat</referencedby>
        <referencedby refid="utils_8h_1af21ecb5dc40dd3c430766df4e1958390" compoundref="utils_8c" startline="363" endline="382">utils__strncpy</referencedby>
      </memberdef>
      <memberdef kind="define" id="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" prot="public" static="no">
        <name>YES</name>
        <initializer>1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="104" column="10" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="104" bodyend="-1"/>
        <referencedby refid="aaa_8h_1af24279f6dc6f1fb0ef928cc515cdb21c" compoundref="aaa_8c" startline="131" endline="145">aaa__abandon_this_transaction</referencedby>
        <referencedby refid="aaa_8h_1a8016d4851bbcdb64b6a4b63c9e52bf60" compoundref="aaa_8c" startline="320" endline="338">aaa__cancel_locally</referencedby>
        <referencedby refid="aaa_8h_1aeb0e512ce199b7b278cb0a92223ffbe0" compoundref="aaa_8c" startline="406" endline="505">aaa__initialize</referencedby>
        <referencedby refid="aaa_8h_1a03cec53085b0a1a2f7da4f72c3330d52" compoundref="aaa_8c" startline="364" endline="383">aaa__is_file_checksum_valid</referencedby>
        <referencedby refid="aaa_8h_1af9b859b15f97846f835fca9103693fa7" compoundref="aaa_8c" startline="388" endline="401">aaa__is_file_size_valid</referencedby>
        <referencedby refid="aaa_8h_1a292abc96e2da36a63b0688b497c2a4fc" compoundref="aaa_8c" startline="510" endline="532">aaa__is_file_structure_valid</referencedby>
        <referencedby refid="aaa_8h_1aab0c4dd6a5085d8e209d817ae0c5203b" compoundref="aaa_8c" startline="537" endline="547">aaa__notice_of_suspension</referencedby>
        <referencedby refid="aaa_8h_1a125e9d605218cb5b893832e5698d9cc1" compoundref="aaa_8c" startline="552" endline="565">aaa__open_source_file</referencedby>
        <referencedby refid="aaa_8h_1a7ad82ee8a918e60e37786bf20fb7f348" compoundref="aaa_8c" startline="570" endline="634">aaa__open_temp_file</referencedby>
        <referencedby refid="aaa_8h_1a77aeff2d16620a5f809f7a104646e56e" compoundref="aaa_8c" startline="976" endline="1027">aaa__shutdown</referencedby>
        <referencedby refid="aaa_8h_1a87d82085dfccdcd452b27101d36975dc" compoundref="aaa_8c" startline="1068" endline="1101">aaa__transaction_has_finished</referencedby>
        <referencedby refid="cf__callbacks_8h_1a43f773fc20256bea246f8c188d52d3fc" compoundref="cf__callbacks_8c" startline="620" endline="623">CF_PduOutputOpen</referencedby>
        <referencedby refid="cfdp__provides_8h_1a9263c3541844439cf374b3224e2fe70d" compoundref="utils_8c" startline="1186" endline="1240">cfdp_are_these_ids_equal</referencedby>
        <referencedby refid="cfdp__provides_8h_1aeccbdc8b52a76469d5d3ef06c2b8415f" compoundref="utils_8c" startline="1245" endline="1253">cfdp_are_these_trans_equal</referencedby>
        <referencedby refid="cfdp__provides_8h_1a0aa22303b87b3e2b804f07c4b88a8e63" compoundref="utils_8c" startline="1299" endline="1312">cfdp_is_a_trans_being_cancelled</referencedby>
        <referencedby refid="cfdp__provides_8h_1a8f8b521dfe86ec1ad49adcd9fdfea78e" compoundref="utils_8c" startline="1092" endline="1175">cfdp_trans_from_string</referencedby>
        <referencedby refid="event_8h_1a7f8e74a46a1a9fb9e7f6118ff5b11976" compoundref="event_8c" startline="33" endline="129">event__determine_from_pdu_struct</referencedby>
        <referencedby refid="utils_8c_1a1c0b4744352fc6742102ccdc1c13f59f" compoundref="utils_8c" startline="47" endline="62">m__do_strings_match</referencedby>
        <referencedby refid="default__filestore_8c_1afb5a8cf031c45bfecf68ae4291eb5d50" compoundref="default__filestore_8c" startline="30" endline="41">m__does_file_exist</referencedby>
        <referencedby refid="mib_8h_1a95e5ba6bfc01ec18598cd547e3b71476" compoundref="mib_8c" startline="380" endline="758">mib__set_parameter</referencedby>
        <referencedby refid="misc_8h_1a604d1db7d478aba5cd3f2fee62b9d38a" compoundref="misc_8c" startline="78" endline="83">misc__freeze_all_partners</referencedby>
        <referencedby refid="utils_8h_1acf931ef57f5f05b865356adf1807c8a1" compoundref="utils_8c" startline="76" endline="358">utils__request_from_string</referencedby>
        <referencedby refid="utils_8h_1a63c00f4c72a6c9c2c151b5f1b03dc603" compoundref="utils_8c" startline="387" endline="421">utils__strncat</referencedby>
        <referencedby refid="utils_8h_1af21ecb5dc40dd3c430766df4e1958390" compoundref="utils_8c" startline="363" endline="382">utils__strncpy</referencedby>
      </memberdef>
      <memberdef kind="define" id="aaa_8c_1a6b20d41d6252e9871430c242cb1a56e7" prot="public" static="no">
        <name>BUFFER_SIZE</name>
        <initializer>1024</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="251" column="9"/>
        <referencedby refid="aaa_8h_1a5c6487ec1a3f1c958be14d27dd4f22e9" compoundref="aaa_8c" startline="249" endline="313">aaa__calculate_file_checksum</referencedby>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="aaa_8c_1a455c4446917effdd9115c53127c90da2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_i_d" kindref="compound">ID</ref></type>
        <definition>ID m__partner_id</definition>
        <argsstring>(HDR hdr)</argsstring>
        <name>m__partner_id</name>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref></type>
          <declname>hdr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="110" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="110" bodyend="127"/>
        <references refid="utils_8c_1a9263c3541844439cf374b3224e2fe70d" compoundref="utils_8c" startline="1186" endline="1240">cfdp_are_these_ids_equal</references>
        <references refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" compoundref="structures_8h" startline="205">HDR::dest_id</references>
        <references refid="mib_8c_1a166a0e8f862b5ff7d39b1b5bcf382b98" compoundref="mib_8c" startline="329" endline="334">mib__get_my_id</references>
        <references refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" compoundref="cfdp__data__structures_8h" startline="122">TRANSACTION::source_id</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <referencedby refid="aaa_8h_1a8629fef239864abf8bd76005363847a0" compoundref="aaa_8c" startline="676" endline="696">aaa__send_ack</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1af24279f6dc6f1fb0ef928cc515cdb21c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__abandon_this_transaction</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__abandon_this_transaction</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="131" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="131" bodyend="145"/>
        <references refid="aaa_8c_1a77aeff2d16620a5f809f7a104646e56e" compoundref="aaa_8c" startline="976" endline="1027">aaa__shutdown</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aba5bb97eaf108f40d95a11787ccef9c1" compoundref="cfdp__data__structures_8h" startline="362">TRANS_STATUS::abandoned</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" compoundref="cfdp__data__structures_8h" startline="371">TRANS_STATUS::final_status</references>
        <references refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a3ab275c6067eceb63e73c55cdc80f9da" compoundref="cfdp__data__structures_8h" startline="316">FINAL_STATUS_ABANDONED</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa865d6ea19908b99b10645ad1f7fc94c" compoundref="cfdp__data__structures_8h" startline="372">TRANS_STATUS::finished</references>
        <references refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9a63e62b09d2ed5da36f76552cf4dde88d" compoundref="cfdp__data__structures_8h" startline="269">IND_ABANDONED</references>
        <references refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" compoundref="default__indication_8c" startline="376" endline="408">indication__</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="r1_8c_1a6d1034f910dc4e2eaba46d8684ebe4e1" compoundref="r1_8c" startline="49" endline="92">m__fault_handler</referencedby>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
        <referencedby refid="s1_8h_1a524667af7705adf9738d16163a289a9b" compoundref="s1_8c" startline="237" endline="405">s1__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a4fd0674b58b8cae8dd34cfec75f9625a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_a_c_k" kindref="compound">ACK</ref></type>
        <definition>ACK aaa__build_ack_eof</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__build_ack_eof</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="150" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="150" bodyend="161"/>
        <references refid="struct_e_o_h_f_1a3b24d8ff0a52b3b6273aa65d678c5fb6" compoundref="structures_8h" startline="248">EOHF::condition_code</references>
        <references refid="struct_a_c_k_1a88a6885f40b72b90ff9016a9e69deb10" compoundref="structures_8h" startline="269">ACK::condition_code</references>
        <references refid="struct_a_c_k_1ae4cfa1794f86a137a440b43558873a42" compoundref="structures_8h" startline="270">ACK::delivery_code</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab6aed37045d3d77776cfce2b9ec66717" compoundref="cfdp__data__structures_8h" startline="366">TRANS_STATUS::delivery_code</references>
        <references refid="struct_a_c_k_1a9d1bc82f590c27eb334b3edaf0beaf25" compoundref="structures_8h" startline="267">ACK::directive_code</references>
        <references refid="struct_a_c_k_1a5d377c03910335c534b288ae9d516cc0" compoundref="structures_8h" startline="268">ACK::directive_subtype_code</references>
        <references refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" compoundref="machine_8h" startline="60">MACHINE::eof</references>
        <references refid="structures_8h_1abb28482e818686dbcedaf0fbb3dda0eaa05aa5e806c13fefcefcb11ecc4c0cac3" compoundref="structures_8h" startline="220">EOF_PDU</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="structures_8h_1a4d4561644c7d09ef99b2a32cfab218dcada1b6af1902284145ea8a5e950b10a3f" compoundref="structures_8h" startline="105">TRANS_ACTIVE</references>
        <references refid="struct_a_c_k_1a23f71d78a642ee940d522f1fba8d65c6" compoundref="structures_8h" startline="271">ACK::transaction_status</references>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a84aa883eba28de23cfd0f7ded89c1c1e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_a_c_k" kindref="compound">ACK</ref></type>
        <definition>ACK aaa__build_ack_fin</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__build_ack_fin</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="166" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="166" bodyend="181"/>
        <references refid="struct_f_i_n_1a016fb1f5c98239c8050e064e8523ed24" compoundref="structures_8h" startline="257">FIN::condition_code</references>
        <references refid="struct_a_c_k_1a88a6885f40b72b90ff9016a9e69deb10" compoundref="structures_8h" startline="269">ACK::condition_code</references>
        <references refid="struct_a_c_k_1ae4cfa1794f86a137a440b43558873a42" compoundref="structures_8h" startline="270">ACK::delivery_code</references>
        <references refid="struct_a_c_k_1a9d1bc82f590c27eb334b3edaf0beaf25" compoundref="structures_8h" startline="267">ACK::directive_code</references>
        <references refid="struct_a_c_k_1a5d377c03910335c534b288ae9d516cc0" compoundref="structures_8h" startline="268">ACK::directive_subtype_code</references>
        <references refid="cfdp__data__structures_8h_1ac66edc52b377fe3f3cbe43a899321876ac2d1e01bff4ae937b21ba493cbf2f99d" compoundref="cfdp__data__structures_8h" startline="244">DONT_CARE_0</references>
        <references refid="struct_m_a_c_h_i_n_e_1a53699b59fdc5c35fd9c65b9be8595891" compoundref="machine_8h" startline="61">MACHINE::fin</references>
        <references refid="structures_8h_1abb28482e818686dbcedaf0fbb3dda0eaa3666b6349eab21a903f683a71e132561" compoundref="structures_8h" startline="221">FIN_PDU</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aee238334b9e82f49718ec32291109b11" compoundref="cfdp__data__structures_8h" startline="376">TRANS_STATUS::is_this_trans_solely_for_ack_fin</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="structures_8h_1a4d4561644c7d09ef99b2a32cfab218dcada1b6af1902284145ea8a5e950b10a3f" compoundref="structures_8h" startline="105">TRANS_ACTIVE</references>
        <references refid="structures_8h_1a4d4561644c7d09ef99b2a32cfab218dcaef6b43d3c9bb0500e4c525781336be2a" compoundref="structures_8h" startline="105">TRANS_UNDEFINED</references>
        <references refid="struct_a_c_k_1a23f71d78a642ee940d522f1fba8d65c6" compoundref="structures_8h" startline="271">ACK::transaction_status</references>
        <referencedby refid="s2_8c_1ab748b5bf0391585fe123690bde219745" compoundref="s2_8c" startline="326" endline="368">m__ack_fin_from_previous_machine</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a239d8566d3ff00868d590f34740d2efe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_e_o_h_f" kindref="compound">EOHF</ref></type>
        <definition>EOHF aaa__build_eof</definition>
        <argsstring>(CONDITION_CODE condition_code, u_int_4 file_checksum, u_int_4 file_size)</argsstring>
        <name>aaa__build_eof</name>
        <param>
          <type><ref refid="cfdp__data__structures_8h_1a3b52de9e08aebbb321c6bc382ea26328" kindref="member">CONDITION_CODE</ref></type>
          <declname>condition_code</declname>
        </param>
        <param>
          <type><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref></type>
          <declname>file_checksum</declname>
        </param>
        <param>
          <type><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref></type>
          <declname>file_size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="186" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="186" bodyend="197"/>
        <references refid="struct_e_o_h_f_1a3b24d8ff0a52b3b6273aa65d678c5fb6" compoundref="structures_8h" startline="248">EOHF::condition_code</references>
        <references refid="struct_e_o_h_f_1aa69b44ed9e814c26f573e4868fd74cf4" compoundref="structures_8h" startline="250">EOHF::file_checksum</references>
        <references refid="callbacks_8h_1a679b4a6644ab6cfe8551968fbeb3f610" compoundref="default__filestore_8c" startline="46" endline="54">file_size</references>
        <references refid="struct_e_o_h_f_1acf948090e886e58ab04d7bf3b66657af" compoundref="structures_8h" startline="251">EOHF::file_size</references>
        <references refid="struct_e_o_h_f_1a53f9fbdb43acc5e06eba4582941a9626" compoundref="structures_8h" startline="249">EOHF::spare</references>
        <referencedby refid="s1_8c_1a62f46d12c24fc72767e12e88668bf11c" compoundref="s1_8c" startline="43" endline="54">m__ask_partner_to_cancel</referencedby>
        <referencedby refid="s1_8c_1a1bf4984d114c50671f7f92457d7f07d9" compoundref="s1_8c" startline="200" endline="227">m__release_a_file_data_pdu</referencedby>
        <referencedby refid="s1_8c_1a95d9a2188b7812ce62433ceedd6754a0" compoundref="s1_8c" startline="106" endline="166">m__release_a_metadata_pdu</referencedby>
        <referencedby refid="s1_8h_1a524667af7705adf9738d16163a289a9b" compoundref="s1_8c" startline="237" endline="405">s1__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a2ec9ad100a3b2969711f35afc79ce644" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_f_i_n" kindref="compound">FIN</ref></type>
        <definition>FIN aaa__build_fin</definition>
        <argsstring>(CONDITION_CODE condition_code, DELIVERY_CODE delivery_code)</argsstring>
        <name>aaa__build_fin</name>
        <param>
          <type><ref refid="cfdp__data__structures_8h_1a3b52de9e08aebbb321c6bc382ea26328" kindref="member">CONDITION_CODE</ref></type>
          <declname>condition_code</declname>
        </param>
        <param>
          <type><ref refid="cfdp__data__structures_8h_1ac66edc52b377fe3f3cbe43a899321876" kindref="member">DELIVERY_CODE</ref></type>
          <declname>delivery_code</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="202" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="202" bodyend="213"/>
        <references refid="struct_f_i_n_1a016fb1f5c98239c8050e064e8523ed24" compoundref="structures_8h" startline="257">FIN::condition_code</references>
        <references refid="struct_f_i_n_1ae2f8d59cd9662a0a5a475069337b0744" compoundref="structures_8h" startline="259">FIN::delivery_code</references>
        <references refid="struct_f_i_n_1a178747def8fb327bf011e9fcdc3ccae2" compoundref="structures_8h" startline="258">FIN::end_system_status</references>
        <references refid="struct_f_i_n_1a96bceefa2d73a04a6a382ddcd66c7c97" compoundref="structures_8h" startline="260">FIN::spare</references>
        <referencedby refid="r2_8c_1a0f7e32b26d7b1cb522e9050355a3037c" compoundref="r2_8c" startline="136" endline="206">m__all_data_has_been_received</referencedby>
        <referencedby refid="r2_8c_1a62f46d12c24fc72767e12e88668bf11c" compoundref="r2_8c" startline="58" endline="70">m__ask_partner_to_cancel</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a6d4ee25e8beaeb1238123690ec84ee87" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__build_metadata_from_put_req</definition>
        <argsstring>(REQUEST request, HDR *hdr, MD *md)</argsstring>
        <name>aaa__build_metadata_from_put_req</name>
        <param>
          <type><ref refid="struct_r_e_q_u_e_s_t" kindref="compound">REQUEST</ref></type>
          <declname>request</declname>
        </param>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref> *</type>
          <declname>hdr</declname>
        </param>
        <param>
          <type><ref refid="struct_m_d" kindref="compound">MD</ref> *</type>
          <declname>md</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="218" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="218" bodyend="244"/>
        <references refid="structures_8h_1a9d6e77d4cbe1fcd2941ae2e09f74a032a4475ec565add8f33ca5bdf9504df88fa" compoundref="structures_8h" startline="195">ACK_MODE</references>
        <references refid="struct_p_u_t___i_n_f_o_1a8d8458d6859cab3494bd8d75193cdba2" compoundref="structures_8h" startline="77">PUT_INFO::ack_required</references>
        <references refid="cfdp__private_8h_1a71855d533cf9af9d0ff6506adf422ae7" compoundref="cfdp__private_8h" startline="71">COPY</references>
        <references refid="struct_p_u_t___i_n_f_o_1abad4d56f97566b50d27e3cb91265d558" compoundref="structures_8h" startline="81">PUT_INFO::dest_file_name</references>
        <references refid="struct_m_d_1a5a85cb4df082239b96234b800e174870" compoundref="cfdp__data__structures_8h" startline="213">MD::dest_file_name</references>
        <references refid="struct_p_u_t___i_n_f_o_1a6808d22b94b57c69105a09664eb0d7cc" compoundref="structures_8h" startline="78">PUT_INFO::dest_id</references>
        <references refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" compoundref="structures_8h" startline="205">HDR::dest_id</references>
        <references refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" compoundref="structures_8h" startline="201">HDR::direction</references>
        <references refid="struct_m_d_1ab0d079723734fa10ae2e95e81e63f128" compoundref="cfdp__data__structures_8h" startline="211">MD::file_size</references>
        <references refid="callbacks_8c_1a4c53d2da55948c847c1124091d844a0d" compoundref="callbacks_8c" startline="57">file_size_callback</references>
        <references refid="struct_p_u_t___i_n_f_o_1a0f1fe47d2a56a42265ff65a6aa287467" compoundref="structures_8h" startline="79">PUT_INFO::file_transfer</references>
        <references refid="struct_m_d_1af43b09440cf76cde397e8d876c3a8130" compoundref="cfdp__data__structures_8h" startline="209">MD::file_transfer</references>
        <references refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad">REQUEST::info</references>
        <references refid="cfdp__config_8h_1a9958e549a943ec37c7fbb33685befb02" compoundref="cfdp__config_8h" startline="94">MAX_FILE_NAME_LENGTH</references>
        <references refid="mib_8c_1a166a0e8f862b5ff7d39b1b5bcf382b98" compoundref="mib_8c" startline="329" endline="334">mib__get_my_id</references>
        <references refid="struct_h_d_r_1a8e1bb4224e30afd6b39d11c2b55f78f8" compoundref="structures_8h" startline="202">HDR::mode</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" compoundref="structures_8h" startline="91">REQUEST::put</references>
        <references refid="struct_m_d_1a8483756b650d370a9f73c5eb67d5a981" compoundref="cfdp__data__structures_8h" startline="210">MD::segmentation_control</references>
        <references refid="struct_p_u_t___i_n_f_o_1a324d49720dfd1891abb344bd89e90487" compoundref="structures_8h" startline="80">PUT_INFO::source_file_name</references>
        <references refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" compoundref="cfdp__data__structures_8h" startline="212">MD::source_file_name</references>
        <references refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" compoundref="cfdp__data__structures_8h" startline="122">TRANSACTION::source_id</references>
        <references refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47aeffd4896b50004023fdd717d63615efb" compoundref="structures_8h" startline="192">TOWARD_RECEIVER</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <references refid="structures_8h_1a9d6e77d4cbe1fcd2941ae2e09f74a032a86d0dcee346aaab05374e13bfe5a703a" compoundref="structures_8h" startline="195">UNACK_MODE</references>
        <references refid="struct_h_d_r_1a093c783eee5badd07c8cbb2fa9ab50d4" compoundref="structures_8h" startline="203">HDR::use_crc</references>
        <referencedby refid="s1_8h_1a524667af7705adf9738d16163a289a9b" compoundref="s1_8c" startline="237" endline="405">s1__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a5c6487ec1a3f1c958be14d27dd4f22e9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref></type>
        <definition>u_int_4 aaa__calculate_file_checksum</definition>
        <argsstring>(char *file_name)</argsstring>
        <name>aaa__calculate_file_checksum</name>
        <param>
          <type>char *</type>
          <declname>file_name</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="249" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="249" bodyend="313"/>
        <references refid="cfdp__config_8h_1af5822b84946d824c15c38ab09085b5eb" compoundref="cfdp__config_8h" startline="267">ASSERT__</references>
        <references refid="aaa_8c_1a6b20d41d6252e9871430c242cb1a56e7">BUFFER_SIZE</references>
        <references refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" compoundref="callbacks_8h" startline="63">e_msg__</references>
        <references refid="callbacks_8c_1ab45195e00f9ef4f4eca30a8a254f3e8b" compoundref="callbacks_8c" startline="44">fclose_callback</references>
        <references refid="callbacks_8c_1a9ac157931bc57e515038b05704d56928" compoundref="callbacks_8c" startline="46">fopen_callback</references>
        <references refid="callbacks_8c_1ad75723ad3e4ab1bf351c49403b40f718" compoundref="callbacks_8c" startline="47">fread_callback</references>
        <references refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</references>
        <references refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" compoundref="cfdp__config_8h" startline="59">u_int_4</references>
        <referencedby refid="aaa_8h_1a03cec53085b0a1a2f7da4f72c3330d52" compoundref="aaa_8c" startline="364" endline="383">aaa__is_file_checksum_valid</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a8016d4851bbcdb64b6a4b63c9e52bf60" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__cancel_locally</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__cancel_locally</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="320" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="320" bodyend="338"/>
        <references refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" compoundref="machine_8h" startline="65">MACHINE::ack_timer</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa67e3098cacdbb149e3cd2e51896b429" compoundref="cfdp__data__structures_8h" startline="364">TRANS_STATUS::cancelled</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" compoundref="machine_8h" startline="66">MACHINE::inactivity_timer</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" compoundref="machine_8h" startline="49">MACHINE::is_outgoing_ack_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" compoundref="machine_8h" startline="50">MACHINE::is_outgoing_eof_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" compoundref="machine_8h" startline="51">MACHINE::is_outgoing_fin_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" compoundref="machine_8h" startline="52">MACHINE::is_outgoing_md_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" compoundref="machine_8h" startline="53">MACHINE::is_outgoing_nak_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" compoundref="machine_8h" startline="67">MACHINE::nak_timer</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" compoundref="timer_8c" startline="74" endline="78">timer__cancel</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="s2_8c_1ab748b5bf0391585fe123690bde219745" compoundref="s2_8c" startline="326" endline="368">m__ack_fin_from_previous_machine</referencedby>
        <referencedby refid="r1_8c_1a6d1034f910dc4e2eaba46d8684ebe4e1" compoundref="r1_8c" startline="49" endline="92">m__fault_handler</referencedby>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1ac364673f8d1465636dad40c034df8f5a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__display_state_and_event</definition>
        <argsstring>(const char *which_state_table, STATE state, int event)</argsstring>
        <name>aaa__display_state_and_event</name>
        <param>
          <type>const char *</type>
          <declname>which_state_table</declname>
        </param>
        <param>
          <type><ref refid="cfdp__data__structures_8h_1a275a67132f10277ada3a0ee3d616b647" kindref="member">STATE</ref></type>
          <declname>state</declname>
        </param>
        <param>
          <type>int</type>
          <declname>event</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="343" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="343" bodyend="359"/>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="event_8c_1ad44c693cefb56c25be234d1a68bca9b4" compoundref="event_8c" startline="177" endline="270">event__event_as_string</references>
        <references refid="event_8h_1a13b9eedf995f4502cc976b174327d77ea9f239ae9c424a595b4597b2b08c8c2d2" compoundref="event_8h" startline="53">RECEIVED_FILEDATA_PDU</references>
        <references refid="event_8h_1a13b9eedf995f4502cc976b174327d77ead2deebb3137669ac0c6ae45e049be738" compoundref="event_8h" startline="41">THROTTLE_OUTGOING_FILE_DATA_PDU</references>
        <references refid="event_8h_1a13b9eedf995f4502cc976b174327d77ea1efa2490ee1e5105c7476cfe812e9edf" compoundref="event_8h" startline="40">THROTTLE_OUTGOING_FILE_DIR_PDU</references>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
        <referencedby refid="s1_8h_1a524667af7705adf9738d16163a289a9b" compoundref="s1_8c" startline="237" endline="405">s1__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a03cec53085b0a1a2f7da4f72c3330d52" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="common__types_8h_1ac3ecf6d00ebd3dd79ea00efdc71d9c33" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">boolean</ref></type>
        <definition>boolean aaa__is_file_checksum_valid</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__is_file_checksum_valid</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="364" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="364" bodyend="383"/>
        <references refid="aaa_8c_1a5c6487ec1a3f1c958be14d27dd4f22e9" compoundref="aaa_8c" startline="249" endline="313">aaa__calculate_file_checksum</references>
        <references refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" compoundref="callbacks_8h" startline="63">e_msg__</references>
        <references refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" compoundref="machine_8h" startline="60">MACHINE::eof</references>
        <references refid="struct_e_o_h_f_1aa69b44ed9e814c26f573e4868fd74cf4" compoundref="structures_8h" startline="250">EOHF::file_checksum</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" compoundref="cfdp__data__structures_8h" startline="370">TRANS_STATUS::file_checksum_as_calculated</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" compoundref="cfdp__data__structures_8h" startline="385">TRANS_STATUS::temp_file_name</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="r2_8c_1a0f7e32b26d7b1cb522e9050355a3037c" compoundref="r2_8c" startline="136" endline="206">m__all_data_has_been_received</referencedby>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1af9b859b15f97846f835fca9103693fa7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="common__types_8h_1ac3ecf6d00ebd3dd79ea00efdc71d9c33" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">boolean</ref></type>
        <definition>boolean aaa__is_file_size_valid</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__is_file_size_valid</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="388" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="388" bodyend="401"/>
        <references refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" compoundref="callbacks_8h" startline="63">e_msg__</references>
        <references refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" compoundref="machine_8h" startline="60">MACHINE::eof</references>
        <references refid="struct_e_o_h_f_1acf948090e886e58ab04d7bf3b66657af" compoundref="structures_8h" startline="251">EOHF::file_size</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1abc401184f057ba16d024b046deaf3322" compoundref="cfdp__data__structures_8h" startline="380">TRANS_STATUS::received_file_size</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1aeb0e512ce199b7b278cb0a92223ffbe0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__initialize</definition>
        <argsstring>(MACHINE *m, REQUEST *req_ptr, HDR *hdr_ptr)</argsstring>
        <name>aaa__initialize</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <param>
          <type><ref refid="struct_r_e_q_u_e_s_t" kindref="compound">REQUEST</ref> *</type>
          <declname>req_ptr</declname>
        </param>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref> *</type>
          <declname>hdr_ptr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="406" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="406" bodyend="505"/>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aba5bb97eaf108f40d95a11787ccef9c1" compoundref="cfdp__data__structures_8h" startline="362">TRANS_STATUS::abandoned</references>
        <references refid="struct_p_u_t___i_n_f_o_1a8d8458d6859cab3494bd8d75193cdba2" compoundref="structures_8h" startline="77">PUT_INFO::ack_required</references>
        <references refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" compoundref="machine_8h" startline="65">MACHINE::ack_timer</references>
        <references refid="cfdp__config_8h_1af5822b84946d824c15c38ab09085b5eb" compoundref="cfdp__config_8h" startline="267">ASSERT__</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ac85ab7838e832d906891610f590710ea" compoundref="cfdp__data__structures_8h" startline="363">TRANS_STATUS::attempts</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa67e3098cacdbb149e3cd2e51896b429" compoundref="cfdp__data__structures_8h" startline="364">TRANS_STATUS::cancelled</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab2997675b95baf36df9c3082b4a37b3a" compoundref="cfdp__data__structures_8h" startline="365">TRANS_STATUS::condition_code</references>
        <references refid="cfdp__data__structures_8h_1ac66edc52b377fe3f3cbe43a899321876a6bb36d7ca7eef94949ed18270408c563" compoundref="cfdp__data__structures_8h" startline="244">DATA_INCOMPLETE</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab6aed37045d3d77776cfce2b9ec66717" compoundref="cfdp__data__structures_8h" startline="366">TRANS_STATUS::delivery_code</references>
        <references refid="struct_m_d_1a5a85cb4df082239b96234b800e174870" compoundref="cfdp__data__structures_8h" startline="213">MD::dest_file_name</references>
        <references refid="struct_p_u_t___i_n_f_o_1a6808d22b94b57c69105a09664eb0d7cc" compoundref="structures_8h" startline="78">PUT_INFO::dest_id</references>
        <references refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" compoundref="structures_8h" startline="205">HDR::dest_id</references>
        <references refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" compoundref="structures_8h" startline="201">HDR::direction</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a76a8dcbf0559fb2166836b19dcab2471" compoundref="cfdp__data__structures_8h" startline="368">TRANS_STATUS::fd_offset</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" compoundref="cfdp__data__structures_8h" startline="370">TRANS_STATUS::file_checksum_as_calculated</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" compoundref="cfdp__data__structures_8h" startline="371">TRANS_STATUS::final_status</references>
        <references refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a478828c81260a5fcdb79ebf9c20afa7d" compoundref="cfdp__data__structures_8h" startline="313">FINAL_STATUS_UNKNOWN</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa865d6ea19908b99b10645ad1f7fc94c" compoundref="cfdp__data__structures_8h" startline="372">TRANS_STATUS::finished</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a84a627069cfee8ba0268257f0b3e3f03" compoundref="cfdp__data__structures_8h" startline="373">TRANS_STATUS::frozen</references>
        <references refid="struct_m_a_c_h_i_n_e_1ad4de08f39605e2f9e0ae9b842644397d" compoundref="machine_8h" startline="42">MACHINE::has_a_pdu_been_received</references>
        <references refid="struct_m_a_c_h_i_n_e_1af6e7e6cd7219636d60aa319d214b02f1" compoundref="machine_8h" startline="43">MACHINE::has_a_put_request_been_received</references>
        <references refid="struct_m_a_c_h_i_n_e_1a791c795c9b8f94415bfef3e30f0cec42" compoundref="machine_8h" startline="44">MACHINE::has_eof_been_received</references>
        <references refid="struct_m_a_c_h_i_n_e_1ab4b8b566ffe5f9a843ed061f98803471" compoundref="machine_8h" startline="45">MACHINE::has_eof_been_sent</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a5ba0e784f4d11bc73b2fca7ee56dce2e" compoundref="cfdp__data__structures_8h" startline="374">TRANS_STATUS::has_md_been_received</references>
        <references refid="struct_m_a_c_h_i_n_e_1a9f3d17df8d0b8d8c8051b9ad5f808a08" compoundref="machine_8h" startline="46">MACHINE::has_this_state_machine_finished</references>
        <references refid="struct_m_a_c_h_i_n_e_1a71b9a1432a405040140194f6bca1704a" compoundref="machine_8h" startline="47">MACHINE::have_we_initiated_a_cancel</references>
        <references refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" compoundref="machine_8h" startline="59">MACHINE::hdr</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a837800c77a515fb383411a618a410dc0" compoundref="cfdp__data__structures_8h" startline="375">TRANS_STATUS::how_many_naks</references>
        <references refid="nak_8h_1a741c56f36f51042ec7d2908b17fec458" compoundref="nak_8h" startline="44">I_AM_A_RECEIVER</references>
        <references refid="nak_8h_1af42d7c94f24a752ff5c0eadb3e531c85" compoundref="nak_8h" startline="43">I_AM_A_SENDER</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" compoundref="machine_8h" startline="66">MACHINE::inactivity_timer</references>
        <references refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad">REQUEST::info</references>
        <references refid="struct_m_a_c_h_i_n_e_1a80b275c61b5029c15b2121819bd7d201" compoundref="machine_8h" startline="48">MACHINE::is_external_xfer_open</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" compoundref="machine_8h" startline="49">MACHINE::is_outgoing_ack_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" compoundref="machine_8h" startline="50">MACHINE::is_outgoing_eof_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" compoundref="machine_8h" startline="51">MACHINE::is_outgoing_fin_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" compoundref="machine_8h" startline="52">MACHINE::is_outgoing_md_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" compoundref="machine_8h" startline="53">MACHINE::is_outgoing_nak_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0a7025547a73c28e38adc39f04ad45f4" compoundref="machine_8h" startline="54">MACHINE::is_there_a_temp_file</references>
        <references refid="struct_m_a_c_h_i_n_e_1a2a65fc5fc2a7f047af17d8b01cd28077" compoundref="machine_8h" startline="55">MACHINE::is_there_an_open_file</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aee238334b9e82f49718ec32291109b11" compoundref="cfdp__data__structures_8h" startline="376">TRANS_STATUS::is_this_trans_solely_for_ack_fin</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0dee57b83bae5ff84bd25cb53cdeaa03" compoundref="machine_8h" startline="56">MACHINE::is_user_inside_the_engine_core</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" compoundref="cfdp__data__structures_8h" startline="377">TRANS_STATUS::md</references>
        <references refid="mib_8c_1a166a0e8f862b5ff7d39b1b5bcf382b98" compoundref="mib_8c" startline="329" endline="334">mib__get_my_id</references>
        <references refid="mib_8c_1adc8b930dc6daf9cce514813024fae2bc" compoundref="mib_8c" startline="259" endline="264">mib__inactivity_timeout</references>
        <references refid="misc_8c_1af05f4e0fc5bb14fa96bc49a4ede70357" compoundref="misc_8c" startline="98" endline="103">misc__are_any_partners_frozen</references>
        <references refid="misc_8c_1a2c1a2e36545d680269a71810e85bfb56" compoundref="misc_8c" startline="49" endline="57">misc__new_trans_seq_num</references>
        <references refid="struct_t_i_m_e_r_1ac25f3daa9a29ceb01edc1b6fd6c4b226" compoundref="timer_8h" startline="41">TIMER::mode</references>
        <references refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" compoundref="machine_8h" startline="63">MACHINE::nak</references>
        <references refid="nak_8c_1a3e3ace1ad5fe5553cee03be1c43ce7d2" compoundref="nak_8c" startline="392" endline="412">nak__init</references>
        <references refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" compoundref="machine_8h" startline="67">MACHINE::nak_timer</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="cfdp__data__structures_8h_1a3b52de9e08aebbb321c6bc382ea26328abf350750d0d4fabd8954c0f1e9bbae94" compoundref="cfdp__data__structures_8h" startline="150">NO_ERROR</references>
        <references refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</references>
        <references refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a72a97fa01798321b3c09dd7fa28b3a36" compoundref="cfdp__data__structures_8h" startline="123">TRANSACTION::number</references>
        <references refid="pdu_8c_1a0ccbdebd41d7d161f110958f6330b8b0" compoundref="pdu_8c" startline="1235" endline="1267">pdu__receiver_role_from_pdu_hdr</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a84b743695ba1ede8736c3f5ebb05cd99" compoundref="cfdp__data__structures_8h" startline="379">TRANS_STATUS::phase</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" compoundref="structures_8h" startline="91">REQUEST::put</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1abc401184f057ba16d024b046deaf3322" compoundref="cfdp__data__structures_8h" startline="380">TRANS_STATUS::received_file_size</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a8cc91d6686b3e7ee150d6ed731a7927d" compoundref="cfdp__data__structures_8h" startline="381">TRANS_STATUS::role</references>
        <references refid="cfdp__data__structures_8h_1a275a67132f10277ada3a0ee3d616b647a4eda5f72b331209ee9bc2d8fb2c02e7e" compoundref="cfdp__data__structures_8h" startline="226">S1</references>
        <references refid="cfdp__private_8h_1a5b24031722f14807776a4f1d4ba01edc" compoundref="cfdp__private_8h" startline="78">S_1</references>
        <references refid="cfdp__private_8h_1a9aeea80da90f54583c19377c478a722d" compoundref="cfdp__private_8h" startline="80">S_2</references>
        <references refid="struct_m_d_1a8483756b650d370a9f73c5eb67d5a981" compoundref="cfdp__data__structures_8h" startline="210">MD::segmentation_control</references>
        <references refid="struct_m_a_c_h_i_n_e_1a76935ecb4670a6b5d85f11437da9de5d" compoundref="machine_8h" startline="57">MACHINE::should_external_xfer_be_closed</references>
        <references refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" compoundref="cfdp__data__structures_8h" startline="212">MD::source_file_name</references>
        <references refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" compoundref="cfdp__data__structures_8h" startline="122">TRANSACTION::source_id</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aaf374215936de0d07f1805747e27ddae" compoundref="cfdp__data__structures_8h" startline="383">TRANS_STATUS::start_time</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a436e8d0cdf3b6f4a6fee533a6aef6bf8" compoundref="cfdp__data__structures_8h" startline="382">TRANS_STATUS::state</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab0cdb83414e6745e817827bdf42be838" compoundref="cfdp__data__structures_8h" startline="384">TRANS_STATUS::suspended</references>
        <references refid="timer_8c_1a30fd0ecdbef505c1883cda8504b916d8" compoundref="timer_8c" startline="52" endline="60">timer__start</references>
        <references refid="timer_8h_1a15e57fd0ba6550341fe791c32292bea7af959aed8d5fd3cb662409c9dcabe6c73" compoundref="timer_8h" startline="36">TIMER_OFF</references>
        <references refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47aeffd4896b50004023fdd717d63615efb" compoundref="structures_8h" startline="192">TOWARD_RECEIVER</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="cfdp__lib_8c_1a6632da17d5ed8be61a4752812ae1ec9c" compoundref="cfdp__lib_8c" startline="137" endline="169">m__restart_old_sender_machine</referencedby>
        <referencedby refid="cfdp__lib_8c_1aa4d787f4fb8cedf0912abaa9fda833c3" compoundref="cfdp__lib_8c" startline="174" endline="206">m__start_new_receiver_machine</referencedby>
        <referencedby refid="cfdp__lib_8c_1ab796d62f5cdc210a19f90fdfe7ee53c6" compoundref="cfdp__lib_8c" startline="211" endline="243">m__start_new_sender_machine</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a292abc96e2da36a63b0688b497c2a4fc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="common__types_8h_1ac3ecf6d00ebd3dd79ea00efdc71d9c33" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">boolean</ref></type>
        <definition>boolean aaa__is_file_structure_valid</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__is_file_structure_valid</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="510" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="510" bodyend="532"/>
        <references refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" compoundref="callbacks_8h" startline="63">e_msg__</references>
        <references refid="callbacks_8c_1adaf972193454a60dd6047b182fac808d" compoundref="callbacks_8c" startline="58">is_file_segmented_callback</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" compoundref="cfdp__data__structures_8h" startline="377">TRANS_STATUS::md</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_m_d_1a8483756b650d370a9f73c5eb67d5a981" compoundref="cfdp__data__structures_8h" startline="210">MD::segmentation_control</references>
        <references refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" compoundref="cfdp__data__structures_8h" startline="212">MD::source_file_name</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="s1_8c_1a95d9a2188b7812ce62433ceedd6754a0" compoundref="s1_8c" startline="106" endline="166">m__release_a_metadata_pdu</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1aab0c4dd6a5085d8e209d817ae0c5203b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__notice_of_suspension</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__notice_of_suspension</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="537" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="537" bodyend="547"/>
        <references refid="aaa_8c_1aa74321ddb9e7b8bfe4bb6cdd48e21ea8" compoundref="aaa_8c" startline="1054" endline="1063">aaa__suspend_timers</references>
        <references refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9a70df2823f3d0023ef818e9c72026eb31" compoundref="cfdp__data__structures_8h" startline="284">IND_SUSPENDED</references>
        <references refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" compoundref="default__indication_8c" startline="376" endline="408">indication__</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab0cdb83414e6745e817827bdf42be838" compoundref="cfdp__data__structures_8h" startline="384">TRANS_STATUS::suspended</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="r1_8c_1a6d1034f910dc4e2eaba46d8684ebe4e1" compoundref="r1_8c" startline="49" endline="92">m__fault_handler</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
        <referencedby refid="s1_8h_1a524667af7705adf9738d16163a289a9b" compoundref="s1_8c" startline="237" endline="405">s1__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a125e9d605218cb5b893832e5698d9cc1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="common__types_8h_1ac3ecf6d00ebd3dd79ea00efdc71d9c33" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">boolean</ref></type>
        <definition>boolean aaa__open_source_file</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__open_source_file</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="552" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="552" bodyend="565"/>
        <references refid="callbacks_8c_1a9ac157931bc57e515038b05704d56928" compoundref="callbacks_8c" startline="46">fopen_callback</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" compoundref="machine_8h" startline="69">MACHINE::fp</references>
        <references refid="struct_m_a_c_h_i_n_e_1a2a65fc5fc2a7f047af17d8b01cd28077" compoundref="machine_8h" startline="55">MACHINE::is_there_an_open_file</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" compoundref="cfdp__data__structures_8h" startline="377">TRANS_STATUS::md</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" compoundref="cfdp__data__structures_8h" startline="212">MD::source_file_name</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="s1_8c_1a95d9a2188b7812ce62433ceedd6754a0" compoundref="s1_8c" startline="106" endline="166">m__release_a_metadata_pdu</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a7ad82ee8a918e60e37786bf20fb7f348" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="common__types_8h_1ac3ecf6d00ebd3dd79ea00efdc71d9c33" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">boolean</ref></type>
        <definition>boolean aaa__open_temp_file</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__open_temp_file</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="570" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="570" bodyend="634"/>
        <references refid="cfdp__private_8h_1a71855d533cf9af9d0ff6506adf422ae7" compoundref="cfdp__private_8h" startline="71">COPY</references>
        <references refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" compoundref="callbacks_8h" startline="63">e_msg__</references>
        <references refid="callbacks_8c_1a9ac157931bc57e515038b05704d56928" compoundref="callbacks_8c" startline="46">fopen_callback</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" compoundref="machine_8h" startline="69">MACHINE::fp</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0a7025547a73c28e38adc39f04ad45f4" compoundref="machine_8h" startline="54">MACHINE::is_there_a_temp_file</references>
        <references refid="cfdp__config_8h_1a12a28c6a00d2420c97cab45619fb611d" compoundref="cfdp__config_8h" startline="153">MAX_TEMP_FILE_NAME_LENGTH</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" compoundref="cfdp__data__structures_8h" startline="385">TRANS_STATUS::temp_file_name</references>
        <references refid="callbacks_8c_1affbbf8d85e42de813d0bd216e82d34cb" compoundref="callbacks_8c" startline="56">temp_file_name_callback</references>
        <references refid="callbacks_8h_1a392cf5458c41126c4facb8765a77c71e" compoundref="callbacks_8h" startline="62">w_msg__</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1ae5b0d39c79f1d82f3ed442d3462a3ffb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__resume_timers</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__resume_timers</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="639" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="639" bodyend="648"/>
        <references refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" compoundref="machine_8h" startline="65">MACHINE::ack_timer</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" compoundref="machine_8h" startline="66">MACHINE::inactivity_timer</references>
        <references refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" compoundref="machine_8h" startline="67">MACHINE::nak_timer</references>
        <references refid="timer_8c_1a11aeead6a4eb90a8e22f52472cea63e9" compoundref="timer_8c" startline="28" endline="35">timer__is_timer_paused</references>
        <references refid="timer_8c_1aad9299a11de053906c78450507edafa3" compoundref="timer_8c" startline="156" endline="170">timer__resume</references>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a50c0f37a2c8c235d2af8e68a71e375c1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__reuse_senders_first_hdr</definition>
        <argsstring>(HDR incoming_hdr, MACHINE *m)</argsstring>
        <name>aaa__reuse_senders_first_hdr</name>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref></type>
          <declname>incoming_hdr</declname>
        </param>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="653" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="653" bodyend="671"/>
        <references refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" compoundref="structures_8h" startline="201">HDR::direction</references>
        <references refid="struct_m_a_c_h_i_n_e_1ad4de08f39605e2f9e0ae9b842644397d" compoundref="machine_8h" startline="42">MACHINE::has_a_pdu_been_received</references>
        <references refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" compoundref="machine_8h" startline="59">MACHINE::hdr</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab91575938015138bfe798e5ff514e793" compoundref="cfdp__data__structures_8h" startline="378">TRANS_STATUS::partner_id</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" compoundref="cfdp__data__structures_8h" startline="122">TRANSACTION::source_id</references>
        <references refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47aeffd4896b50004023fdd717d63615efb" compoundref="structures_8h" startline="192">TOWARD_RECEIVER</references>
        <references refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47ae0538a5a9db25666a6a48c6d450102ae" compoundref="structures_8h" startline="192">TOWARD_SENDER</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ac231415ffbaaf1f8458e7a45f1c2dde0" compoundref="cfdp__data__structures_8h" startline="361">TRANS_STATUS::trans</references>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a8629fef239864abf8bd76005363847a0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__send_ack</definition>
        <argsstring>(HDR hdr, ACK ack)</argsstring>
        <name>aaa__send_ack</name>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref></type>
          <declname>hdr</declname>
        </param>
        <param>
          <type><ref refid="struct_a_c_k" kindref="compound">ACK</ref></type>
          <declname>ack</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="676" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="676" bodyend="696"/>
        <references refid="pdu__as__string_8c_1a86889bf975693ae3e52b588eb1bf3dc8" compoundref="pdu__as__string_8c" startline="26" endline="76">ack_struct_as_string</references>
        <references refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" compoundref="utils_8c" startline="508" endline="512">cfdp_is_message_class_enabled</references>
        <references refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" compoundref="cfdp__provides_8h" startline="222">CFDP_MSG_DEBUG_PDU</references>
        <references refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" compoundref="cfdp__provides_8h" startline="230">CFDP_MSG_PDU_NON_FILEDATA</references>
        <references refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" compoundref="utils_8c" startline="1075" endline="1087">cfdp_trans_as_string</references>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="aaa_8c_1a455c4446917effdd9115c53127c90da2" compoundref="aaa_8c" startline="110" endline="127">m__partner_id</references>
        <references refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" compoundref="pdu_8c" startline="1272" endline="1307">pdu__display_raw_pdu</references>
        <references refid="pdu_8c_1a12f8c193c32206c76f53dc59084bf485" compoundref="pdu_8c" startline="705" endline="742">pdu__make_ack_pdu</references>
        <references refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" compoundref="callbacks_8h" startline="66">pdu_output__send</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <referencedby refid="r2_8c_1a122a0804b970ba2f4a2c9c7a2e537418" compoundref="r2_8c" startline="211" endline="255">m__release_an_ack_pdu</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1ab637025eab847dfdcefa354fe2a9fa3e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__send_eof</definition>
        <argsstring>(HDR hdr, EOHF eof)</argsstring>
        <name>aaa__send_eof</name>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref></type>
          <declname>hdr</declname>
        </param>
        <param>
          <type><ref refid="struct_e_o_h_f" kindref="compound">EOHF</ref></type>
          <declname>eof</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="701" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="701" bodyend="721"/>
        <references refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" compoundref="utils_8c" startline="508" endline="512">cfdp_is_message_class_enabled</references>
        <references refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" compoundref="cfdp__provides_8h" startline="222">CFDP_MSG_DEBUG_PDU</references>
        <references refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" compoundref="cfdp__provides_8h" startline="230">CFDP_MSG_PDU_NON_FILEDATA</references>
        <references refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" compoundref="utils_8c" startline="1075" endline="1087">cfdp_trans_as_string</references>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" compoundref="structures_8h" startline="205">HDR::dest_id</references>
        <references refid="pdu__as__string_8c_1a045aa58fd7999c93742bb7546a95acd9" compoundref="pdu__as__string_8c" startline="81" endline="114">eof_struct_as_string</references>
        <references refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" compoundref="pdu_8c" startline="1272" endline="1307">pdu__display_raw_pdu</references>
        <references refid="pdu_8c_1a46321ab547c84889c40a8512490ee967" compoundref="pdu_8c" startline="623" endline="659">pdu__make_eof_pdu</references>
        <references refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" compoundref="callbacks_8h" startline="66">pdu_output__send</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <referencedby refid="s1_8c_1acb6c6e825ebb89171b0f48f1f709c6da" compoundref="s1_8c" startline="171" endline="195">m__release_an_eof_pdu</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a277a9d6ed7a91d75545c2802ee7aa8f2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__send_finished</definition>
        <argsstring>(HDR hdr, FIN fin)</argsstring>
        <name>aaa__send_finished</name>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref></type>
          <declname>hdr</declname>
        </param>
        <param>
          <type><ref refid="struct_f_i_n" kindref="compound">FIN</ref></type>
          <declname>fin</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="726" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="726" bodyend="746"/>
        <references refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" compoundref="utils_8c" startline="508" endline="512">cfdp_is_message_class_enabled</references>
        <references refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" compoundref="cfdp__provides_8h" startline="222">CFDP_MSG_DEBUG_PDU</references>
        <references refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" compoundref="cfdp__provides_8h" startline="230">CFDP_MSG_PDU_NON_FILEDATA</references>
        <references refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" compoundref="utils_8c" startline="1075" endline="1087">cfdp_trans_as_string</references>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="pdu__as__string_8c_1a37a224b3292db5700d7a9dcb64112856" compoundref="pdu__as__string_8c" startline="147" endline="178">fin_struct_as_string</references>
        <references refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" compoundref="pdu_8c" startline="1272" endline="1307">pdu__display_raw_pdu</references>
        <references refid="pdu_8c_1a36331f1664e14daaeb444b3c9bbc62b5" compoundref="pdu_8c" startline="663" endline="701">pdu__make_fin_pdu</references>
        <references refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" compoundref="callbacks_8h" startline="66">pdu_output__send</references>
        <references refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" compoundref="cfdp__data__structures_8h" startline="122">TRANSACTION::source_id</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <referencedby refid="r2_8c_1ab173756a3783494c31542090fa45d8d2" compoundref="r2_8c" startline="260" endline="285">m__release_a_fin_pdu</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a1a9aedfb9cf196da646983e3f88dafce" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__send_metadata</definition>
        <argsstring>(HDR hdr, MD md)</argsstring>
        <name>aaa__send_metadata</name>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref></type>
          <declname>hdr</declname>
        </param>
        <param>
          <type><ref refid="struct_m_d" kindref="compound">MD</ref></type>
          <declname>md</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="751" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="751" bodyend="771"/>
        <references refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" compoundref="utils_8c" startline="508" endline="512">cfdp_is_message_class_enabled</references>
        <references refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" compoundref="cfdp__provides_8h" startline="222">CFDP_MSG_DEBUG_PDU</references>
        <references refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" compoundref="cfdp__provides_8h" startline="230">CFDP_MSG_PDU_NON_FILEDATA</references>
        <references refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" compoundref="utils_8c" startline="1075" endline="1087">cfdp_trans_as_string</references>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" compoundref="structures_8h" startline="205">HDR::dest_id</references>
        <references refid="pdu__as__string_8c_1afc1a9d1018b304ab3eab9ab98a861b26" compoundref="pdu__as__string_8c" startline="183" endline="208">md_struct_as_string</references>
        <references refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" compoundref="pdu_8c" startline="1272" endline="1307">pdu__display_raw_pdu</references>
        <references refid="pdu_8c_1a3e899a1a40daf4ed6289cacd81be7c6e" compoundref="pdu_8c" startline="527" endline="587">pdu__make_md_pdu</references>
        <references refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" compoundref="callbacks_8h" startline="66">pdu_output__send</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <referencedby refid="s1_8c_1a95d9a2188b7812ce62433ceedd6754a0" compoundref="s1_8c" startline="106" endline="166">m__release_a_metadata_pdu</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a06d299dc0262a9be72d40d51b166c3da" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__send_nak</definition>
        <argsstring>(HDR hdr, NAK nak)</argsstring>
        <name>aaa__send_nak</name>
        <param>
          <type><ref refid="struct_h_d_r" kindref="compound">HDR</ref></type>
          <declname>hdr</declname>
        </param>
        <param>
          <type><ref refid="struct_n_a_k" kindref="compound">NAK</ref></type>
          <declname>nak</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="776" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="776" bodyend="796"/>
        <references refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" compoundref="utils_8c" startline="508" endline="512">cfdp_is_message_class_enabled</references>
        <references refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" compoundref="cfdp__provides_8h" startline="222">CFDP_MSG_DEBUG_PDU</references>
        <references refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" compoundref="cfdp__provides_8h" startline="230">CFDP_MSG_PDU_NON_FILEDATA</references>
        <references refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" compoundref="utils_8c" startline="1075" endline="1087">cfdp_trans_as_string</references>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="pdu__as__string_8c_1ae3752a3fafe5c4419aee1570bcde9227" compoundref="pdu__as__string_8c" startline="213" endline="228">nak_struct_as_string</references>
        <references refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" compoundref="pdu_8c" startline="1272" endline="1307">pdu__display_raw_pdu</references>
        <references refid="pdu_8c_1a753ca77448affa467fab2483037411bf" compoundref="pdu_8c" startline="747" endline="805">pdu__make_nak_pdu</references>
        <references refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" compoundref="callbacks_8h" startline="66">pdu_output__send</references>
        <references refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" compoundref="cfdp__data__structures_8h" startline="122">TRANSACTION::source_id</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <referencedby refid="r2_8c_1af36297f313b2aa3288e87abff56c74ad" compoundref="r2_8c" startline="290" endline="327">m__release_a_nak_pdu</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1aa96c1938c9bbe72d4e8826ea7854dbd6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__send_one_file_data_pdu</definition>
        <argsstring>(MACHINE *m, FD *fd)</argsstring>
        <name>aaa__send_one_file_data_pdu</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <param>
          <type><ref refid="struct_f_d" kindref="compound">FD</ref> *</type>
          <declname>fd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="801" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="801" bodyend="971"/>
        <references refid="structgap_1a12391414ff856122bc95438776497cbd" compoundref="structures_8h" startline="138">gap::begin</references>
        <references refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" compoundref="structures_8h" startline="241">FD::buffer</references>
        <references refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" compoundref="structures_8h" startline="242">FD::buffer_length</references>
        <references refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" compoundref="utils_8c" startline="508" endline="512">cfdp_is_message_class_enabled</references>
        <references refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" compoundref="cfdp__provides_8h" startline="222">CFDP_MSG_DEBUG_PDU</references>
        <references refid="cfdp__provides_8h_1a0e6d3071ceffc2ebe41beff0238bdb90" compoundref="cfdp__provides_8h" startline="233">CFDP_MSG_PDU_RETRANSMITTED_FD</references>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" compoundref="structures_8h" startline="205">HDR::dest_id</references>
        <references refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" compoundref="callbacks_8h" startline="63">e_msg__</references>
        <references refid="structgap_1a503365cbf83e5bb8917f912403f39e3a" compoundref="structures_8h" startline="139">gap::end</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ae544ea51be439f877608252b12d414bd" compoundref="cfdp__data__structures_8h" startline="369">TRANS_STATUS::fd_length</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a76a8dcbf0559fb2166836b19dcab2471" compoundref="cfdp__data__structures_8h" startline="368">TRANS_STATUS::fd_offset</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" compoundref="cfdp__data__structures_8h" startline="370">TRANS_STATUS::file_checksum_as_calculated</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" compoundref="machine_8h" startline="69">MACHINE::fp</references>
        <references refid="callbacks_8c_1ad75723ad3e4ab1bf351c49403b40f718" compoundref="callbacks_8c" startline="47">fread_callback</references>
        <references refid="callbacks_8c_1af3198af541ba6c8d3535cf18e63de364" compoundref="callbacks_8c" startline="49">fseek_callback</references>
        <references refid="struct_m_a_c_h_i_n_e_1ab4b8b566ffe5f9a843ed061f98803471" compoundref="machine_8h" startline="45">MACHINE::has_eof_been_sent</references>
        <references refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" compoundref="machine_8h" startline="59">MACHINE::hdr</references>
        <references refid="struct_n_a_k_1abc8812e8a65c2078604e01f676830569" compoundref="structures_8h" startline="287">NAK::head</references>
        <references refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9ae4d883d759446b86731342c5c65e6eb4" compoundref="cfdp__data__structures_8h" startline="274">IND_FILE_SEGMENT_SENT</references>
        <references refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" compoundref="default__indication_8c" startline="376" endline="408">indication__</references>
        <references refid="mib_8c_1a04366de404f94e362659e23c91e92fee" compoundref="mib_8c" startline="299" endline="304">mib__issue_file_segment_sent</references>
        <references refid="mib_8c_1a0f6eadf536143f9c20169df8a51cde2e" compoundref="mib_8c" startline="309" endline="314">mib__outgoing_file_chunk_size</references>
        <references refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" compoundref="machine_8h" startline="63">MACHINE::nak</references>
        <references refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</references>
        <references refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" compoundref="structures_8h" startline="240">FD::offset</references>
        <references refid="pdu_8c_1a33182448740ab47dbc2381f3a0401c71" compoundref="pdu_8c" startline="1312" endline="1364">pdu__display_disassembled_pdu</references>
        <references refid="pdu_8c_1af01158fc594979d78bd26edcf519ab16" compoundref="pdu_8c" startline="592" endline="618">pdu__make_fd_pdu</references>
        <references refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" compoundref="callbacks_8h" startline="66">pdu_output__send</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" compoundref="structures_8h" startline="204">HDR::trans</references>
        <references refid="cfdp__config_8h_1ac68e4da4ed53b8b0a08b566311df2259" compoundref="cfdp__config_8h" startline="51">u_int_1</references>
        <references refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" compoundref="cfdp__config_8h" startline="59">u_int_4</references>
        <referencedby refid="s1_8c_1a1bf4984d114c50671f7f92457d7f07d9" compoundref="s1_8c" startline="200" endline="227">m__release_a_file_data_pdu</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a77aeff2d16620a5f809f7a104646e56e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__shutdown</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__shutdown</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="976" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="976" bodyend="1027"/>
        <references refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" compoundref="machine_8h" startline="65">MACHINE::ack_timer</references>
        <references refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" compoundref="callbacks_8h" startline="60">d_msg__</references>
        <references refid="callbacks_8c_1ab45195e00f9ef4f4eca30a8a254f3e8b" compoundref="callbacks_8c" startline="44">fclose_callback</references>
        <references refid="cfdp__data__structures_8h_1a275a67132f10277ada3a0ee3d616b647adbd1812bee789fbf3548cf79d3f2b400" compoundref="cfdp__data__structures_8h" startline="226">FINISHED</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" compoundref="machine_8h" startline="69">MACHINE::fp</references>
        <references refid="struct_m_a_c_h_i_n_e_1a9f3d17df8d0b8d8c8051b9ad5f808a08" compoundref="machine_8h" startline="46">MACHINE::has_this_state_machine_finished</references>
        <references refid="struct_n_a_k_1abc8812e8a65c2078604e01f676830569" compoundref="structures_8h" startline="287">NAK::head</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" compoundref="machine_8h" startline="66">MACHINE::inactivity_timer</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" compoundref="machine_8h" startline="49">MACHINE::is_outgoing_ack_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" compoundref="machine_8h" startline="50">MACHINE::is_outgoing_eof_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" compoundref="machine_8h" startline="51">MACHINE::is_outgoing_fin_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" compoundref="machine_8h" startline="52">MACHINE::is_outgoing_md_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" compoundref="machine_8h" startline="53">MACHINE::is_outgoing_nak_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a0a7025547a73c28e38adc39f04ad45f4" compoundref="machine_8h" startline="54">MACHINE::is_there_a_temp_file</references>
        <references refid="struct_m_a_c_h_i_n_e_1a2a65fc5fc2a7f047af17d8b01cd28077" compoundref="machine_8h" startline="55">MACHINE::is_there_an_open_file</references>
        <references refid="mib_8c_1a521b4dec7fe3800b157e36c83bd079a6" compoundref="mib_8c" startline="319" endline="324">mib__save_incomplete_files</references>
        <references refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" compoundref="machine_8h" startline="63">MACHINE::nak</references>
        <references refid="nak__mem_8c_1aa082478453d5bb8b451ce6600d742797" compoundref="nak__mem_8c" startline="53" endline="84">nak_mem__free</references>
        <references refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" compoundref="machine_8h" startline="67">MACHINE::nak_timer</references>
        <references refid="structgap_1ad2570b6ec1c81c481d237cce1e195cfa" compoundref="structures_8h" startline="140">gap::next</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="callbacks_8c_1a4c755c18a161b44744b94003aa25a2c0" compoundref="callbacks_8c" startline="54">remove_callback</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a436e8d0cdf3b6f4a6fee533a6aef6bf8" compoundref="cfdp__data__structures_8h" startline="382">TRANS_STATUS::state</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" compoundref="cfdp__data__structures_8h" startline="385">TRANS_STATUS::temp_file_name</references>
        <references refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" compoundref="timer_8c" startline="74" endline="78">timer__cancel</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="aaa_8h_1af24279f6dc6f1fb0ef928cc515cdb21c" compoundref="aaa_8c" startline="131" endline="145">aaa__abandon_this_transaction</referencedby>
        <referencedby refid="aaa_8h_1a87d82085dfccdcd452b27101d36975dc" compoundref="aaa_8c" startline="1068" endline="1101">aaa__transaction_has_finished</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a37d91b59bf3e7a27a1c7e38001f3b450" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__store_file_data</definition>
        <argsstring>(FILE *fp, FD *fd)</argsstring>
        <name>aaa__store_file_data</name>
        <param>
          <type>FILE *</type>
          <declname>fp</declname>
        </param>
        <param>
          <type><ref refid="struct_f_d" kindref="compound">FD</ref> *</type>
          <declname>fd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="1032" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="1032" bodyend="1049"/>
        <references refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" compoundref="structures_8h" startline="241">FD::buffer</references>
        <references refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" compoundref="structures_8h" startline="242">FD::buffer_length</references>
        <references refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" compoundref="callbacks_8h" startline="63">e_msg__</references>
        <references refid="callbacks_8c_1af3198af541ba6c8d3535cf18e63de364" compoundref="callbacks_8c" startline="49">fseek_callback</references>
        <references refid="callbacks_8c_1aacc88186b826a5b561c2d2b9b09c13de" compoundref="callbacks_8c" startline="50">fwrite_callback</references>
        <references refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" compoundref="structures_8h" startline="240">FD::offset</references>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1aa74321ddb9e7b8bfe4bb6cdd48e21ea8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__suspend_timers</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__suspend_timers</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="1054" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="1054" bodyend="1063"/>
        <references refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" compoundref="machine_8h" startline="65">MACHINE::ack_timer</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" compoundref="machine_8h" startline="66">MACHINE::inactivity_timer</references>
        <references refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" compoundref="machine_8h" startline="67">MACHINE::nak_timer</references>
        <references refid="timer_8c_1a67b8228457a7af348400e7a0ac3b01a6" compoundref="timer_8c" startline="40" endline="47">timer__is_timer_running</references>
        <references refid="timer_8c_1a6d624aee3dfc033bd6a878ce4cad48c6" compoundref="timer_8c" startline="143" endline="151">timer__pause</references>
        <referencedby refid="aaa_8h_1aab0c4dd6a5085d8e209d817ae0c5203b" compoundref="aaa_8c" startline="537" endline="547">aaa__notice_of_suspension</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      <memberdef kind="function" id="aaa_8c_1a87d82085dfccdcd452b27101d36975dc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void aaa__transaction_has_finished</definition>
        <argsstring>(MACHINE *m)</argsstring>
        <name>aaa__transaction_has_finished</name>
        <param>
          <type><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref> *</type>
          <declname>m</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="apps/cf/fsw/src/PRI/aaa.c" line="1068" column="1" bodyfile="apps/cf/fsw/src/PRI/aaa.c" bodystart="1068" bodyend="1101"/>
        <references refid="aaa_8c_1a77aeff2d16620a5f809f7a104646e56e" compoundref="aaa_8c" startline="976" endline="1027">aaa__shutdown</references>
        <references refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" compoundref="machine_8h" startline="65">MACHINE::ack_timer</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa67e3098cacdbb149e3cd2e51896b429" compoundref="cfdp__data__structures_8h" startline="364">TRANS_STATUS::cancelled</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" compoundref="cfdp__data__structures_8h" startline="371">TRANS_STATUS::final_status</references>
        <references refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a6ca9c4514cda26375183b30094bb1f65" compoundref="cfdp__data__structures_8h" startline="315">FINAL_STATUS_CANCELLED</references>
        <references refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103ae7846fdfb14ed85b27d0e9c373b241c2" compoundref="cfdp__data__structures_8h" startline="317">FINAL_STATUS_NO_METADATA</references>
        <references refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a1ea6c2675a038aaa71e42f2e0fd52be3" compoundref="cfdp__data__structures_8h" startline="314">FINAL_STATUS_SUCCESSFUL</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa865d6ea19908b99b10645ad1f7fc94c" compoundref="cfdp__data__structures_8h" startline="372">TRANS_STATUS::finished</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a5ba0e784f4d11bc73b2fca7ee56dce2e" compoundref="cfdp__data__structures_8h" startline="374">TRANS_STATUS::has_md_been_received</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" compoundref="machine_8h" startline="66">MACHINE::inactivity_timer</references>
        <references refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9aa1e03e1c0c25c2882282949bdaab573e" compoundref="cfdp__data__structures_8h" startline="286">IND_TRANSACTION_FINISHED</references>
        <references refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" compoundref="default__indication_8c" startline="376" endline="408">indication__</references>
        <references refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" compoundref="machine_8h" startline="49">MACHINE::is_outgoing_ack_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" compoundref="machine_8h" startline="50">MACHINE::is_outgoing_eof_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" compoundref="machine_8h" startline="51">MACHINE::is_outgoing_fin_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" compoundref="machine_8h" startline="52">MACHINE::is_outgoing_md_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" compoundref="machine_8h" startline="53">MACHINE::is_outgoing_nak_buffered</references>
        <references refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" compoundref="machine_8h" startline="67">MACHINE::nak_timer</references>
        <references refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" compoundref="aaa_8c" startline="103">NO</references>
        <references refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" compoundref="machine_8h" startline="40">MACHINE::publik</references>
        <references refid="cfdp__private_8h_1a88b795c26c0900ddc7c68576a872ef87" compoundref="cfdp__private_8h" startline="79">R_1</references>
        <references refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a8cc91d6686b3e7ee150d6ed731a7927d" compoundref="cfdp__data__structures_8h" startline="381">TRANS_STATUS::role</references>
        <references refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" compoundref="timer_8c" startline="74" endline="78">timer__cancel</references>
        <references refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" compoundref="aaa_8c" startline="104">YES</references>
        <referencedby refid="r1_8c_1a6d1034f910dc4e2eaba46d8684ebe4e1" compoundref="r1_8c" startline="49" endline="92">m__fault_handler</referencedby>
        <referencedby refid="r2_8c_1a122a0804b970ba2f4a2c9c7a2e537418" compoundref="r2_8c" startline="211" endline="255">m__release_an_ack_pdu</referencedby>
        <referencedby refid="s1_8c_1acb6c6e825ebb89171b0f48f1f709c6da" compoundref="s1_8c" startline="171" endline="195">m__release_an_eof_pdu</referencedby>
        <referencedby refid="r1_8h_1a71b0a6f0b3117235bdcb34c2ac9f0c9b" compoundref="r1_8c" startline="99" endline="485">r1__state_table</referencedby>
        <referencedby refid="r2_8h_1a850b0b4e5a78d63fb46f6ce0a5fd0426" compoundref="r2_8c" startline="337" endline="921">r2__state_table</referencedby>
        <referencedby refid="s2_8h_1ab8cf22449e96aba2a0eba61b08b8e6ab" compoundref="s2_8c" startline="378" endline="842">s2__state_table</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>FILE:<sp/>aaa.c<sp/><sp/><sp/>Action<sp/>routines<sp/>for<sp/>CFDP<sp/>state<sp/>tables.</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/><sp/>Copyright<sp/><sp/>2007-2014<sp/>United<sp/>States<sp/>Government<sp/>as<sp/>represented<sp/>by<sp/>the<sp/></highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/><sp/>Administrator<sp/>of<sp/>the<sp/>National<sp/>Aeronautics<sp/>and<sp/>Space<sp/>Administration.<sp/></highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/><sp/>All<sp/>Other<sp/>Rights<sp/>Reserved.<sp/><sp/></highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/><sp/>This<sp/>software<sp/>was<sp/>created<sp/>at<sp/>NASA&apos;s<sp/>Goddard<sp/>Space<sp/>Flight<sp/>Center.</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/><sp/>This<sp/>software<sp/>is<sp/>governed<sp/>by<sp/>the<sp/>NASA<sp/>Open<sp/>Source<sp/>Agreement<sp/>and<sp/>may<sp/>be<sp/></highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/><sp/>used,<sp/>distributed<sp/>and<sp/>modified<sp/>only<sp/>pursuant<sp/>to<sp/>the<sp/>terms<sp/>of<sp/>that<sp/></highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/>agreement.</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>SPECS:<sp/>aaa.h</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>ORIGINAL<sp/>PROGRAMMER:<sp/><sp/>Tim<sp/>Ray<sp/>301-286-0581</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>CHANGES:</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_07_31<sp/>Tim<sp/>Ray<sp/>(TR)</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Official<sp/>release.<sp/><sp/>(see<sp/>pre_release_changes.log<sp/>for<sp/>earlier<sp/>changes)</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_11_01<sp/>TR</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Updated<sp/>&apos;aaa__display_state_and_event&apos;<sp/>to<sp/>screen<sp/>out<sp/>*both*<sp/>of</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>&apos;throttle&apos;<sp/>events.<sp/><sp/><sp/>(part<sp/>of<sp/>a<sp/>bug<sp/>fix)</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_11_05<sp/>TR</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Made<sp/>a<sp/>small<sp/>change<sp/>to<sp/>the<sp/>way<sp/>that<sp/>Receiver<sp/>state<sp/>machines<sp/>save</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>incomplete<sp/>temp<sp/>files.<sp/><sp/>The<sp/>old<sp/>way<sp/>had<sp/>5<sp/>places<sp/>where<sp/>this<sp/>decision</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>was<sp/>made.<sp/><sp/>The<sp/>new<sp/>way<sp/>has<sp/>only<sp/>2<sp/>places:<sp/><sp/>transaction-finished<sp/>and</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>transaction-abandoned.<sp/><sp/></highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_11_09<sp/>TR</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Better<sp/>portability.<sp/><sp/>C++<sp/>uses<sp/>&apos;public&apos;<sp/>as<sp/>a<sp/>keyword,<sp/>so<sp/>any<sp/>use<sp/>of</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;public&apos;<sp/>as<sp/>a<sp/>variable<sp/>name<sp/>was<sp/>changed<sp/>to<sp/>&apos;publik&apos;.</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_11_19<sp/>TR</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Bug<sp/>fix.<sp/><sp/>&apos;memset&apos;<sp/>was<sp/>misused<sp/>in<sp/>2<sp/>places<sp/>(args<sp/>out<sp/>of<sp/>sequence).</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_12_03<sp/>TR</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Bug<sp/>fix.<sp/><sp/>&apos;aaa__initialize&apos;<sp/>now<sp/>initializes<sp/>the<sp/>&apos;direction&apos;<sp/>field</highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>in<sp/>the<sp/>pdu-header<sp/>to<sp/>&apos;toward_receiver&apos;<sp/>if<sp/>our<sp/>role<sp/>in<sp/>the<sp/>transaction</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>&apos;sender&apos;.<sp/><sp/>Previously,<sp/>the<sp/>&apos;direction&apos;<sp/>field<sp/>was<sp/>not<sp/>set.</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_12_06<sp/>TR</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Enhancement.<sp/><sp/>Message-class<sp/>filtering<sp/>can<sp/>now<sp/>be<sp/>changed<sp/>on-the-fly.</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2007_12_10<sp/>TR</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Better<sp/>coverage<sp/>of<sp/>all<sp/>the<sp/>cases<sp/>in<sp/>which<sp/>the<sp/>Receiver&apos;s<sp/>temp-file</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>should<sp/>be<sp/>saved.<sp/><sp/>A<sp/>new<sp/>boolean<sp/>flag<sp/>(&apos;is_a_file_being_received&apos;)</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>catches<sp/>*all*<sp/>the<sp/>cases<sp/>in<sp/>which<sp/>a<sp/>file<sp/>is<sp/>being<sp/>received<sp/>(and,</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>therefore,<sp/>a<sp/>temp<sp/>file<sp/>exists).</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2008_01_02<sp/>TR</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Made<sp/>assertions<sp/>safer<sp/>(avoid<sp/>crashing<sp/>if<sp/>program<sp/>continues).</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2008_01_24<sp/>TR</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Used<sp/>a<sp/>public<sp/>status<sp/>field<sp/>rather<sp/>than<sp/>a<sp/>private<sp/>status<sp/>field</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>(to<sp/>indicate<sp/>a<sp/>transaction<sp/>that<sp/>exists<sp/>solely<sp/>to<sp/>re-send<sp/>an<sp/>Ack-Fin).</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Bug-fix:<sp/>don&apos;t<sp/>attempt<sp/>to<sp/>remove<sp/>a<sp/>non-existent<sp/>file.</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>fix<sp/>included<sp/>cleaning<sp/>up<sp/>some<sp/>code<sp/>(much<sp/>simpler<sp/>logic<sp/>now).</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Got<sp/>rid<sp/>of<sp/>a<sp/>few<sp/>&apos;machine&apos;<sp/>variables<sp/>and<sp/>one<sp/>local<sp/>subroutine</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>(&apos;m__perhaps_retain_temp_file&apos;).</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/><sp/><sp/>2008_03_03<sp/>TR</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>-<sp/>Removed<sp/>an<sp/>&apos;fflush<sp/>(stdout)&apos;<sp/>near<sp/>line<sp/>1000.</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>*****<sp/>FILE<sp/>CHECKSUM<sp/>*****</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/>Background:<sp/><sp/>The<sp/>file<sp/>checksum<sp/>is<sp/>not<sp/>your<sp/>typical<sp/>checksum.<sp/><sp/>The<sp/></highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/><sp/><sp/>typical<sp/>checksum<sp/>is<sp/>one<sp/>byte<sp/>long<sp/>and<sp/>is<sp/>an<sp/>exclusive-or<sp/>of<sp/>all<sp/>the</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*<sp/><sp/><sp/>data<sp/>bytes.<sp/><sp/>The<sp/>file<sp/>checksum<sp/>is<sp/>4<sp/>bytes<sp/>long.<sp/><sp/>It<sp/>is<sp/>calculated<sp/>by</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*<sp/><sp/><sp/>adding<sp/>together<sp/>all<sp/>the<sp/>bytes<sp/>in<sp/>a<sp/>file<sp/>using<sp/>a<sp/>4-byte-wide<sp/>addition.</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/>Strategy<sp/>used<sp/>here:<sp/><sp/>For<sp/>outgoing<sp/>files,<sp/>the<sp/>file<sp/>checksum<sp/>calculation</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*<sp/><sp/><sp/>is<sp/>performed<sp/>on<sp/>one<sp/>chunk<sp/>of<sp/>file-data<sp/>at<sp/>a<sp/>time<sp/>AS<sp/>PART<sp/>OF<sp/>THE</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/><sp/><sp/>INITIAL<sp/>TRANSMISSION<sp/>OF<sp/>THE<sp/>FILE.<sp/><sp/>This<sp/>strategy<sp/>uses<sp/>much<sp/>less</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/><sp/><sp/>system<sp/>resources<sp/>than<sp/>performing<sp/>the<sp/>calculation<sp/>in<sp/>a<sp/>SEPARATE<sp/>READ</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*<sp/><sp/><sp/>of<sp/>the<sp/>whole<sp/>file,<sp/>but<sp/>the<sp/>algorithm<sp/>is<sp/>more<sp/>complicated...</highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/>*<sp/>Complication:<sp/><sp/>The<sp/>code<sp/>here<sp/>gets<sp/>complicated<sp/>because<sp/>there<sp/>is<sp/>no</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/>*<sp/><sp/><sp/>guarantee<sp/>that<sp/>each<sp/>chunk<sp/>of<sp/>file-data<sp/>will<sp/>be<sp/>a<sp/>multiple<sp/>of<sp/>4<sp/>bytes</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*<sp/><sp/><sp/>in<sp/>length.<sp/>So,<sp/>here<sp/>are<sp/>2<sp/>examples.<sp/><sp/>The<sp/>first<sp/>illustrates<sp/>the</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/><sp/><sp/>conceptual<sp/>calculation.<sp/><sp/>The<sp/>second<sp/>shows<sp/>how<sp/>it<sp/>is<sp/>actually<sp/></highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*<sp/><sp/><sp/>performed<sp/>in<sp/>this<sp/>module.<sp/><sp/>Both<sp/>examples<sp/>use<sp/>a<sp/>file<sp/>that<sp/>is<sp/>12<sp/>bytes</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*<sp/><sp/><sp/>long<sp/>containing<sp/>a<sp/>&quot;ramp&quot;<sp/>pattern<sp/>(byte<sp/>1<sp/>is<sp/>&quot;01&quot;,<sp/>byte<sp/>2<sp/>is<sp/>&quot;02&quot;,<sp/>etc).</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/>Example<sp/>1<sp/>--<sp/>Every<sp/>chunk<sp/>of<sp/>filedata<sp/>is<sp/>a<sp/>multiple<sp/>of<sp/>4<sp/>bytes<sp/>(this<sp/>allows</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/><sp/><sp/>the<sp/>checksum<sp/>calculation<sp/>to<sp/>be<sp/>simple):</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>00<sp/>00<sp/>00<sp/>00<sp/><sp/><sp/>//<sp/>Initial<sp/>checksum<sp/>value</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>01<sp/>02<sp/>03<sp/>04<sp/><sp/><sp/>//<sp/>First<sp/>4<sp/>bytes<sp/>of<sp/>the<sp/>file</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>+<sp/>-----------</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>01<sp/>02<sp/>03<sp/>04<sp/><sp/><sp/>//<sp/>Interim<sp/>checksum<sp/>result</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>05<sp/>06<sp/>07<sp/>08<sp/><sp/><sp/>//<sp/>Second<sp/>4<sp/>bytes<sp/>of<sp/>the<sp/>file</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>+<sp/>-----------<sp/><sp/><sp/>//<sp/></highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>06<sp/>08<sp/>0A<sp/>0C<sp/><sp/><sp/>//<sp/>Interim<sp/>checksum<sp/>result</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>09<sp/>0A<sp/>0B<sp/>0C<sp/><sp/><sp/>//<sp/>Final<sp/>4<sp/>bytes<sp/>of<sp/>the<sp/>file</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>+<sp/>-----------</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>0F<sp/>12<sp/>15<sp/>18<sp/><sp/><sp/>//<sp/>Final<sp/>checksum<sp/>result</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/>Example<sp/>2<sp/>--<sp/>Chunks<sp/>of<sp/>filedata<sp/>are<sp/>not<sp/>a<sp/>multiple<sp/>of<sp/>4<sp/>bytes<sp/>(in<sp/>this</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*<sp/><sp/><sp/>example,<sp/>every<sp/>chunk<sp/>is<sp/>6<sp/>bytes<sp/>long):</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>00<sp/>00<sp/>00<sp/>00<sp/><sp/><sp/>//<sp/>Initial<sp/>checksum<sp/>value</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>01<sp/>02<sp/>03<sp/>04<sp/><sp/><sp/>//<sp/>first<sp/>4<sp/>bytes<sp/>of<sp/>file-data</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>05<sp/>06<sp/>00<sp/>00<sp/><sp/><sp/>//<sp/>5th<sp/>and<sp/>6th<sp/>byte<sp/>of<sp/>file<sp/>plus<sp/>zero-fill<sp/>to<sp/>*right*</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>+<sp/>-----------</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>06<sp/>08<sp/>03<sp/>04<sp/><sp/><sp/>//<sp/>interim<sp/>checksum<sp/>result</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>00<sp/>00<sp/>07<sp/>08<sp/><sp/><sp/>//<sp/>7th<sp/>and<sp/>8th<sp/>byte<sp/>of<sp/>file<sp/>plus<sp/>zero-fill<sp/>to<sp/>*left*</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>09<sp/>0A<sp/>0B<sp/>0C<sp/><sp/><sp/>//<sp/>Final<sp/>4<sp/>bytes<sp/>of<sp/>the<sp/>file</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>+<sp/>-----------</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>0F<sp/>12<sp/>15<sp/>18<sp/><sp/><sp/>//<sp/>Final<sp/>checksum<sp/>result.</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*<sp/>Summary:<sp/><sp/>This<sp/>module<sp/>does<sp/>as<sp/>much<sp/>of<sp/>the<sp/>checksum<sp/>calculation<sp/>as<sp/>it<sp/></highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/><sp/><sp/>can<sp/>in<sp/>4-byte<sp/>operations.<sp/><sp/>It<sp/>may<sp/>handle<sp/>a<sp/>few<sp/>bytes<sp/>at<sp/>the<sp/>beginning</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*<sp/><sp/><sp/>and/or<sp/>end<sp/>of<sp/>a<sp/>chunk<sp/>of<sp/>file-data<sp/>as<sp/>a<sp/>special<sp/>case<sp/>as<sp/>shown<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/>*<sp/><sp/><sp/>above<sp/>examples.</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;netinet/in.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="cfdp_8h" kindref="compound">cfdp.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="cfdp__private_8h" kindref="compound">cfdp_private.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103" refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/><sp/>NO<sp/><sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/><sp/>YES<sp/><sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110" refid="aaa_8c_1a455c4446917effdd9115c53127c90da2" refkind="member"><highlight class="normal"><ref refid="struct_i_d" kindref="compound">ID</ref><sp/><ref refid="aaa_8c_1a455c4446917effdd9115c53127c90da2" kindref="member">m__partner_id</ref><sp/>(<ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>hdr)</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>WHAT<sp/>IT<sp/>DOES:<sp/><sp/>Given<sp/>a<sp/>PDU-header<sp/>from<sp/>an<sp/>outgoing<sp/>PDU,<sp/>this<sp/>routine</highlight></codeline>
<codeline lineno="112"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>determines<sp/>the<sp/>ID<sp/>of<sp/>the<sp/>destination<sp/>entity<sp/>(and<sp/>returns<sp/>the<sp/>ID).</highlight></codeline>
<codeline lineno="113"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal">{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><ref refid="struct_i_d" kindref="compound">ID</ref><sp/><sp/><sp/><sp/><sp/>partner_id;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1a9263c3541844439cf374b3224e2fe70d" kindref="member">cfdp_are_these_ids_equal</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" kindref="member">source_id</ref>,<sp/><ref refid="mib_8c_1a166a0e8f862b5ff7d39b1b5bcf382b98" kindref="member">mib__get_my_id</ref>()))</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Since<sp/>I&apos;m<sp/>the<sp/>source,<sp/>the<sp/>partner<sp/>must<sp/>be<sp/>the<sp/>destination<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>partner_id<sp/>=<sp/>hdr.<ref refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" kindref="member">dest_id</ref>;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Since<sp/>I&apos;m<sp/>not<sp/>the<sp/>source,<sp/>I<sp/>must<sp/>be<sp/>the<sp/>destination.<sp/><sp/>Therefore,</highlight></codeline>
<codeline lineno="123"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>partner<sp/>must<sp/>be<sp/>the<sp/>source.</highlight></codeline>
<codeline lineno="124"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>partner_id<sp/>=<sp/>hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" kindref="member">source_id</ref>;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(partner_id);</highlight></codeline>
<codeline lineno="127"><highlight class="normal">}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight><highlight class="comment">/*=r=*************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131" refid="aaa_8h_1af24279f6dc6f1fb0ef928cc515cdb21c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1af24279f6dc6f1fb0ef928cc515cdb21c" kindref="member">aaa__abandon_this_transaction</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="132"><highlight class="normal">{</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>our<sp/>bookkeeping<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aba5bb97eaf108f40d95a11787ccef9c1" kindref="member">abandoned</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa865d6ea19908b99b10645ad1f7fc94c" kindref="member">finished</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" kindref="member">final_status</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a3ab275c6067eceb63e73c55cdc80f9da" kindref="member">FINAL_STATUS_ABANDONED</ref>;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Let<sp/>the<sp/>user<sp/>know<sp/>about<sp/>this<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><ref refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" kindref="member">indication__</ref><sp/>(<ref refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9a63e62b09d2ed5da36f76552cf4dde88d" kindref="member">IND_ABANDONED</ref>,<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>));</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Shut<sp/>down<sp/>this<sp/>state<sp/>machine<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><ref refid="aaa_8c_1a77aeff2d16620a5f809f7a104646e56e" kindref="member">aaa__shutdown</ref><sp/>(m);</highlight></codeline>
<codeline lineno="145"><highlight class="normal">}</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150" refid="aaa_8h_1a4fd0674b58b8cae8dd34cfec75f9625a" refkind="member"><highlight class="normal"><ref refid="struct_a_c_k" kindref="compound">ACK</ref><sp/><ref refid="aaa_8c_1a4fd0674b58b8cae8dd34cfec75f9625a" kindref="member">aaa__build_ack_eof</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="151"><highlight class="normal">{</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><ref refid="struct_a_c_k" kindref="compound">ACK</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ack;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1a9d1bc82f590c27eb334b3edaf0beaf25" kindref="member">directive_code</ref><sp/>=<sp/><ref refid="structures_8h_1abb28482e818686dbcedaf0fbb3dda0eaa05aa5e806c13fefcefcb11ecc4c0cac3" kindref="member">EOF_PDU</ref>;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1a5d377c03910335c534b288ae9d516cc0" kindref="member">directive_subtype_code</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1a88a6885f40b72b90ff9016a9e69deb10" kindref="member">condition_code</ref><sp/>=<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" kindref="member">eof</ref>.<ref refid="struct_e_o_h_f_1a3b24d8ff0a52b3b6273aa65d678c5fb6" kindref="member">condition_code</ref>;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1ae4cfa1794f86a137a440b43558873a42" kindref="member">delivery_code</ref><sp/>=<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab6aed37045d3d77776cfce2b9ec66717" kindref="member">delivery_code</ref>;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1a23f71d78a642ee940d522f1fba8d65c6" kindref="member">transaction_status</ref><sp/>=<sp/><ref refid="structures_8h_1a4d4561644c7d09ef99b2a32cfab218dcada1b6af1902284145ea8a5e950b10a3f" kindref="member">TRANS_ACTIVE</ref>;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(ack);</highlight></codeline>
<codeline lineno="161"><highlight class="normal">}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166" refid="aaa_8h_1a84aa883eba28de23cfd0f7ded89c1c1e" refkind="member"><highlight class="normal"><ref refid="struct_a_c_k" kindref="compound">ACK</ref><sp/><ref refid="aaa_8c_1a84aa883eba28de23cfd0f7ded89c1c1e" kindref="member">aaa__build_ack_fin</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="167"><highlight class="normal">{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><ref refid="struct_a_c_k" kindref="compound">ACK</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ack;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1a9d1bc82f590c27eb334b3edaf0beaf25" kindref="member">directive_code</ref><sp/>=<sp/><ref refid="structures_8h_1abb28482e818686dbcedaf0fbb3dda0eaa3666b6349eab21a903f683a71e132561" kindref="member">FIN_PDU</ref>;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1a5d377c03910335c534b288ae9d516cc0" kindref="member">directive_subtype_code</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1a88a6885f40b72b90ff9016a9e69deb10" kindref="member">condition_code</ref><sp/>=<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a53699b59fdc5c35fd9c65b9be8595891" kindref="member">fin</ref>.<ref refid="struct_f_i_n_1a016fb1f5c98239c8050e064e8523ed24" kindref="member">condition_code</ref>;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/>ack.<ref refid="struct_a_c_k_1ae4cfa1794f86a137a440b43558873a42" kindref="member">delivery_code</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1ac66edc52b377fe3f3cbe43a899321876ac2d1e01bff4ae937b21ba493cbf2f99d" kindref="member">DONT_CARE_0</ref>;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aee238334b9e82f49718ec32291109b11" kindref="member">is_this_trans_solely_for_ack_fin</ref>)</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>See<sp/>section<sp/>5.2.4<sp/>of<sp/>the<sp/>CFDP<sp/>Blue<sp/>Book<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>ack.<ref refid="struct_a_c_k_1a23f71d78a642ee940d522f1fba8d65c6" kindref="member">transaction_status</ref><sp/>=<sp/><ref refid="structures_8h_1a4d4561644c7d09ef99b2a32cfab218dcaef6b43d3c9bb0500e4c525781336be2a" kindref="member">TRANS_UNDEFINED</ref>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>ack.<ref refid="struct_a_c_k_1a23f71d78a642ee940d522f1fba8d65c6" kindref="member">transaction_status</ref><sp/>=<sp/><ref refid="structures_8h_1a4d4561644c7d09ef99b2a32cfab218dcada1b6af1902284145ea8a5e950b10a3f" kindref="member">TRANS_ACTIVE</ref>;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(ack);</highlight></codeline>
<codeline lineno="181"><highlight class="normal">}</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186" refid="aaa_8h_1a239d8566d3ff00868d590f34740d2efe" refkind="member"><highlight class="normal"><ref refid="struct_e_o_h_f" kindref="compound">EOHF</ref><sp/><ref refid="aaa_8c_1a239d8566d3ff00868d590f34740d2efe" kindref="member">aaa__build_eof</ref><sp/>(<ref refid="cfdp__data__structures_8h_1a3b52de9e08aebbb321c6bc382ea26328" kindref="member">CONDITION_CODE</ref><sp/>condition_code,<sp/></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/>file_checksum,<sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><ref refid="callbacks_8h_1a679b4a6644ab6cfe8551968fbeb3f610" kindref="member">file_size</ref>)</highlight></codeline>
<codeline lineno="188"><highlight class="normal">{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><ref refid="struct_e_o_h_f" kindref="compound">EOHF</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eof;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/>eof.<ref refid="struct_e_o_h_f_1a3b24d8ff0a52b3b6273aa65d678c5fb6" kindref="member">condition_code</ref><sp/>=<sp/>condition_code;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/>eof.<ref refid="struct_e_o_h_f_1a53f9fbdb43acc5e06eba4582941a9626" kindref="member">spare</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/>eof.<ref refid="struct_e_o_h_f_1aa69b44ed9e814c26f573e4868fd74cf4" kindref="member">file_checksum</ref><sp/>=<sp/>file_checksum;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/>eof.<ref refid="struct_e_o_h_f_1acf948090e886e58ab04d7bf3b66657af" kindref="member">file_size</ref><sp/>=<sp/><ref refid="callbacks_8h_1a679b4a6644ab6cfe8551968fbeb3f610" kindref="member">file_size</ref>;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(eof);</highlight></codeline>
<codeline lineno="197"><highlight class="normal">}</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202" refid="aaa_8h_1a2ec9ad100a3b2969711f35afc79ce644" refkind="member"><highlight class="normal"><ref refid="struct_f_i_n" kindref="compound">FIN</ref><sp/><ref refid="aaa_8c_1a2ec9ad100a3b2969711f35afc79ce644" kindref="member">aaa__build_fin</ref><sp/>(<ref refid="cfdp__data__structures_8h_1a3b52de9e08aebbb321c6bc382ea26328" kindref="member">CONDITION_CODE</ref><sp/>condition_code,<sp/></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__data__structures_8h_1ac66edc52b377fe3f3cbe43a899321876" kindref="member">DELIVERY_CODE</ref><sp/>delivery_code)</highlight></codeline>
<codeline lineno="204"><highlight class="normal">{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><ref refid="struct_f_i_n" kindref="compound">FIN</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fin;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/>fin.<ref refid="struct_f_i_n_1a016fb1f5c98239c8050e064e8523ed24" kindref="member">condition_code</ref><sp/>=<sp/>condition_code;</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/>fin.<ref refid="struct_f_i_n_1a178747def8fb327bf011e9fcdc3ccae2" kindref="member">end_system_status</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/>fin.<ref refid="struct_f_i_n_1ae2f8d59cd9662a0a5a475069337b0744" kindref="member">delivery_code</ref><sp/>=<sp/>delivery_code;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/>fin.<ref refid="struct_f_i_n_1a96bceefa2d73a04a6a382ddcd66c7c97" kindref="member">spare</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>&lt;NOT_SUPPORTED&gt;<sp/>Filestore<sp/>Requests<sp/>(Filestore<sp/>Response<sp/>here)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(fin);</highlight></codeline>
<codeline lineno="213"><highlight class="normal">}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218" refid="aaa_8h_1a4e68a443b69d9065911702f2f0112d53" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a6d4ee25e8beaeb1238123690ec84ee87" kindref="member">aaa__build_metadata_from_put_req</ref><sp/>(<ref refid="struct_r_e_q_u_e_s_t" kindref="compound">REQUEST</ref><sp/>request,<sp/><ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>*hdr,<sp/><ref refid="struct_m_d" kindref="compound">MD</ref><sp/>*md)</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Assemble<sp/>the<sp/>PDU-header<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>hdr-&gt;<ref refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" kindref="member">direction</ref><sp/>=<sp/><ref refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47aeffd4896b50004023fdd717d63615efb" kindref="member">TOWARD_RECEIVER</ref>;</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(request.<ref refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad" kindref="member">info</ref>.<ref refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" kindref="member">put</ref>.<ref refid="struct_p_u_t___i_n_f_o_1a8d8458d6859cab3494bd8d75193cdba2" kindref="member">ack_required</ref>)</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hdr-&gt;<ref refid="struct_h_d_r_1a8e1bb4224e30afd6b39d11c2b55f78f8" kindref="member">mode</ref><sp/>=<sp/><ref refid="structures_8h_1a9d6e77d4cbe1fcd2941ae2e09f74a032a4475ec565add8f33ca5bdf9504df88fa" kindref="member">ACK_MODE</ref>;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hdr-&gt;<ref refid="struct_h_d_r_1a8e1bb4224e30afd6b39d11c2b55f78f8" kindref="member">mode</ref><sp/>=<sp/><ref refid="structures_8h_1a9d6e77d4cbe1fcd2941ae2e09f74a032a86d0dcee346aaab05374e13bfe5a703a" kindref="member">UNACK_MODE</ref>;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>hdr-&gt;<ref refid="struct_h_d_r_1a093c783eee5badd07c8cbb2fa9ab50d4" kindref="member">use_crc</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>&lt;NOT_SUPPORTED&gt;<sp/>CRC<sp/>in<sp/>PDUs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>hdr-&gt;<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" kindref="member">source_id</ref><sp/>=<sp/><ref refid="mib_8c_1a166a0e8f862b5ff7d39b1b5bcf382b98" kindref="member">mib__get_my_id</ref><sp/>();</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(the<sp/>transaction-id<sp/>is<sp/>chosen<sp/>for<sp/>me)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>hdr-&gt;<ref refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" kindref="member">dest_id</ref><sp/>=<sp/>request.<ref refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad" kindref="member">info</ref>.<ref refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" kindref="member">put</ref>.<ref refid="struct_p_u_t___i_n_f_o_1a6808d22b94b57c69105a09664eb0d7cc" kindref="member">dest_id</ref>;</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Assemble<sp/>the<sp/>Metadata<sp/>directive<sp/>that<sp/>follows<sp/>the<sp/>PDU-header<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>md-&gt;<ref refid="struct_m_d_1af43b09440cf76cde397e8d876c3a8130" kindref="member">file_transfer</ref><sp/>=<sp/>request.<ref refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad" kindref="member">info</ref>.<ref refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" kindref="member">put</ref>.<ref refid="struct_p_u_t___i_n_f_o_1a0f1fe47d2a56a42265ff65a6aa287467" kindref="member">file_transfer</ref>;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>memset<sp/>(md-&gt;<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>,<sp/>0,<sp/><ref refid="cfdp__config_8h_1a9958e549a943ec37c7fbb33685befb02" kindref="member">MAX_FILE_NAME_LENGTH</ref>);</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>memset<sp/>(md-&gt;<ref refid="struct_m_d_1a5a85cb4df082239b96234b800e174870" kindref="member">dest_file_name</ref>,<sp/>0,<sp/><ref refid="cfdp__config_8h_1a9958e549a943ec37c7fbb33685befb02" kindref="member">MAX_FILE_NAME_LENGTH</ref>);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(md-&gt;<ref refid="struct_m_d_1af43b09440cf76cde397e8d876c3a8130" kindref="member">file_transfer</ref>)</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__private_8h_1a71855d533cf9af9d0ff6506adf422ae7" kindref="member">COPY</ref><sp/>(md-&gt;<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>,<sp/>request.<ref refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad" kindref="member">info</ref>.<ref refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" kindref="member">put</ref>.<ref refid="struct_p_u_t___i_n_f_o_1a324d49720dfd1891abb344bd89e90487" kindref="member">source_file_name</ref>);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__private_8h_1a71855d533cf9af9d0ff6506adf422ae7" kindref="member">COPY</ref><sp/>(md-&gt;<ref refid="struct_m_d_1a5a85cb4df082239b96234b800e174870" kindref="member">dest_file_name</ref>,<sp/>request.<ref refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad" kindref="member">info</ref>.<ref refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" kindref="member">put</ref>.<ref refid="struct_p_u_t___i_n_f_o_1abad4d56f97566b50d27e3cb91265d558" kindref="member">dest_file_name</ref>);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>md-&gt;<ref refid="struct_m_d_1ab0d079723734fa10ae2e95e81e63f128" kindref="member">file_size</ref><sp/>=<sp/><ref refid="callbacks_8c_1a4c53d2da55948c847c1124091d844a0d" kindref="member">file_size_callback</ref><sp/>(md-&gt;<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>md-&gt;<ref refid="struct_m_d_1a8483756b650d370a9f73c5eb67d5a981" kindref="member">segmentation_control</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>&lt;NOT_SUPPORTED&gt;<sp/>Segmented<sp/>files<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249" refid="aaa_8h_1a5c6487ec1a3f1c958be14d27dd4f22e9" refkind="member"><highlight class="normal"><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><ref refid="aaa_8c_1a5c6487ec1a3f1c958be14d27dd4f22e9" kindref="member">aaa__calculate_file_checksum</ref><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*file_name)</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BUFFER_SIZE<sp/>1024</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><sp/>buffer<sp/>[<ref refid="aaa_8c_1a6b20d41d6252e9871430c242cb1a56e7" kindref="member">BUFFER_SIZE</ref>];</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>FILE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*fp;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*iptr;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*---------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>the<sp/>specified<sp/>&apos;file&apos;<sp/>for<sp/>reading<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*---------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>fp<sp/>=<sp/><ref refid="callbacks_8c_1a9ac157931bc57e515038b05704d56928" kindref="member">fopen_callback</ref><sp/>(file_name,<sp/></highlight><highlight class="stringliteral">&quot;rb&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp<sp/>==<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>Unable<sp/>to<sp/>open<sp/>file<sp/>(%s)<sp/>to<sp/>calculate<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;checksum.\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file_name);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1af5822b84946d824c15c38ab09085b5eb" kindref="member">ASSERT__</ref><sp/>(fp<sp/>!=<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>);</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>a<sp/>bogus<sp/>answer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(0xdeadbeef);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*---------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Perform<sp/>the<sp/>checksum<sp/>calculation<sp/>on<sp/>one<sp/>chunk<sp/>of<sp/>the<sp/>file<sp/>at<sp/>a<sp/>time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*---------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>&apos;memset&apos;<sp/>is<sp/>critical.<sp/><sp/>It<sp/>allows<sp/>us<sp/>to<sp/>use<sp/>the<sp/>simple</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>&quot;4<sp/>bytes<sp/>at<sp/>a<sp/>time&quot;<sp/>method<sp/>even<sp/>if<sp/>the<sp/>length<sp/>of<sp/>the<sp/>file</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>is<sp/>not<sp/>a<sp/>multiple<sp/>of<sp/>4<sp/>bytes.<sp/><sp/></highlight></codeline>
<codeline lineno="284"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(If<sp/>the<sp/>very<sp/>last<sp/>&quot;4<sp/>byte&quot;<sp/>piece<sp/>of<sp/>the<sp/>file<sp/>is<sp/>actually</highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>less<sp/>than<sp/>4<sp/>bytes,<sp/>the<sp/>zeros<sp/>will<sp/>ensure<sp/>that<sp/>the<sp/>checksum</highlight></codeline>
<codeline lineno="286"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>result<sp/>is<sp/>still<sp/>correct).</highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset<sp/>(buffer,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(buffer));</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>next<sp/>chunk<sp/>of<sp/>the<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length<sp/>=<sp/><ref refid="callbacks_8c_1ad75723ad3e4ab1bf351c49403b40f718" kindref="member">fread_callback</ref><sp/>(buffer,<sp/>1,<sp/><ref refid="aaa_8c_1a6b20d41d6252e9871430c242cb1a56e7" kindref="member">BUFFER_SIZE</ref>,<sp/>fp);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(length<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We&apos;ve<sp/>read<sp/>the<sp/>whole<sp/>file,<sp/>so<sp/>we&apos;re<sp/>done<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We&apos;ve<sp/>read<sp/>a<sp/>chunk<sp/>of<sp/>the<sp/>file<sp/>--<sp/>all<sp/>chunks<sp/>(except<sp/>the<sp/>last)</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>will<sp/>be<sp/>&apos;BUFFER_SIZE&apos;<sp/>bytes<sp/>in<sp/>length;<sp/>the<sp/>last<sp/>chunk<sp/>will<sp/></highlight></codeline>
<codeline lineno="298"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>probably<sp/>be<sp/>less<sp/>than<sp/>&apos;BUFFER_SIZE&apos;<sp/>bytes.</highlight></codeline>
<codeline lineno="299"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>up<sp/>a<sp/>pointer<sp/>to<sp/>walk<sp/>through<sp/>the<sp/>buffer<sp/>4<sp/>bytes<sp/>at<sp/>a<sp/>time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iptr<sp/>=<sp/>(<ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/>*)<sp/>buffer;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;length;<sp/>i+=4)</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Add<sp/>each<sp/>4<sp/>byte<sp/>piece<sp/>to<sp/>the<sp/>checksum.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>+=<sp/>ntohl<sp/>(*iptr);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iptr<sp/>++;</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Close<sp/>the<sp/>file<sp/>and<sp/>return<sp/>the<sp/>checksum<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8c_1ab45195e00f9ef4f4eca30a8a254f3e8b" kindref="member">fclose_callback</ref><sp/>(fp);</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(checksum);</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight><highlight class="preprocessor">#undef<sp/>BUFFER_SIZE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight><highlight class="comment">/*=r=*************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320" refid="aaa_8h_1a8016d4851bbcdb64b6a4b63c9e52bf60" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a8016d4851bbcdb64b6a4b63c9e52bf60" kindref="member">aaa__cancel_locally</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="321"><highlight class="normal">{</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cancel<sp/>all<sp/>timers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>outgoing<sp/>queues<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" kindref="member">is_outgoing_ack_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" kindref="member">is_outgoing_eof_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" kindref="member">is_outgoing_fin_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" kindref="member">is_outgoing_md_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" kindref="member">is_outgoing_nak_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>bookkeeping<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa67e3098cacdbb149e3cd2e51896b429" kindref="member">cancelled</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="338"><highlight class="normal">}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343" refid="aaa_8h_1ac364673f8d1465636dad40c034df8f5a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1ac364673f8d1465636dad40c034df8f5a" kindref="member">aaa__display_state_and_event</ref><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*which_state_table,</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__data__structures_8h_1a275a67132f10277ada3a0ee3d616b647" kindref="member">STATE</ref><sp/>state,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>event)</highlight></codeline>
<codeline lineno="345"><highlight class="normal">{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((event<sp/>==<sp/><ref refid="event_8h_1a13b9eedf995f4502cc976b174327d77ea1efa2490ee1e5105c7476cfe812e9edf" kindref="member">THROTTLE_OUTGOING_FILE_DIR_PDU</ref>)<sp/>||<sp/></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(event<sp/>==<sp/><ref refid="event_8h_1a13b9eedf995f4502cc976b174327d77ead2deebb3137669ac0c6ae45e049be738" kindref="member">THROTTLE_OUTGOING_FILE_DATA_PDU</ref>)<sp/>||<sp/></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(event<sp/>==<sp/><ref refid="event_8h_1a13b9eedf995f4502cc976b174327d77ea9f239ae9c424a595b4597b2b08c8c2d2" kindref="member">RECEIVED_FILEDATA_PDU</ref>))</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Don&apos;t<sp/>display<sp/>these<sp/>events<sp/>(they<sp/>happen<sp/>so<sp/>frequently<sp/>that<sp/>they<sp/></highlight></codeline>
<codeline lineno="352"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>would<sp/>hide<sp/>all<sp/>the<sp/>interesting<sp/>events)</highlight></codeline>
<codeline lineno="353"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;&lt;%s&gt;<sp/>S%u<sp/>+<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>which_state_table,<sp/>state,<sp/><ref refid="event_8c_1ad44c693cefb56c25be234d1a68bca9b4" kindref="member">event__event_as_string</ref><sp/>(event));</highlight></codeline>
<codeline lineno="359"><highlight class="normal">}</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364" refid="aaa_8h_1a03cec53085b0a1a2f7da4f72c3330d52" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a03cec53085b0a1a2f7da4f72c3330d52" kindref="member">aaa__is_file_checksum_valid</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Calculate<sp/>a<sp/>checksum<sp/>on<sp/>the<sp/>received<sp/>(temporary)<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" kindref="member">file_checksum_as_calculated</ref><sp/>=<sp/></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="aaa_8c_1a5c6487ec1a3f1c958be14d27dd4f22e9" kindref="member">aaa__calculate_file_checksum</ref><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>See<sp/>if<sp/>it<sp/>matches<sp/>the<sp/>transmitted<sp/>checksum<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" kindref="member">file_checksum_as_calculated</ref><sp/>!=<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" kindref="member">eof</ref>.<ref refid="struct_e_o_h_f_1aa69b44ed9e814c26f573e4868fd74cf4" kindref="member">file_checksum</ref>)</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>checksum<sp/>mismatch<sp/>--<sp/>%0x<sp/>/<sp/>%0x<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;(eof/calculated)<sp/>bypass<sp/>at<sp/>aaa.c<sp/>ln<sp/>384\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" kindref="member">eof</ref>.<ref refid="struct_e_o_h_f_1aa69b44ed9e814c26f573e4868fd74cf4" kindref="member">file_checksum</ref>,<sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" kindref="member">file_checksum_as_calculated</ref>);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(NO);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>);</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388" refid="aaa_8h_1af9b859b15f97846f835fca9103693fa7" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1af9b859b15f97846f835fca9103693fa7" kindref="member">aaa__is_file_size_valid</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1abc401184f057ba16d024b046deaf3322" kindref="member">received_file_size</ref><sp/>&gt;<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" kindref="member">eof</ref>.<ref refid="struct_e_o_h_f_1acf948090e886e58ab04d7bf3b66657af" kindref="member">file_size</ref>)</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>file<sp/>size<sp/>mismatch<sp/>--<sp/>%Lu<sp/>/<sp/>%lu<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;(eof/received))\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a10896a7f7589f9a9d07fe736fc7dbfe9" kindref="member">eof</ref>.<ref refid="struct_e_o_h_f_1acf948090e886e58ab04d7bf3b66657af" kindref="member">file_size</ref>,<sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1abc401184f057ba16d024b046deaf3322" kindref="member">received_file_size</ref>);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406" refid="aaa_8h_1aeb0e512ce199b7b278cb0a92223ffbe0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1aeb0e512ce199b7b278cb0a92223ffbe0" kindref="member">aaa__initialize</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m,<sp/><ref refid="struct_r_e_q_u_e_s_t" kindref="compound">REQUEST</ref><sp/>*req_ptr,<sp/><ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>*hdr_ptr)</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>NOTE:<sp/>Some<sp/>status<sp/>is<sp/>initialized<sp/>the<sp/>same<sp/>for<sp/>both<sp/>Senders<sp/>and</highlight></codeline>
<codeline lineno="408"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>Receivers<sp/>(the<sp/>first<sp/>half<sp/>of<sp/>this<sp/>routine);<sp/>other<sp/>status<sp/>is</highlight></codeline>
<codeline lineno="409"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>specific<sp/>to<sp/>Senders<sp/>and<sp/>Receivers<sp/>(the<sp/>second<sp/>half<sp/>of<sp/>this<sp/>routine).</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Public<sp/>status<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aba5bb97eaf108f40d95a11787ccef9c1" kindref="member">abandoned</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ac85ab7838e832d906891610f590710ea" kindref="member">attempts</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa67e3098cacdbb149e3cd2e51896b429" kindref="member">cancelled</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab2997675b95baf36df9c3082b4a37b3a" kindref="member">condition_code</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a3b52de9e08aebbb321c6bc382ea26328abf350750d0d4fabd8954c0f1e9bbae94" kindref="member">NO_ERROR</ref>;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab6aed37045d3d77776cfce2b9ec66717" kindref="member">delivery_code</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1ac66edc52b377fe3f3cbe43a899321876a6bb36d7ca7eef94949ed18270408c563" kindref="member">DATA_INCOMPLETE</ref>;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a76a8dcbf0559fb2166836b19dcab2471" kindref="member">fd_offset</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" kindref="member">file_checksum_as_calculated</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" kindref="member">final_status</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a478828c81260a5fcdb79ebf9c20afa7d" kindref="member">FINAL_STATUS_UNKNOWN</ref>;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa865d6ea19908b99b10645ad1f7fc94c" kindref="member">finished</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="misc_8c_1af05f4e0fc5bb14fa96bc49a4ede70357" kindref="member">misc__are_any_partners_frozen</ref><sp/>())</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a84a627069cfee8ba0268257f0b3e3f03" kindref="member">frozen</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a84a627069cfee8ba0268257f0b3e3f03" kindref="member">frozen</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a5ba0e784f4d11bc73b2fca7ee56dce2e" kindref="member">has_md_been_received</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a837800c77a515fb383411a618a410dc0" kindref="member">how_many_naks</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aee238334b9e82f49718ec32291109b11" kindref="member">is_this_trans_solely_for_ack_fin</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>memset<sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>));</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>memset<sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1a5a85cb4df082239b96234b800e174870" kindref="member">dest_file_name</ref>,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1a5a85cb4df082239b96234b800e174870" kindref="member">dest_file_name</ref>));</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a84b743695ba1ede8736c3f5ebb05cd99" kindref="member">phase</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1abc401184f057ba16d024b046deaf3322" kindref="member">received_file_size</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>&quot;role&quot;<sp/>is<sp/>set<sp/>below<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>time<sp/>(&amp;(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aaf374215936de0d07f1805747e27ddae" kindref="member">start_time</ref>));</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a436e8d0cdf3b6f4a6fee533a6aef6bf8" kindref="member">state</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a275a67132f10277ada3a0ee3d616b647a4eda5f72b331209ee9bc2d8fb2c02e7e" kindref="member">S1</ref>;</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab0cdb83414e6745e817827bdf42be838" kindref="member">suspended</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>strcpy<sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1a5a85cb4df082239b96234b800e174870" kindref="member">dest_file_name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Unknown&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1a8483756b650d370a9f73c5eb67d5a981" kindref="member">segmentation_control</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Private<sp/>status<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>.<ref refid="struct_t_i_m_e_r_1ac25f3daa9a29ceb01edc1b6fd6c4b226" kindref="member">mode</ref><sp/>=<sp/><ref refid="timer_8h_1a15e57fd0ba6550341fe791c32292bea7af959aed8d5fd3cb662409c9dcabe6c73" kindref="member">TIMER_OFF</ref>;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a791c795c9b8f94415bfef3e30f0cec42" kindref="member">has_eof_been_received</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab4b8b566ffe5f9a843ed061f98803471" kindref="member">has_eof_been_sent</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ad4de08f39605e2f9e0ae9b842644397d" kindref="member">has_a_pdu_been_received</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1af6e7e6cd7219636d60aa319d214b02f1" kindref="member">has_a_put_request_been_received</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a9f3d17df8d0b8d8c8051b9ad5f808a08" kindref="member">has_this_state_machine_finished</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71b9a1432a405040140194f6bca1704a" kindref="member">have_we_initiated_a_cancel</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>.<ref refid="struct_t_i_m_e_r_1ac25f3daa9a29ceb01edc1b6fd6c4b226" kindref="member">mode</ref><sp/>=<sp/><ref refid="timer_8h_1a15e57fd0ba6550341fe791c32292bea7af959aed8d5fd3cb662409c9dcabe6c73" kindref="member">TIMER_OFF</ref>;</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0a7025547a73c28e38adc39f04ad45f4" kindref="member">is_there_a_temp_file</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a80b275c61b5029c15b2121819bd7d201" kindref="member">is_external_xfer_open</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" kindref="member">is_outgoing_md_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" kindref="member">is_outgoing_eof_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" kindref="member">is_outgoing_ack_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" kindref="member">is_outgoing_nak_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" kindref="member">is_outgoing_fin_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2a65fc5fc2a7f047af17d8b01cd28077" kindref="member">is_there_an_open_file</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0dee57b83bae5ff84bd25cb53cdeaa03" kindref="member">is_user_inside_the_engine_core</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(m-&gt;nak<sp/>is<sp/>initialized<sp/>below)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>.<ref refid="struct_t_i_m_e_r_1ac25f3daa9a29ceb01edc1b6fd6c4b226" kindref="member">mode</ref><sp/>=<sp/><ref refid="timer_8h_1a15e57fd0ba6550341fe791c32292bea7af959aed8d5fd3cb662409c9dcabe6c73" kindref="member">TIMER_OFF</ref>;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a76935ecb4670a6b5d85f11437da9de5d" kindref="member">should_external_xfer_be_closed</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>should<sp/>be<sp/>passed<sp/>either<sp/>a<sp/>User<sp/>Request<sp/>or<sp/>PDU,<sp/>but<sp/>not<sp/>both<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1af5822b84946d824c15c38ab09085b5eb" kindref="member">ASSERT__</ref><sp/>(((req_ptr<sp/>==<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)<sp/>&amp;&amp;<sp/>(hdr_ptr<sp/>!=<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>))<sp/>||</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((req_ptr<sp/>!=<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)<sp/>&amp;&amp;<sp/>(hdr_ptr<sp/>==<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)));</highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>a<sp/>User<sp/>Request<sp/>was<sp/>passed<sp/>in<sp/>to<sp/>this<sp/>routine,<sp/>then<sp/>our<sp/>role<sp/>in</highlight></codeline>
<codeline lineno="470"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>transaction<sp/>is<sp/>Sender<sp/>(because<sp/>Sender<sp/>transactions<sp/>are<sp/></highlight></codeline>
<codeline lineno="471"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>initiated<sp/>by<sp/>Put<sp/>Requests).</highlight></codeline>
<codeline lineno="472"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(req_ptr<sp/>!=<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>in<sp/>the<sp/>our<sp/>role<sp/>(i.e.<sp/>Class<sp/>1<sp/>or<sp/>Class<sp/>2<sp/>Sender)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(req_ptr-&gt;<ref refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad" kindref="member">info</ref>.<ref refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" kindref="member">put</ref>.<ref refid="struct_p_u_t___i_n_f_o_1a8d8458d6859cab3494bd8d75193cdba2" kindref="member">ack_required</ref>)</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a8cc91d6686b3e7ee150d6ed731a7927d" kindref="member">role</ref><sp/>=<sp/><ref refid="cfdp__private_8h_1a9aeea80da90f54583c19377c478a722d" kindref="member">S_2</ref>;</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a8cc91d6686b3e7ee150d6ed731a7927d" kindref="member">role</ref><sp/>=<sp/><ref refid="cfdp__private_8h_1a5b24031722f14807776a4f1d4ba01edc" kindref="member">S_1</ref>;</highlight></codeline>
<codeline lineno="480"><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nak_8c_1a3e3ace1ad5fe5553cee03be1c43ce7d2" kindref="member">nak__init</ref><sp/>(&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" kindref="member">nak</ref>),<sp/><ref refid="nak_8h_1af42d7c94f24a752ff5c0eadb3e531c85" kindref="member">I_AM_A_SENDER</ref>);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fill<sp/>in<sp/>the<sp/>PDU<sp/>header<sp/>that<sp/>will<sp/>be<sp/>used<sp/>for<sp/>all<sp/>outgoing<sp/>PDUs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" kindref="member">direction</ref><sp/>=<sp/><ref refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47aeffd4896b50004023fdd717d63615efb" kindref="member">TOWARD_RECEIVER</ref>;</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" kindref="member">source_id</ref><sp/>=<sp/><ref refid="mib_8c_1a166a0e8f862b5ff7d39b1b5bcf382b98" kindref="member">mib__get_my_id</ref><sp/>();</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a72a97fa01798321b3c09dd7fa28b3a36" kindref="member">number</ref><sp/>=<sp/><ref refid="misc_8c_1a2c1a2e36545d680269a71810e85bfb56" kindref="member">misc__new_trans_seq_num</ref><sp/>();</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" kindref="member">dest_id</ref><sp/>=<sp/>req_ptr-&gt;<ref refid="struct_r_e_q_u_e_s_t_1ae6512913d918b41b9b465bfd5ac2e0ad" kindref="member">info</ref>.<ref refid="struct_r_e_q_u_e_s_t_1a529adecbd779e156296df7ff389fbfdd" kindref="member">put</ref>.<ref refid="struct_p_u_t___i_n_f_o_1a6808d22b94b57c69105a09664eb0d7cc" kindref="member">dest_id</ref>;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>a<sp/>PDU-header<sp/>was<sp/>passed<sp/>in<sp/>to<sp/>this<sp/>routine,<sp/>then<sp/>our<sp/>role<sp/>in<sp/>the<sp/></highlight></codeline>
<codeline lineno="491"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>transaction<sp/>is<sp/>Receiver<sp/>(because<sp/>Receiver<sp/>transactions<sp/>are</highlight></codeline>
<codeline lineno="492"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>initiated<sp/>by<sp/>incoming<sp/>Metatadata/Filedata/EOF<sp/>PDUs).</highlight></codeline>
<codeline lineno="493"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(hdr_ptr<sp/>!=<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Store<sp/>the<sp/>given<sp/>PDU<sp/>header<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref><sp/>=<sp/>*hdr_ptr;<sp/><sp/></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a8cc91d6686b3e7ee150d6ed731a7927d" kindref="member">role</ref><sp/>=<sp/><ref refid="pdu_8c_1a0ccbdebd41d7d161f110958f6330b8b0" kindref="member">pdu__receiver_role_from_pdu_hdr</ref><sp/>(*hdr_ptr);</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nak_8c_1a3e3ace1ad5fe5553cee03be1c43ce7d2" kindref="member">nak__init</ref><sp/>(&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" kindref="member">nak</ref>),<sp/><ref refid="nak_8h_1a741c56f36f51042ec7d2908b17fec458" kindref="member">I_AM_A_RECEIVER</ref>);</highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Start<sp/>the<sp/>Inactivity-timer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref><sp/>=<sp/><ref refid="timer_8c_1a30fd0ecdbef505c1883cda8504b916d8" kindref="member">timer__start</ref><sp/>(<ref refid="mib_8c_1adc8b930dc6daf9cce514813024fae2bc" kindref="member">mib__inactivity_timeout</ref>(<ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>));</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="510" refid="aaa_8h_1a292abc96e2da36a63b0688b497c2a4fc" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a292abc96e2da36a63b0688b497c2a4fc" kindref="member">aaa__is_file_structure_valid</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="514"><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1a8483756b650d370a9f73c5eb67d5a981" kindref="member">segmentation_control</ref>)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(!<ref refid="callbacks_8c_1adaf972193454a60dd6047b182fac808d" kindref="member">is_file_segmented_callback</ref><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>)))</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>invalid<sp/>file<sp/>structure<sp/>(file<sp/>should<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;be<sp/>segmented)\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>);</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="522"><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((!mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1a8483756b650d370a9f73c5eb67d5a981" kindref="member">segmentation_control</ref>)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="callbacks_8c_1adaf972193454a60dd6047b182fac808d" kindref="member">is_file_segmented_callback</ref><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>)))</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>invalid<sp/>file<sp/>structure<sp/>(file<sp/>should<sp/>not<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;be<sp/>segmented)\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>);</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>);</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight><highlight class="comment">/*=r=*************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537" refid="aaa_8h_1aab0c4dd6a5085d8e209d817ae0c5203b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1aab0c4dd6a5085d8e209d817ae0c5203b" kindref="member">aaa__notice_of_suspension</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="538"><highlight class="normal">{</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab0cdb83414e6745e817827bdf42be838" kindref="member">suspended</ref>)</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab0cdb83414e6745e817827bdf42be838" kindref="member">suspended</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="aaa_8c_1aa74321ddb9e7b8bfe4bb6cdd48e21ea8" kindref="member">aaa__suspend_timers</ref><sp/>(m);</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" kindref="member">indication__</ref><sp/>(<ref refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9a70df2823f3d0023ef818e9c72026eb31" kindref="member">IND_SUSPENDED</ref>,<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>));</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="547"><highlight class="normal">}</highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552" refid="aaa_8h_1a125e9d605218cb5b893832e5698d9cc1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a125e9d605218cb5b893832e5698d9cc1" kindref="member">aaa__open_source_file</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" kindref="member">fp</ref><sp/>=<sp/><ref refid="callbacks_8c_1a9ac157931bc57e515038b05704d56928" kindref="member">fopen_callback</ref><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a827d89e86e8e197147720246e9a22708" kindref="member">md</ref>.<ref refid="struct_m_d_1aeb82449d4978e44cd985a0f9be799396" kindref="member">source_file_name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;rb&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" kindref="member">fp</ref><sp/>==<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2a65fc5fc2a7f047af17d8b01cd28077" kindref="member">is_there_an_open_file</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="566"><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="570" refid="aaa_8h_1a7ad82ee8a918e60e37786bf20fb7f348" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a7ad82ee8a918e60e37786bf20fb7f348" kindref="member">aaa__open_temp_file</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_length;</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>[1024];</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>&lt;ENHANCEMENT&gt;<sp/>Add<sp/>later!!!<sp/><sp/>make<sp/>sure<sp/>Receiver<sp/>has<sp/>room<sp/>for<sp/>a<sp/>file</highlight></codeline>
<codeline lineno="579"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>&apos;mp-&gt;md.file_size&apos;<sp/>bytes<sp/>long<sp/>that<sp/>will<sp/>be<sp/>named</highlight></codeline>
<codeline lineno="580"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>&apos;mp-&gt;md.dest_file_name&apos;.</highlight></codeline>
<codeline lineno="581"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>a<sp/>name<sp/>for<sp/>the<sp/>temporary<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Note:<sp/><sp/>It&apos;s<sp/>kind<sp/>of<sp/>weird<sp/>to<sp/>have<sp/>a<sp/>&apos;for&apos;<sp/>loop<sp/>here.<sp/><sp/>But<sp/>the</highlight></codeline>
<codeline lineno="585"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>general<sp/>idea<sp/>seems<sp/>reasonable:<sp/><sp/>if<sp/>the<sp/>first<sp/>file-name<sp/>chosen<sp/>for</highlight></codeline>
<codeline lineno="586"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>temp-file<sp/>doesn&apos;t<sp/>work,<sp/>then<sp/>don&apos;t<sp/>give<sp/>up<sp/>--<sp/>try<sp/>multiple<sp/></highlight></codeline>
<codeline lineno="587"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>times.</highlight></codeline>
<codeline lineno="588"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;100;<sp/>i++)</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Generate<sp/>a<sp/>candidate<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(name)<sp/>&lt;<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>))</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>should<sp/>never<sp/>happen,<sp/>but<sp/>if<sp/>it<sp/>does,<sp/>avoid<sp/>crashing<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>MAX_TEMP_FILE_NAME_LENGTH<sp/>is<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;too<sp/>big<sp/>(%u).\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1a12a28c6a00d2420c97cab45619fb611d" kindref="member">MAX_TEMP_FILE_NAME_LENGTH</ref>);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>);</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_length<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(name);</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset<sp/>(name,<sp/>0,<sp/>max_length);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy<sp/>(name,<sp/><ref refid="callbacks_8c_1affbbf8d85e42de813d0bd216e82d34cb" kindref="member">temp_file_name_callback</ref>(name),<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(name));</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name[max_length-1]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strlen(name)<sp/>&gt;<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>))</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>temp<sp/>file<sp/>name<sp/>(%s)<sp/>exceeds<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;storage<sp/>capacity<sp/>(%u)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name,<sp/><ref refid="cfdp__config_8h_1a12a28c6a00d2420c97cab45619fb611d" kindref="member">MAX_TEMP_FILE_NAME_LENGTH</ref>);</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Avoid<sp/>crashing...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__private_8h_1a71855d533cf9af9d0ff6506adf422ae7" kindref="member">COPY</ref><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>,<sp/>name);</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Open<sp/>the<sp/>chosen<sp/>temp<sp/>file<sp/>name<sp/>(for<sp/>write<sp/>access)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" kindref="member">fp</ref><sp/>=<sp/><ref refid="callbacks_8c_1a9ac157931bc57e515038b05704d56928" kindref="member">fopen_callback</ref><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;wb&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" kindref="member">fp</ref><sp/>!=<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Success<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0a7025547a73c28e38adc39f04ad45f4" kindref="member">is_there_a_temp_file</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>);</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a392cf5458c41126c4facb8765a77c71e" kindref="member">w_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>candidate<sp/>temp<sp/>file<sp/>(%s)<sp/>open<sp/>failed.\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>);</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>we<sp/>get<sp/>here,<sp/>something<sp/>is<sp/>wrong<sp/>(many<sp/>failed<sp/>attempts)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>Unable<sp/>to<sp/>open<sp/>a<sp/>temp<sp/>file.\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>);</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="635"><highlight class="normal"></highlight></codeline>
<codeline lineno="636"><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight><highlight class="comment">/*=r=*************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="639" refid="aaa_8h_1ae5b0d39c79f1d82f3ed442d3462a3ffb" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1ae5b0d39c79f1d82f3ed442d3462a3ffb" kindref="member">aaa__resume_timers</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="640"><highlight class="normal">{</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="timer_8c_1a11aeead6a4eb90a8e22f52472cea63e9" kindref="member">timer__is_timer_paused</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>))</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="timer_8c_1aad9299a11de053906c78450507edafa3" kindref="member">timer__resume</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>);</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="timer_8c_1a11aeead6a4eb90a8e22f52472cea63e9" kindref="member">timer__is_timer_paused</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>))</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="timer_8c_1aad9299a11de053906c78450507edafa3" kindref="member">timer__resume</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>);</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="timer_8c_1a11aeead6a4eb90a8e22f52472cea63e9" kindref="member">timer__is_timer_paused</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>))</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="timer_8c_1aad9299a11de053906c78450507edafa3" kindref="member">timer__resume</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>);</highlight></codeline>
<codeline lineno="648"><highlight class="normal">}</highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"></highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653" refid="aaa_8h_1a50c0f37a2c8c235d2af8e68a71e375c1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a50c0f37a2c8c235d2af8e68a71e375c1" kindref="member">aaa__reuse_senders_first_hdr</ref><sp/>(<ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>incoming_hdr,<sp/><ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="654"><highlight class="normal">{</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ad4de08f39605e2f9e0ae9b842644397d" kindref="member">has_a_pdu_been_received</ref>)</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Use<sp/>this<sp/>incoming<sp/>header<sp/>as<sp/>the<sp/>outgoing<sp/>header...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref><sp/>=<sp/>incoming_hdr;</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ac231415ffbaaf1f8458e7a45f1c2dde0" kindref="member">trans</ref><sp/>=<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>;</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ab91575938015138bfe798e5ff514e793" kindref="member">partner_id</ref><sp/>=<sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ac231415ffbaaf1f8458e7a45f1c2dde0" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" kindref="member">source_id</ref>;</highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>...<sp/>except<sp/>that<sp/>the<sp/>direction<sp/>is<sp/>now<sp/>reversed.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" kindref="member">direction</ref><sp/>==<sp/><ref refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47aeffd4896b50004023fdd717d63615efb" kindref="member">TOWARD_RECEIVER</ref>)</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" kindref="member">direction</ref><sp/>=<sp/><ref refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47ae0538a5a9db25666a6a48c6d450102ae" kindref="member">TOWARD_SENDER</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1aaf64937ea3f2d84b0f306ba01cdfeeda" kindref="member">direction</ref><sp/>=<sp/><ref refid="structures_8h_1a2ba172a06932479051e37d8d33e64b47aeffd4896b50004023fdd717d63615efb" kindref="member">TOWARD_RECEIVER</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="671"><highlight class="normal">}</highlight></codeline>
<codeline lineno="672"><highlight class="normal"></highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="676" refid="aaa_8h_1a8629fef239864abf8bd76005363847a0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a8629fef239864abf8bd76005363847a0" kindref="member">aaa__send_ack</ref><sp/>(<ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>hdr,<sp/><ref refid="struct_a_c_k" kindref="compound">ACK</ref><sp/>ack)</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="struct_c_f_d_p___d_a_t_a" kindref="compound">PDU</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdu;</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>simple<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" kindref="member">CFDP_MSG_PDU_NON_FILEDATA</ref>))</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;&lt;----------<sp/>(%s)<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" kindref="member">cfdp_trans_as_string</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>),</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu__as__string_8c_1a86889bf975693ae3e52b588eb1bf3dc8" kindref="member">ack_struct_as_string</ref><sp/>(ack));</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>an<sp/>ACK<sp/>Pdu.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a12f8c193c32206c76f53dc59084bf485" kindref="member">pdu__make_ack_pdu</ref><sp/>(hdr,<sp/>ack,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="689"><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>more<sp/>detailed<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" kindref="member">CFDP_MSG_DEBUG_PDU</ref>))</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" kindref="member">pdu__display_raw_pdu</ref><sp/>(pdu);</highlight></codeline>
<codeline lineno="693"><highlight class="normal"></highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Send<sp/>the<sp/>PDU<sp/>immediately<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" kindref="member">pdu_output__send</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>,<sp/><ref refid="aaa_8c_1a455c4446917effdd9115c53127c90da2" kindref="member">m__partner_id</ref><sp/>(hdr),<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="701" refid="aaa_8h_1ab637025eab847dfdcefa354fe2a9fa3e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1ab637025eab847dfdcefa354fe2a9fa3e" kindref="member">aaa__send_eof</ref><sp/>(<ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>hdr,<sp/><ref refid="struct_e_o_h_f" kindref="compound">EOHF</ref><sp/>eof)</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="struct_c_f_d_p___d_a_t_a" kindref="compound">PDU</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdu;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>simple<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" kindref="member">CFDP_MSG_PDU_NON_FILEDATA</ref>))</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;&lt;----------<sp/>(%s)<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" kindref="member">cfdp_trans_as_string</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>),</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu__as__string_8c_1a045aa58fd7999c93742bb7546a95acd9" kindref="member">eof_struct_as_string</ref><sp/>(eof));</highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>an<sp/>EOF<sp/>Pdu<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a46321ab547c84889c40a8512490ee967" kindref="member">pdu__make_eof_pdu</ref><sp/>(hdr,<sp/>eof,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="714"><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>more<sp/>detailed<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" kindref="member">CFDP_MSG_DEBUG_PDU</ref>))</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" kindref="member">pdu__display_raw_pdu</ref><sp/>(pdu);</highlight></codeline>
<codeline lineno="718"><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Send<sp/>the<sp/>PDU<sp/>immediately<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" kindref="member">pdu_output__send</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>,<sp/>hdr.<ref refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" kindref="member">dest_id</ref>,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="722"><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="726" refid="aaa_8h_1a277a9d6ed7a91d75545c2802ee7aa8f2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a277a9d6ed7a91d75545c2802ee7aa8f2" kindref="member">aaa__send_finished</ref><sp/>(<ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>hdr,<sp/><ref refid="struct_f_i_n" kindref="compound">FIN</ref><sp/>fin)</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="struct_c_f_d_p___d_a_t_a" kindref="compound">PDU</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdu;</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>simple<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" kindref="member">CFDP_MSG_PDU_NON_FILEDATA</ref>))</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;&lt;----------<sp/>(%s)<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" kindref="member">cfdp_trans_as_string</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>),</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu__as__string_8c_1a37a224b3292db5700d7a9dcb64112856" kindref="member">fin_struct_as_string</ref><sp/>(fin));</highlight></codeline>
<codeline lineno="736"><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Build<sp/>a<sp/>Finished<sp/>pdu<sp/>from<sp/>the<sp/>HDR<sp/>&amp;<sp/>FIN<sp/>structs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a36331f1664e14daaeb444b3c9bbc62b5" kindref="member">pdu__make_fin_pdu</ref><sp/>(hdr,<sp/>fin,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="739"><highlight class="normal"></highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>more<sp/>detailed<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" kindref="member">CFDP_MSG_DEBUG_PDU</ref>))</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" kindref="member">pdu__display_raw_pdu</ref><sp/>(pdu);</highlight></codeline>
<codeline lineno="743"><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Send<sp/>the<sp/>pdu<sp/>(immediately)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" kindref="member">pdu_output__send</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>,<sp/>hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" kindref="member">source_id</ref>,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"></highlight></codeline>
<codeline lineno="749"><highlight class="normal"></highlight></codeline>
<codeline lineno="750"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="751" refid="aaa_8h_1a1a9aedfb9cf196da646983e3f88dafce" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a1a9aedfb9cf196da646983e3f88dafce" kindref="member">aaa__send_metadata</ref><sp/>(<ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>hdr,<sp/><ref refid="struct_m_d" kindref="compound">MD</ref><sp/>md)</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="struct_c_f_d_p___d_a_t_a" kindref="compound">PDU</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdu;</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>simple<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" kindref="member">CFDP_MSG_PDU_NON_FILEDATA</ref>))</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;&lt;----------<sp/>(%s)<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" kindref="member">cfdp_trans_as_string</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>),</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu__as__string_8c_1afc1a9d1018b304ab3eab9ab98a861b26" kindref="member">md_struct_as_string</ref><sp/>(md));</highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Build<sp/>a<sp/>MD<sp/>pdu<sp/>from<sp/>the<sp/>HDR<sp/>&amp;<sp/>MD<sp/>structs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a3e899a1a40daf4ed6289cacd81be7c6e" kindref="member">pdu__make_md_pdu</ref><sp/>(hdr,<sp/>md,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>more<sp/>detailed<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" kindref="member">CFDP_MSG_DEBUG_PDU</ref>))</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" kindref="member">pdu__display_raw_pdu</ref><sp/>(pdu);</highlight></codeline>
<codeline lineno="768"><highlight class="normal"></highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Send<sp/>the<sp/>MD<sp/>pdu<sp/>(immediately)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" kindref="member">pdu_output__send</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>,<sp/>hdr.<ref refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" kindref="member">dest_id</ref>,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="772"><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="775"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="776" refid="aaa_8h_1a06d299dc0262a9be72d40d51b166c3da" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a06d299dc0262a9be72d40d51b166c3da" kindref="member">aaa__send_nak</ref><sp/>(<ref refid="struct_h_d_r" kindref="compound">HDR</ref><sp/>hdr,<sp/><ref refid="struct_n_a_k" kindref="compound">NAK</ref><sp/>nak)</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="struct_c_f_d_p___d_a_t_a" kindref="compound">PDU</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdu;</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"></highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>simple<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1af8ccaf4aa633bc44f5301c50d23d1e5b" kindref="member">CFDP_MSG_PDU_NON_FILEDATA</ref>))</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;&lt;----------<sp/>(%s)<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="utils_8c_1a231ee8c6fad2a17e344fa4482f596b5b" kindref="member">cfdp_trans_as_string</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>),</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu__as__string_8c_1ae3752a3fafe5c4419aee1570bcde9227" kindref="member">nak_struct_as_string</ref><sp/>(nak));</highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Build<sp/>a<sp/>NAK<sp/>pdu<sp/>from<sp/>the<sp/>HDR<sp/>&amp;<sp/>NAK<sp/>structs<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a753ca77448affa467fab2483037411bf" kindref="member">pdu__make_nak_pdu</ref><sp/>(hdr,<sp/>nak,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>more<sp/>detailed<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" kindref="member">CFDP_MSG_DEBUG_PDU</ref>))</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a4b21407db29c17f2b28a55b376823f28" kindref="member">pdu__display_raw_pdu</ref><sp/>(pdu);</highlight></codeline>
<codeline lineno="793"><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Send<sp/>the<sp/>NAK<sp/>pdu<sp/>(immediately)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" kindref="member">pdu_output__send</ref><sp/>(hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>,<sp/>hdr.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>.<ref refid="struct_t_r_a_n_s_a_c_t_i_o_n_1a698ade09384507fb1bebd9b1169582ae" kindref="member">source_id</ref>,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="797"><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="801" refid="aaa_8h_1aa96c1938c9bbe72d4e8826ea7854dbd6" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1aa96c1938c9bbe72d4e8826ea7854dbd6" kindref="member">aaa__send_one_file_data_pdu</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m,<sp/><ref refid="struct_f_d" kindref="compound">FD</ref><sp/>*fd)</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer_length;</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><sp/>checksum_in_register;</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac68e4da4ed53b8b0a08b566311df2259" kindref="member">u_int_1</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>four_byte_buffer<sp/>[4];</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*four_byte_pointer;</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>how_many_bytes_till_boundary;</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>how_many_bytes_of_zero_fill;</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i;</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*i4ptr;</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset_modulo_four;</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="struct_c_f_d_p___d_a_t_a" kindref="compound">PDU</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pdu;</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="structgap" kindref="compound">NODE</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ptr;</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result;</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>how<sp/>much<sp/>file-data<sp/>to<sp/>send:<sp/>send<sp/>as<sp/>much<sp/>of<sp/>the<sp/>first</highlight></codeline>
<codeline lineno="819"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data<sp/>gap<sp/>as<sp/>will<sp/>fit<sp/>in<sp/>one<sp/>PDU<sp/>(the<sp/>whole<sp/>data<sp/>gap,<sp/>if<sp/>possible).</highlight></codeline>
<codeline lineno="820"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>ptr<sp/>=<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" kindref="member">nak</ref>.<ref refid="struct_n_a_k_1abc8812e8a65c2078604e01f676830569" kindref="member">head</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Point<sp/>to<sp/>the<sp/>first<sp/>data<sp/>gap<sp/>on<sp/>the<sp/>list<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr<sp/>==<sp/><ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>)</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Avoid<sp/>crashing<sp/>if<sp/>nak-list<sp/>is<sp/>empty<sp/>(shouldn&apos;t<sp/>ever<sp/>happen)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>bug.<sp/><sp/>See<sp/>&apos;aaa__send_one_file_data_pdu&apos;.\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Avoid<sp/>crashing...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>fd-&gt;<ref refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" kindref="member">offset</ref><sp/>=<sp/>ptr-&gt;<ref refid="structgap_1a12391414ff856122bc95438776497cbd" kindref="member">begin</ref>;</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr-&gt;<ref refid="structgap_1a503365cbf83e5bb8917f912403f39e3a" kindref="member">end</ref><sp/>-<sp/>ptr-&gt;<ref refid="structgap_1a12391414ff856122bc95438776497cbd" kindref="member">begin</ref><sp/>&lt;=<sp/><ref refid="mib_8c_1a0f6eadf536143f9c20169df8a51cde2e" kindref="member">mib__outgoing_file_chunk_size</ref><sp/>(<ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>))</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>all<sp/>fits;<sp/>take<sp/>it<sp/>all<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref><sp/>=<sp/>ptr-&gt;<ref refid="structgap_1a503365cbf83e5bb8917f912403f39e3a" kindref="member">end</ref><sp/>-<sp/>ptr-&gt;<ref refid="structgap_1a12391414ff856122bc95438776497cbd" kindref="member">begin</ref>;</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Won&apos;t<sp/>all<sp/>fit;<sp/>use<sp/>as<sp/>much<sp/>as<sp/>allowed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref><sp/>=<sp/><ref refid="mib_8c_1a0f6eadf536143f9c20169df8a51cde2e" kindref="member">mib__outgoing_file_chunk_size</ref><sp/>(<ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>);</highlight></codeline>
<codeline lineno="836"><highlight class="normal"></highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>this<sp/>is<sp/>a<sp/>retransmission,<sp/>seek<sp/>to<sp/>the<sp/>required<sp/>file<sp/>offset</highlight></codeline>
<codeline lineno="838"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(during<sp/>the<sp/>first<sp/>transmission,<sp/>the<sp/>end<sp/>of<sp/>the<sp/>previous<sp/>file<sp/>data</highlight></codeline>
<codeline lineno="839"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>is<sp/>always<sp/>the<sp/>start<sp/>of<sp/>the<sp/>current<sp/>file<sp/>data).</highlight></codeline>
<codeline lineno="840"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab4b8b566ffe5f9a843ed061f98803471" kindref="member">has_eof_been_sent</ref>)</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1a0e6d3071ceffc2ebe41beff0238bdb90" kindref="member">CFDP_MSG_PDU_RETRANSMITTED_FD</ref>))</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;&lt;aaa&gt;<sp/>Resending<sp/>FD:<sp/>%u<sp/>bytes<sp/>at<sp/>offset<sp/>%lu.\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref>,<sp/>fd-&gt;<ref refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" kindref="member">offset</ref>);</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="callbacks_8c_1af3198af541ba6c8d3535cf18e63de364" kindref="member">fseek_callback</ref><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" kindref="member">fp</ref>,<sp/>fd-&gt;<ref refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" kindref="member">offset</ref>,<sp/>SEEK_SET))</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>&apos;fseek&apos;<sp/>error<sp/>(%s/%u).\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__func__,<sp/>__LINE__);</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="850"><highlight class="normal"></highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>***OPTIMIZATION***<sp/></highlight></codeline>
<codeline lineno="852"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>This<sp/>optimization<sp/>is<sp/>not<sp/>yet<sp/>implemented<sp/>(it<sp/>would<sp/>break<sp/>the</highlight></codeline>
<codeline lineno="853"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>current<sp/>checksum-calculation<sp/>algorithm).<sp/><sp/>Consider<sp/>implementing</highlight></codeline>
<codeline lineno="854"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>it<sp/>in<sp/>the<sp/>future...</highlight></codeline>
<codeline lineno="855"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>Instead<sp/>of<sp/>reading<sp/>the<sp/>file-data<sp/>into<sp/>a<sp/>buffer<sp/>and<sp/>then</highlight></codeline>
<codeline lineno="856"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>building<sp/>a<sp/>PDU<sp/>from<sp/>that<sp/>buffer,<sp/>build<sp/>the<sp/>skeleton<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="857"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>PDU<sp/>and<sp/>then<sp/>read<sp/>the<sp/>file-data<sp/>directly<sp/>into<sp/>the<sp/>PDU.</highlight></codeline>
<codeline lineno="858"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>The<sp/>straightforward<sp/>approach<sp/>uses<sp/>2<sp/>memcpy,<sp/>the<sp/>optimization<sp/>1.</highlight></codeline>
<codeline lineno="859"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>Careful<sp/>-<sp/>the<sp/>checksum-calculation<sp/>algorithm<sp/>requires<sp/>up<sp/>to<sp/>3<sp/></highlight></codeline>
<codeline lineno="860"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>bytes<sp/>that<sp/>follow<sp/>the<sp/>file-data<sp/>to<sp/>be<sp/>zeroed<sp/>out.</highlight></codeline>
<codeline lineno="861"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal"></highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>data<sp/>from<sp/>the<sp/>file<sp/>and<sp/>store<sp/>it<sp/>in<sp/>the<sp/>filedata-buffer.</highlight></codeline>
<codeline lineno="864"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Note:<sp/><sp/>It&apos;s<sp/>important<sp/>to<sp/>zero<sp/>out<sp/>the<sp/>filedata<sp/>buffer<sp/>before<sp/>reading</highlight></codeline>
<codeline lineno="865"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(so<sp/>that<sp/>the<sp/>algorithm<sp/>used<sp/>for<sp/>checksum<sp/>calculation<sp/>can<sp/></highlight></codeline>
<codeline lineno="866"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>remain<sp/>simple<sp/>--<sp/>it<sp/>assumes<sp/>that<sp/>zeros<sp/>follow<sp/>the<sp/>real<sp/>file-data).</highlight></codeline>
<codeline lineno="867"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>memset<sp/>(fd-&gt;<ref refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" kindref="member">buffer</ref>,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(fd-&gt;<ref refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" kindref="member">buffer</ref>));</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="callbacks_8c_1ad75723ad3e4ab1bf351c49403b40f718" kindref="member">fread_callback</ref><sp/>(fd-&gt;<ref refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" kindref="member">buffer</ref>,<sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal">)<sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref>,<sp/></highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" kindref="member">fp</ref>);</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>!=<sp/>1)</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>&apos;fread&apos;<sp/>error<sp/>(%s/%u).\n&quot;</highlight><highlight class="normal">,<sp/><sp/>__func__,<sp/>__LINE__);</highlight></codeline>
<codeline lineno="874"><highlight class="normal"></highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Generate<sp/>a<sp/>FD<sp/>Pdu<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1af01158fc594979d78bd26edcf519ab16" kindref="member">pdu__make_fd_pdu</ref><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>,<sp/>fd,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*-----------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Please<sp/>refer<sp/>to<sp/>the<sp/>detailed<sp/>note<sp/>near<sp/>the<sp/>top<sp/>of<sp/>this<sp/>file<sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>for<sp/>an<sp/>explanation<sp/>of<sp/>the<sp/>file<sp/>checksum<sp/>and<sp/>the<sp/>algorithm<sp/>used.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*-----------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab4b8b566ffe5f9a843ed061f98803471" kindref="member">has_eof_been_sent</ref>)</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>are<sp/>still<sp/>blasting<sp/>the<sp/>file<sp/>(initial<sp/>transmission)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*----------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Before<sp/>entering<sp/>the<sp/>normal<sp/>&quot;4<sp/>bytes<sp/>at<sp/>a<sp/>time&quot;<sp/>checksum<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>calculation<sp/>loop,<sp/>get<sp/>back<sp/>onto<sp/>a<sp/>4-byte<sp/>boundary.<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>(see<sp/>example<sp/>2<sp/>in<sp/>the<sp/>detailed<sp/>note<sp/>near<sp/>the<sp/>top<sp/>of<sp/>this<sp/>file)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*----------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="892"><highlight class="normal"></highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>how<sp/>many<sp/>bytes<sp/>of<sp/>file-data<sp/>need<sp/>to<sp/>be<sp/>processed<sp/>to</highlight></codeline>
<codeline lineno="894"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>reach<sp/>a<sp/>4-byte<sp/>boundary.<sp/><sp/></highlight></codeline>
<codeline lineno="895"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Example:<sp/><sp/>If<sp/>our<sp/>current<sp/>file-data<sp/>starts<sp/>at<sp/>offset<sp/>5,<sp/>then<sp/>the</highlight></codeline>
<codeline lineno="896"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>offset_modulo_four<sp/>is<sp/>1,<sp/>and<sp/>3<sp/>more<sp/>bytes<sp/>are<sp/>needed<sp/>to<sp/>reach</highlight></codeline>
<codeline lineno="897"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>next<sp/>4-byte<sp/>boundary<sp/>(at<sp/>offset<sp/>=<sp/>8).</highlight></codeline>
<codeline lineno="898"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset_modulo_four<sp/>=<sp/>fd-&gt;<ref refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" kindref="member">offset</ref><sp/>&amp;<sp/>0x03;</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(offset_modulo_four<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>how_many_bytes_till_boundary<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>how_many_bytes_till_boundary<sp/>=<sp/>4<sp/>-<sp/>offset_modulo_four;</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Perform<sp/>the<sp/>(custom)<sp/>processing<sp/>required<sp/>(if<sp/>any)<sp/>to<sp/>get<sp/></highlight></codeline>
<codeline lineno="906"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>back<sp/>to<sp/>a<sp/>4-byte<sp/>boundary.</highlight></codeline>
<codeline lineno="907"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(how_many_bytes_till_boundary<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>up<sp/>a<sp/>4<sp/>byte<sp/>buffer<sp/>with<sp/>zero-fill<sp/>on<sp/>the<sp/>left...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>four_byte_buffer[0]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>four_byte_buffer[1]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>four_byte_buffer[2]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>four_byte_buffer[3]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>...<sp/>and<sp/>the<sp/>appropriate<sp/>number<sp/>of<sp/>file-data<sp/>bytes<sp/>copied<sp/>in<sp/>a</highlight></codeline>
<codeline lineno="916"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>&quot;right-justified&quot;<sp/>position.</highlight></codeline>
<codeline lineno="917"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>how_many_bytes_of_zero_fill<sp/>=<sp/>4<sp/>-<sp/>how_many_bytes_till_boundary;</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy<sp/>(&amp;four_byte_buffer[how_many_bytes_of_zero_fill],</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fd-&gt;<ref refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>how_many_bytes_till_boundary);</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Add<sp/>the<sp/>4-byte<sp/>buffer<sp/>to<sp/>the<sp/>current<sp/>checksum<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>four_byte_pointer<sp/>=<sp/>(<ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/>*)<sp/>four_byte_buffer;</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" kindref="member">file_checksum_as_calculated</ref><sp/>+=<sp/>ntohl<sp/>(*four_byte_pointer);</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="926"><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Adjust<sp/>the<sp/>file-data<sp/>buffer<sp/>length<sp/>and<sp/>data-pointer<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buffer_length<sp/>=<sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref><sp/>-<sp/>how_many_bytes_till_boundary;</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i4ptr<sp/>=<sp/>(<ref refid="cfdp__config_8h_1ac01419e4e65c010827418e9d8556595d" kindref="member">u_int_4</ref><sp/>*)<sp/>&amp;fd-&gt;<ref refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" kindref="member">buffer</ref>[how_many_bytes_till_boundary];</highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>is<sp/>the<sp/>normal<sp/>&quot;4<sp/>bytes<sp/>at<sp/>a<sp/>time&quot;<sp/>checksum<sp/>algorithm.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Add<sp/>one<sp/>4-byte<sp/>wide<sp/>piece<sp/>at<sp/>a<sp/>time<sp/>to<sp/>the<sp/>running<sp/>checksum.</highlight></codeline>
<codeline lineno="936"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Note:<sp/><sp/>This<sp/>algorithm<sp/>assumes<sp/>that<sp/>there<sp/>are<sp/>at<sp/>least<sp/>3<sp/>bytes</highlight></codeline>
<codeline lineno="937"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>of<sp/>zeros<sp/>immediately<sp/>beyond<sp/>the<sp/>file-data.<sp/><sp/>That&apos;s<sp/>why<sp/>the</highlight></codeline>
<codeline lineno="938"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>file-data<sp/>buffer<sp/>is<sp/>3<sp/>bytes<sp/>longer<sp/>than<sp/>&quot;necessary&quot;,<sp/>and<sp/>why</highlight></codeline>
<codeline lineno="939"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>file-data<sp/>buffer<sp/>is<sp/>zeroed<sp/>out<sp/>before<sp/>each<sp/>read.</highlight></codeline>
<codeline lineno="940"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>***OPTIMIZATION***</highlight></codeline>
<codeline lineno="941"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>use<sp/>a<sp/>temporary<sp/>register<sp/>variable<sp/>inside<sp/>the<sp/>&apos;for&apos;<sp/>loop.</highlight></codeline>
<codeline lineno="942"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum_in_register<sp/>=<sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" kindref="member">file_checksum_as_calculated</ref>;</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>(i=0;<sp/>i&lt;buffer_length;<sp/>i+=4)</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Use<sp/>&apos;ntohl&apos;<sp/>to<sp/>avoid<sp/>big-endian<sp/>versus<sp/>little-endian<sp/>issues<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum_in_register<sp/>+=<sp/>ntohl<sp/>(*i4ptr);</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Advance<sp/>4<sp/>more<sp/>bytes<sp/>into<sp/>the<sp/>buffer<sp/>of<sp/>file<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i4ptr<sp/>++;</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a27bdc7519ab934ce19f27c7ae2897920" kindref="member">file_checksum_as_calculated</ref><sp/>=<sp/>checksum_in_register;</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="953"><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>output<sp/>a<sp/>detailed<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="utils_8c_1aee92f9b6fa5ec147dc249b15c5b0545b" kindref="member">cfdp_is_message_class_enabled</ref><sp/>(<ref refid="cfdp__provides_8h_1a60e121556c9ff754e9bffa0982e2f18b" kindref="member">CFDP_MSG_DEBUG_PDU</ref>))</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pdu_8c_1a33182448740ab47dbc2381f3a0401c71" kindref="member">pdu__display_disassembled_pdu</ref><sp/>(pdu);</highlight></codeline>
<codeline lineno="957"><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Send<sp/>the<sp/>Pdu<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1aa13d0aa4cf496a925c8c8ef589ee2f9d" kindref="member">pdu_output__send</ref><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1a98d605a5d88ec09baaf263b5ebd929d7" kindref="member">trans</ref>,<sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1abfab47e12f6dde6e337a40e626e69344" kindref="member">hdr</ref>.<ref refid="struct_h_d_r_1a6605b4c53823b0ecad9803c18cacb7a9" kindref="member">dest_id</ref>,<sp/>&amp;pdu);</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1ae544ea51be439f877608252b12d414bd" kindref="member">fd_length</ref><sp/>=<sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref>;</highlight></codeline>
<codeline lineno="961"><highlight class="normal"></highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>configured<sp/>to<sp/>do<sp/>so,<sp/>issue<sp/>an<sp/>Indication<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="mib_8c_1a04366de404f94e362659e23c91e92fee" kindref="member">mib__issue_file_segment_sent</ref><sp/>())</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" kindref="member">indication__</ref><sp/>(<ref refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9ae4d883d759446b86731342c5c65e6eb4" kindref="member">IND_FILE_SEGMENT_SENT</ref>,<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>));</highlight></codeline>
<codeline lineno="965"><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>During<sp/>the<sp/>initial<sp/>send<sp/>of<sp/>the<sp/>file,<sp/>the<sp/>next<sp/>chunk<sp/>of<sp/>file<sp/>data</highlight></codeline>
<codeline lineno="967"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>be<sp/>sent<sp/>will<sp/>always<sp/>immediately<sp/>follow<sp/>the<sp/>current<sp/>chunk</highlight></codeline>
<codeline lineno="968"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab4b8b566ffe5f9a843ed061f98803471" kindref="member">has_eof_been_sent</ref>)</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a76a8dcbf0559fb2166836b19dcab2471" kindref="member">fd_offset</ref><sp/>=<sp/>fd-&gt;<ref refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" kindref="member">offset</ref><sp/>+<sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref>;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="972"><highlight class="normal"></highlight></codeline>
<codeline lineno="973"><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="976" refid="aaa_8h_1a77aeff2d16620a5f809f7a104646e56e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a77aeff2d16620a5f809f7a104646e56e" kindref="member">aaa__shutdown</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="structgap" kindref="compound">GAP</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*current;</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="structgap" kindref="compound">GAP</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*next;</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="struct_t_r_a_n_s___s_t_a_t_u_s" kindref="compound">TRANS_STATUS</ref><sp/><sp/><sp/><sp/><sp/>*mp<sp/>=<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>useful<sp/>shorthand<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>a<sp/>file<sp/>is<sp/>open,<sp/>close<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2a65fc5fc2a7f047af17d8b01cd28077" kindref="member">is_there_an_open_file</ref>)</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8c_1ab45195e00f9ef4f4eca30a8a254f3e8b" kindref="member">fclose_callback</ref><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0892fd0c53969ae7acdf590bc2e4a2be" kindref="member">fp</ref>);</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2a65fc5fc2a7f047af17d8b01cd28077" kindref="member">is_there_an_open_file</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="989"><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>a<sp/>temp<sp/>file<sp/>exists<sp/>at<sp/>this<sp/>point,<sp/>then<sp/>we<sp/>are<sp/>a<sp/>Receiver<sp/>in<sp/>a<sp/></highlight></codeline>
<codeline lineno="991"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>transaction<sp/>that<sp/>wasn&apos;t<sp/>entirely<sp/>successful.<sp/><sp/>Delete<sp/>the<sp/>temp-file<sp/>unless</highlight></codeline>
<codeline lineno="992"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>engine<sp/>user<sp/>has<sp/>told<sp/>us<sp/>not<sp/>to<sp/>(i.e.<sp/>they<sp/>may<sp/>want<sp/>to<sp/>look<sp/>at<sp/>what</highlight></codeline>
<codeline lineno="993"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>they<sp/>got<sp/>even<sp/>if<sp/>it<sp/>is<sp/>is<sp/>not<sp/>complete).</highlight></codeline>
<codeline lineno="994"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a0a7025547a73c28e38adc39f04ad45f4" kindref="member">is_there_a_temp_file</ref>)</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="mib_8c_1a521b4dec7fe3800b157e36c83bd079a6" kindref="member">mib__save_incomplete_files</ref><sp/>(<ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>))</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Engine<sp/>user<sp/>wants<sp/>us<sp/>to<sp/>save<sp/>incomplete<sp/>files,<sp/>so<sp/>don&apos;t<sp/>delete<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1ad74681df8dc1b4216d9aad2543a95748" kindref="member">d_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>saving<sp/>incomplete<sp/>temp-file<sp/>(%s).\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>);</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ok<sp/>to<sp/>delete<sp/>the<sp/>temp-file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8c_1a4c755c18a161b44744b94003aa25a2c0" kindref="member">remove_callback</ref><sp/>(mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a2993ede69caa9696aa5777840c19e5e5" kindref="member">temp_file_name</ref>);</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"></highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>mp-&gt;<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a436e8d0cdf3b6f4a6fee533a6aef6bf8" kindref="member">state</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a275a67132f10277ada3a0ee3d616b647adbd1812bee789fbf3548cf79d3f2b400" kindref="member">FINISHED</ref>;</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" kindref="member">is_outgoing_md_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" kindref="member">is_outgoing_eof_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" kindref="member">is_outgoing_ack_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" kindref="member">is_outgoing_nak_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" kindref="member">is_outgoing_fin_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Free<sp/>all<sp/>memory<sp/>in<sp/>the<sp/>Nak-list<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(current=m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" kindref="member">nak</ref>.<ref refid="struct_n_a_k_1abc8812e8a65c2078604e01f676830569" kindref="member">head</ref>;<sp/>current!=<ref refid="common__types_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">NULL</ref>;<sp/>current=next)</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next<sp/>=<sp/>current-&gt;<ref refid="structgap_1ad2570b6ec1c81c481d237cce1e195cfa" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nak__mem_8c_1aa082478453d5bb8b451ce6600d742797" kindref="member">nak_mem__free</ref><sp/>(&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a1f554312ebb28922a00c92a194cdfbcc" kindref="member">nak</ref>),<sp/>current);</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Stop<sp/>all<sp/>timers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>);</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>);</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>);</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Finally,<sp/>set<sp/>a<sp/>flag<sp/>indicating<sp/>that<sp/>this<sp/>machine<sp/>has<sp/>finished.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a9f3d17df8d0b8d8c8051b9ad5f808a08" kindref="member">has_this_state_machine_finished</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"></highlight></codeline>
<codeline lineno="1029"><highlight class="normal"></highlight></codeline>
<codeline lineno="1030"><highlight class="normal"></highlight></codeline>
<codeline lineno="1031"><highlight class="normal"></highlight><highlight class="comment">/*=r=************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1032" refid="aaa_8h_1a37d91b59bf3e7a27a1c7e38001f3b450" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a37d91b59bf3e7a27a1c7e38001f3b450" kindref="member">aaa__store_file_data</ref><sp/>(FILE<sp/>*fp,<sp/><ref refid="struct_f_d" kindref="compound">FD</ref><sp/>*fd)</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result;</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1036"><highlight class="normal"></highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Seek<sp/>to<sp/>the<sp/>specified<sp/>file<sp/>offset,<sp/>and<sp/>write<sp/>the<sp/>given<sp/>data<sp/>there<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="callbacks_8c_1af3198af541ba6c8d3535cf18e63de364" kindref="member">fseek_callback</ref><sp/>(fp,<sp/>fd-&gt;<ref refid="struct_f_d_1aa7a398c7effa71d334cd242533f19e51" kindref="member">offset</ref>,<sp/>SEEK_SET))</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>&apos;fseek&apos;<sp/>error<sp/>(%s/%u).\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__func__,<sp/>__LINE__);</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="callbacks_8c_1aacc88186b826a5b561c2d2b9b09c13de" kindref="member">fwrite_callback</ref><sp/>(fd-&gt;<ref refid="struct_f_d_1a3df38bc90ee8c4d6390784d6afa508c5" kindref="member">buffer</ref>,<sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal">)<sp/>fd-&gt;<ref refid="struct_f_d_1a9389d66689b2b1ba0f38e3c023b5eb42" kindref="member">buffer_length</ref>,<sp/></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,<sp/>fp);</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>!=<sp/>1)</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="callbacks_8h_1a4ea80b031f7b1097eff43e0bf6756da2" kindref="member">e_msg__</ref><sp/>(</highlight><highlight class="stringliteral">&quot;cfdp_engine:<sp/>&apos;fwrite&apos;<sp/>error<sp/>(%s/%u).\n&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__func__,<sp/>__LINE__);</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"></highlight></codeline>
<codeline lineno="1051"><highlight class="normal"></highlight></codeline>
<codeline lineno="1052"><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"></highlight><highlight class="comment">/*=r=*************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1054" refid="aaa_8h_1aa74321ddb9e7b8bfe4bb6cdd48e21ea8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1aa74321ddb9e7b8bfe4bb6cdd48e21ea8" kindref="member">aaa__suspend_timers</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="1055"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="timer_8c_1a67b8228457a7af348400e7a0ac3b01a6" kindref="member">timer__is_timer_running</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>))</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timer_8c_1a6d624aee3dfc033bd6a878ce4cad48c6" kindref="member">timer__pause</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>);</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="timer_8c_1a67b8228457a7af348400e7a0ac3b01a6" kindref="member">timer__is_timer_running</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>))</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timer_8c_1a6d624aee3dfc033bd6a878ce4cad48c6" kindref="member">timer__pause</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>);</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="timer_8c_1a67b8228457a7af348400e7a0ac3b01a6" kindref="member">timer__is_timer_running</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>))</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="timer_8c_1a6d624aee3dfc033bd6a878ce4cad48c6" kindref="member">timer__pause</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>);</highlight></codeline>
<codeline lineno="1063"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal"></highlight></codeline>
<codeline lineno="1066"><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight><highlight class="comment">/*=r=*************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1068" refid="aaa_8h_1a87d82085dfccdcd452b27101d36975dc" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="aaa_8c_1a87d82085dfccdcd452b27101d36975dc" kindref="member">aaa__transaction_has_finished</ref><sp/>(<ref refid="struct_m_a_c_h_i_n_e" kindref="compound">MACHINE</ref><sp/>*m)</highlight></codeline>
<codeline lineno="1069"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cancel<sp/>all<sp/>timers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a2becfb37bd030c6c5831f73f17f59096" kindref="member">ack_timer</ref>);</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a71d4fea80d390eeb5aa124caca9f006b" kindref="member">nak_timer</ref>);</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><ref refid="timer_8c_1a7ab9af43b5fee44113347b1d2cee4f1b" kindref="member">timer__cancel</ref><sp/>(&amp;m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa90e121947901483be899bd6a160d577" kindref="member">inactivity_timer</ref>);</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"></highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Clear<sp/>outgoing<sp/>queues<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1aa343af0073ac10714f1a1dcf7c3fcca6" kindref="member">is_outgoing_ack_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ab84ebd1e34a22baea85bb6dcab099cda" kindref="member">is_outgoing_eof_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1ad62dd4df8bf3fd1f5aafdf5048ac3b4c" kindref="member">is_outgoing_fin_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a5d5f9c0653f11afdb99d7c34b6601b78" kindref="member">is_outgoing_md_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a315e01ff6a08b2cf084fdb6dc9e5f580" kindref="member">is_outgoing_nak_buffered</ref><sp/>=<sp/><ref refid="aaa_8c_1a996bde01ecac342918f0a2c4e7ce7bd5" kindref="member">NO</ref>;</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"></highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>bookkeeping<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa865d6ea19908b99b10645ad1f7fc94c" kindref="member">finished</ref><sp/>=<sp/><ref refid="aaa_8c_1a7ebc9a785e5ab85457c98595aac81589" kindref="member">YES</ref>;</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a8cc91d6686b3e7ee150d6ed731a7927d" kindref="member">role</ref><sp/>==<sp/><ref refid="cfdp__private_8h_1a88b795c26c0900ddc7c68576a872ef87" kindref="member">R_1</ref>)<sp/>&amp;&amp;<sp/>(!m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1a5ba0e784f4d11bc73b2fca7ee56dce2e" kindref="member">has_md_been_received</ref>))</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>Class<sp/>1<sp/>Receiver<sp/>finished,<sp/>but<sp/>never<sp/>received<sp/>a<sp/>Metadata<sp/>PDU.</highlight></codeline>
<codeline lineno="1088"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Therefore,<sp/>it<sp/>wasn&apos;t<sp/>successful.</highlight></codeline>
<codeline lineno="1089"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" kindref="member">final_status</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103ae7846fdfb14ed85b27d0e9c373b241c2" kindref="member">FINAL_STATUS_NO_METADATA</ref>;</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1aa67e3098cacdbb149e3cd2e51896b429" kindref="member">cancelled</ref>)</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" kindref="member">final_status</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a6ca9c4514cda26375183b30094bb1f65" kindref="member">FINAL_STATUS_CANCELLED</ref>;</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/>m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>.<ref refid="struct_t_r_a_n_s___s_t_a_t_u_s_1af6e72c239f9de7827bd48b634578b5f6" kindref="member">final_status</ref><sp/>=<sp/><ref refid="cfdp__data__structures_8h_1a0d800d24768c7fa0d1d391336caeb103a1ea6c2675a038aaa71e42f2e0fd52be3" kindref="member">FINAL_STATUS_SUCCESSFUL</ref>;</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"></highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Let<sp/>user<sp/>know<sp/>what<sp/>has<sp/>happened<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><ref refid="cfdp__private_8h_1a35e9bed9d08917f0157ff22381df7920" kindref="member">indication__</ref><sp/>(<ref refid="cfdp__data__structures_8h_1ac218b0f8504afb1be9d5d0fb1db07eb9aa1e03e1c0c25c2882282949bdaab573e" kindref="member">IND_TRANSACTION_FINISHED</ref>,<sp/>&amp;(m-&gt;<ref refid="struct_m_a_c_h_i_n_e_1a6c3d05a5a9281bec7b22605df99c08e8" kindref="member">publik</ref>));</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"></highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Shut<sp/>down<sp/>this<sp/>state<sp/>machine<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><ref refid="aaa_8c_1a77aeff2d16620a5f809f7a104646e56e" kindref="member">aaa__shutdown</ref><sp/>(m);</highlight></codeline>
<codeline lineno="1101"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="apps/cf/fsw/src/PRI/aaa.c"/>
  </compounddef>
</doxygen>
