<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="cfsfmopr" kind="page">
    <compoundname>cfsfmopr</compoundname>
    <title>CFS File Manager Operations</title>
    <detaileddescription>
<para><heading level="1">Initialization </heading>
</para><para><linebreak/>
<bold> Power-On and Processor Resets </bold><linebreak/>
</para><para>Upon a Power-On or Processor reset the FM application initializes all telemetry within its housekeeping telemetry packet. The Command and Command Error counters are set to zero, as well as, all other numerical data within the packet. In addition to initializing telemetry, FM registers for cFE event services, creates its software bus message pipe, and subscribes to FM SB housekeeping requests and commands. <linebreak/>
</para><para><linebreak/>
<bold> Normal Operation </bold><linebreak/>
</para><para>The CFS FM application is a command and telemetry driven application. FM waits in a command loop infinitely until the software receives a scheduled housekeeping request, ground command, or stored command. Command packets (including housekeeping requests) are processed as they are received. The application sends an FM housekeeping telemetry message to the ground upon receipt of a scheduled housekeeping request produced by the SCH application. This request is typically performed every 4-5 seconds. <linebreak/>
</para><para>Various FM ground commands produce telemetry messages as a result of processing the command. These telemetry messages include a directory listing telemetry message, file information telemetry message, and an open file listing telemetry message. See page <ref refid="cfsfmcmds" kindref="compound">CFS File Manager Commands</ref> for a detailed description of the FM directory listing, file information, and open file listing ground commands. See page <ref refid="cfsfmtlm" kindref="compound">CFS File Manager Telemetry</ref> for a detailed description of the contents of the FM directory listing, file information, and open file listing telemetry messages. <linebreak/>
</para><para>Other FM ground commands produce files as a result of processing the command. These files include a decompression file, concatenation file, and a directory listing file. See page <ref refid="cfsfmcmds" kindref="compound">CFS File Manager Commands</ref> for a detailed description of the FM decompress file, concatenate files, and directory listing file ground commands. <linebreak/>
</para><para>The decompression file is produced using the cFE API function <ref refid="cfe__fs_8h_1a79313e51cc55a88c51fea2d5039d8582" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">CFE_FS_Decompress</ref> which uses code ported from the GNU zip sources. The cFE API function <ref refid="cfe__fs_8h_1a79313e51cc55a88c51fea2d5039d8582" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">CFE_FS_Decompress</ref> produces the decompressed output file. The output file is comparable to that of a file that has been unzipped using the system utility gunzip. A compressed file reduces the size of the file by encoding the file. Compressed files may be used to reduce uplink time to the spacecraft. Decompressing the file will restore the file from its encoded state to the original state of the file. <linebreak/>
</para><para>The concatenation file is a direct copy of the contents of the two command specified source files, with the contents of the first source file specified proceeding the contents of the second source file specified. The contents of the second source file are written with no delineation characters such as spaces or returns following the contents of the first source file. <linebreak/>
</para><para>The directory listing file is written as a binary file and contains a cFE file header at the top of the file contiguously followed by a directory listing status data structure containing an echo of the command specified directory name (#OS_MAX_PATH_LEN), directory size in bytes (uint32), total number of file contained in the directory (uint32), and the number of file names written in the directory listing file (uint32). The directory listing is then written contiguously one entry at a time. Each entry in the directory listing includes for each file in the directory, the name of the file(#OS_MAX_PATH_LEN), file size in bytes (uint32), and last modification time of the file (uint32). File systems use specific time epochs for their time tagging of files. Since spacecraft systems rarely use an epoch that matches a particular file system, a function is used to convert the file system time (in seconds) to spacecraft time (in seconds). The conversion is controlled by a cFE configuration parameter which is set equal to the number of seconds between the spacecraft&apos;s epoch and the file system&apos;s epoch. See <ref refid="struct_c_f_e___f_s___header__t" kindref="compound" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">CFE_FS_Header_t</ref> for the cFE file header format. See /FM_DirListFileStat_t for the format of the directory listing status structure. See /FM_DirListFileData_t for the format of a directory listing entry. <linebreak/>
</para><para>Next: <ref refid="cfsfmreq" kindref="compound">CFS File Manager Requirements</ref> <linebreak/>
 Prev: <ref refid="cfsfmovr" kindref="compound">CFS File Manager Overview</ref> </para>    </detaileddescription>
  </compounddef>
</doxygen>
