<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="cfsschopr" kind="page">
    <compoundname>cfsschopr</compoundname>
    <title>CFS Scheduler Operation</title>
    <detaileddescription>
<para>The SCH Application has an operational interface consisting of eight commands, two tables and two different telemetry messages.</para><sect1 id="cfsschopr_1cfsschoprtbls">
<title>SCH Tables</title>
<para>The two tables are the Schedule Definition Table (SDT) and the Message Definition Table (MDT).</para><para>The tables, combined, define the behavior of the SCH Application while it is running. The SDT contains information identifying which messages are to be sent and when and the MDT contains definitions of the messages that are to be sent. Since the SDT references the contents of the MDT, it is imperative that the operator update these tables carefully to prevent unexpected and potentially disruptive behavior from the SCH Application. The simplest method to prevent these problems is to replace the default table images for these tables (the filenames are specified using the SCH platform configuration parameters <ref refid="sch__platform__cfg_8h_1aa0a00e5974aa67bfe91ce39d1f2db1d3" kindref="member">SCH_SCHEDULE_FILENAME</ref> and <ref refid="sch__platform__cfg_8h_1a052acaa8ebd6c01b4fcc35636ea3b265" kindref="member">SCH_MESSAGE_FILENAME</ref>) and to restart the SCH Application.</para><para>The contents and structure of the tables can be found at <ref refid="cfsschtbl" kindref="compound">CFS Scheduler Table Definitions</ref>.</para></sect1>
<sect1 id="cfsschopr_1cfsschoprenadis">
<title>Enable/Disable SCH Activities</title>
<para>The command interface for the SCH Application provides Enable/Disable commands for either Enabling/Disabling individual activities in the SDT or for Enabling/Disabling entire groups of activities. When the activities are defined in the SDT, they can be assigned both a Group Number and/or a Multi-Group Identifier. A group number typically identifies a single set of activities that are very closely related, if not identical. An example of a single group could be the messages used to notify Memory Dwell when to examine and log the contents of the memory addresses. A Multi-Group Identifier can be used to combine individual activities and groups of activities into a larger group. For example, one could assign individual groups to activities associated with each experiment and then combine all the experiment groups into a single Multi-Group. This allows all experiment message traffic to be suspended/restarted with a single command.</para></sect1>
<sect1 id="cfsschopr_1cfsschoprdiag">
<title>SCH Diagnostic Packet</title>
<para>If the operator wishes to know the current configuration of the activities defined by the SDT and the MDT without dumping the tables and analyzing their contents, they have the <ref refid="sch__msgdefs_8h_1a88063e9eba628a369ecfeafb22867287" kindref="member">Send Diagnostic Packet </ref> command at their disposal. This command forces the generation of an SCH Diagnostic Packet that contains the current state (Enabled/Disabled) of each activity in the SDT and also indicates the Message IDs associated with each activity in the table.</para></sect1>
<sect1 id="cfsschopr_1cfsschoprnoop">
<title>Command Interface Verification and SCH Application Version Information</title>
<para>The command interface also includes a <ref refid="sch__msgdefs_8h_1aff13c67ad0852d59ca4ef44879566f57" kindref="member">SCH No-op command </ref>. This command is useful for verifying that the command interface to the SCH Application is working. It also causes an <ref refid="sch__events_8h_1a333ecd3c41dbc9990b080c681cc4466f" kindref="member">Event Message </ref> to be generated that contains the SCH Application&apos;s version information. It should also be noted that the version information can also be obtained when the Application starts up. After SCH has successfully initialized itself, an <ref refid="sch__events_8h_1a2143003d800956b0a42acb189559dc97" kindref="member">Event Message </ref> is generated that indicates successful initialization and also includes the Application&apos;s version information. Both of these event messages are &apos;Informational&apos; and are NOT filtered by default.</para></sect1>
<sect1 id="cfsschopr_1cfsschoprmfsync">
<title>Major Frame Synchronization</title>
<para>The SCH Application requires a stable Major Frame Synchronization signal (typically a 1Hz signal) to maintain a reliable performance of the activities defined in the SDT. If the Major Frame Synchronization signal is determined to be too noisy (i.e. - Occurs outside the expected window, see <ref refid="sch__platform__cfg_8h_1afa493b73d6d26f4171bce55904f7989e" kindref="member">SCH_SYNC_SLOT_DRIFT_WINDOW</ref>, for two consecutive major frames), then the signal is automatically ignored and the SCH Application continues to run off of the Minor Frame Synchronization signal. Once an operator has determined that the Major Frame Synchronization signal is stable, the operator can use the <ref refid="sch__msgdefs_8h_1a988bd1a3fd08823654b2bdf4f695c6b3" kindref="member">Enable Sync Command </ref> to re-enable the SCH Application&apos;s alignment to the Major Frame signal.</para></sect1>
<sect1 id="cfsschopr_1cfsschoprhk">
<title>SCH Housekeeping Telemetry</title>
<para>The SCH Application generates a <ref refid="struct_s_c_h___hk_packet__t" kindref="compound">Housekeeping Telemetry Message </ref> whenever scheduled to do so by the SDT. The message contains command counters (both successful and unsuccessful) that indicate whether outside commands have been received. The operator can use these telemetry points to verify the receipt and processing of commands. The operator can reset these counters using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Command </ref>.</para><para>The SCH Housekeeping telemetry also contains statistics that are useful for monitoring the execution of the SCH Application. These statistics indicate the number of Activities performed, number of times problems have been encountered, number of times the SCH Application has detected synchronization issues, etc. Each telemetry point is discussed in detail below:</para><para><table rows="22" cols="2"><row>
<entry thead="no"><para>Command Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_CmdCounter"/> The <ref refid="struct_s_c_h___hk_packet__t_1af8901da757eaf6f3e35b641f553c4c13" kindref="member">Command Counter </ref> is incremented upon receipt of any valid command message. A command message is considered valid when it meets the following criteria: <linebreak/>
 <itemizedlist>
<listitem>
<para>The Message ID in the Message Header is <ref refid="sch__msgids_8h_1a074c7822b6c9bd33b492dce99e9457dd" kindref="member">SCH_CMD_MID</ref> <linebreak/>
 </para></listitem>
<listitem>
<para>The Length of the Message is the correct length for the command <linebreak/>
 </para></listitem>
<listitem>
<para>Each command has specific criteria for validation relating to the command parameters for that particular command <linebreak/>
 </para></listitem>
</itemizedlist>
</para><para><bold>NOTE:</bold> The <ref refid="struct_s_c_h___hk_packet__t_1af8901da757eaf6f3e35b641f553c4c13" kindref="member">Command Counter </ref> is NOT incremented upon receipt of a <ref refid="sch__msgids_8h_1a6b68abc81890d0891f1562df904fca7d" kindref="member">SCH Housekeeping Request </ref> message.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Command Error Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_ErrCounter"/>The <ref refid="struct_s_c_h___hk_packet__t_1abf0292ba71a3c8c7bb3e13d4de936103" kindref="member">Command Error Counter </ref> is incremented whenever any of the conditions specified above for the <ref refid="struct_s_c_h___hk_packet__t_1af8901da757eaf6f3e35b641f553c4c13" kindref="member">Command Counter </ref> are not met.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Activity Success Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_ScheduleActivitySuccessCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1aab70a9dbdda2f80b31d12fbfd0da2289" kindref="member">Activity Success Counter </ref> is incremented each time an Activity in the Schedule Definition Table is successfully performed.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Activity Failure Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_ScheduleActivityFailureCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1ad60184fa8adc5e7d813e21a5821163ad" kindref="member">Activity Failure Counter </ref> is incremented whenever an error occurs while processing an Activity defined in the Schedule Definition Table. Currently, the only possible Activity type is sending a message. Therefore, the only possible causes of errors are those that are reported by the cFE Software Bus when processing an <ref refid="cfe__sb__api_8c_1a91b4b63f7d168bd78dc92d894ad7f77d" kindref="member" external="/home/vagrant/airliner/build/reference/default/docs/html/cfe/detailed_design/cfe.tag">CFE_SB_SendMsg</ref> API call.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Processed Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_SlotsProcessedCount"/>Slots The <ref refid="struct_s_c_h___hk_packet__t_1a44390eb7a92bbd1a9250db505ee55ee1" kindref="member">Slots Processed Counter </ref> is incremented each time a slot (i.e. Minor Frame) in the Schedule Definition Table is processed.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Skipped Slots Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_SkippedSlotsCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a459d3cd3c53c6a67acdcbf0ba0f1a012" kindref="member">Skipped Slots Counter </ref> is incremented by one whenever one or more slots in the Schedule Definition Table are skipped in an attempt by the Scheduler Application to stay synchronized with the Major Frame signal.</para><para><bold>NOTE:</bold> The counter does not represent the number of slots skipped, but rather, the number of times one or more slots are skipped.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Multiple Slots Executed Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_MultipleSlotsCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a695c7b6a3104ab7a6785d893d4160791" kindref="member">Multiple Slots Executed Counter </ref> is incremented by one whenever two or more slots are executed during a single Minor Frame wake-up. This is an indication that the Scheduler Application has fallen behind a little bit and is attempting to catch up rather than skipping Activities in the Schedule Definition Table.</para><para><bold>NOTE:</bold> This counter does not represent the number of slots executed, but rather, the number of times two or more slots have been executed in one Minor Frame wake-up.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Same Slot Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_SameSlotCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a1561fff6ce46cfd10199ac0fc75bcd8a" kindref="member">Same Slot Counter </ref> is incremented whenever the Scheduler Application is woken up by the Minor Frame signal and it finds itself in the same slot as the previous Minor Frame. This only happens when the Scheduler Application is being run on a platform that does not have an accurate timer for driving the Minor Frame signals. During initialization, the Scheduler Application attempts to allocate a hardware timer to drive the Minor Frame Signal. If the board does not have a timer with sufficient accuracy, the Scheduler Application then also uses the subseconds of the Mission Elapsed Time to help maintain timing as well as it can. This can lead to the same slot being processed more than once in a row. The Scheduler Application will try its best to compensate for this situation.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Bad Table Data Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_BadTableDataCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a5624d597e340833d8b9722a8574b3d82" kindref="member">Bad Table Data Counter </ref> is incremented whenever the Scheduler Application detects a malformed Activity definition in the Schedule Definition Table. This can only happen if the Schedule Definition Table has become corrupted in memory since the same validation checks are performed before the table is accepted on a load.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Table Verify Success Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_TableVerifySuccessCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a126130a80d7a65fb71f6230e97dd135a" kindref="member">Table Verify Success Counter </ref> is incremented whenever the Scheduler Application is requested to verify the contents of a potential table load (for either the Scheduler Definition Table or the Message Definition Table) and the contents are found to meet all the requirements.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Table Verify Failure Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_TableVerifyFailureCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a901e3dc103b43255e939381c0a0c5bf1" kindref="member">Table Verify Failure Counter </ref> is incremented whenever the Scheduler Application is requested to verify the contents of a potential table load (for either the Schedule Definition Table or the Message Definition Table) and at least one error is detected in the specified table image.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Table Pass Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_TablePassCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a2594e01e5967e7990f894f3d55ce5c5b" kindref="member">Table Pass Counter </ref> is incremented whenever the Scheduler Application has either processed the last slot in the Schedule Definition Table or has skipped the end of the table during a Major Frame Synchronization. This counter is used, internally, by the Scheduler Application to determine the Major Frame cycle number that is used by Activities that run at a frequency less than 1 Hz. For example, any Activity that is defined to run every 2 seconds, would only be performed when this counter is an even number. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Valid Major Frame Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_ValidMajorFrameCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a5abac9e231383a6b638fc023e9f6b97a" kindref="member">Valid Major Frame Counter </ref> is incremented whenever the Scheduler Application receives a Major Frame Signal during the window that the Scheduler Application is expecting to receive such a signal.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Missed Major Frame Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_MissedMajorFrameCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a43370c7f9351b5988f71062e91123dca" kindref="member">Missed Major Frame Counter </ref> is incremented whenever the Scheduler Application does not receive a Major Frame Signal during the window that it expects to see the signal.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Unexpected Major Frame Counter </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_UnexpectedMajorFrameCount"/> The <ref refid="struct_s_c_h___hk_packet__t_1a54b85845fcacca5e84abd815d25c17f6" kindref="member">Unexpected Major Frame Counter </ref> is incremented whenever the Scheduler Application receives a Major Frame Signal outside the window when it expects to receive the signal.</para><para><bold>NOTE:</bold> This counter can be reset to zero using the <ref refid="sch__msgdefs_8h_1adebe9b4ed9ccc1528c1198cb1acd4ac8" kindref="member">Reset Counters Command </ref>. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Minor Frames Since Tone </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_MinorFramesSinceTone"/> The <ref refid="struct_s_c_h___hk_packet__t_1a06ae5537a6a8e5977ba9fcb900e6eacd" kindref="member">Minor Frames Since Tone </ref> identifies how many Minor Frame signals have been received since the last Major Frame signal. Typically, this number should remain static in telemetry since the Scheduler Application Housekeeping will always happen during the same Minor Frame. However, if the Scheduler Application becomes out of sync with the Major Frame and ignores the Major Frame, this value could indicate the amount of drift that has occurred. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Next Slot Number </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_NextSlotNumber"/> The <ref refid="struct_s_c_h___hk_packet__t_1aba5afc7b546e7d0015ceed38f75d9443" kindref="member">Next Slot Number </ref> identifies what Slot (i.e. - Minor Frame) is to be executed on the next Minor Frame signal. Typically, this number should remain static in telemetry since the Scheduler Application&apos;s housekeeping is generated by a message coming from the schedule. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Last Sync MET Slot </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_LastSyncMETSlot"/> The <ref refid="struct_s_c_h___hk_packet__t_1ae4154048d2aadc9ac87fb057d580d996" kindref="member">Last Sync MET Slot </ref> indicates which MET slot the most recent Major Frame signal occurred. If the Scheduler Application is synchronized to MET, then this value should always be zero. Otherwise, it can help identify how much of a shift there is from the MET subseconds to the Major Frame signal. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Ignore Major Frame Flag </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_IgnoreMajorFrame"/> The <ref refid="struct_s_c_h___hk_packet__t_1a812b8cebfc9f6e0df40429b830d8a46b" kindref="member">Ignore Major Frame Flag </ref> is set to TRUE whenever the Scheduler Application has determined that the Major Frame signal is noisy and cannot be trusted. To reset this flag, the operator will need to have a stable Major Frame signal and issue the <ref refid="sch__msgdefs_8h_1a988bd1a3fd08823654b2bdf4f695c6b3" kindref="member">Enable Major Frame Synchronization </ref> command. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Unexpected Major Frame Flag </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_UnexpectedMajorFrame"/> The <ref refid="struct_s_c_h___hk_packet__t_1a215410bd2db5050ec6ce13f40d51d789" kindref="member">Unexpected Major Frame Flag </ref> is set to TRUE whenever the Scheduler Application receives a Major Frame signal outside the expected Major Frame signal window. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Sync To MET Flag </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_SyncToMET"/> The <ref refid="struct_s_c_h___hk_packet__t_1ac8936e4ac0482d7f26806bb4cf40b178" kindref="member">Sync To MET Flag </ref> is set to TRUE when the Scheduler Application has determined, during initialization, that the accuracy of the Minor Frame timer is inadequate to maintain an accurate Minor Frame signal. The Scheduler Application will use the MET to determine which slots in the Schedule Definition Table are to be executed whenever it does receive the Minor Frame signal. </para><para></para></entry></row>
<row>
<entry thead="no"><para>Major Frame Source </para></entry><entry thead="no"><para><anchor id="cfsschopr_1SCHHK_MajorFrameSource"/> The <ref refid="struct_s_c_h___hk_packet__t_1a4ced3d9fa1ab9f5266f697ae96d0f120" kindref="member">Major Frame Source </ref> can have one of three possible values. When equal to #SCH_MF_SOURCE_NONE, the Scheduler Application is still initializing. When equal to #SCH_MF_SOURCE_CFE_TIME, then the Major Frame is being obtained from the cFE TIME service. When equal to #SCH_MF_SOURCE_MINOR_FRAME_TIMER, the Major Frame signal from cFE TIME service has not been received and the Major Frame is being deduced by counting the number of consecutive Minor Frame signals. </para></entry></row>
</table>
</para><para>Next: <ref refid="cfsschreq" kindref="compound">CFS Scheduler Requirements</ref> <linebreak/>
 Prev: <ref refid="cfsschovr" kindref="compound">CFS Scheduler Overview</ref> </para></sect1>
    </detaileddescription>
  </compounddef>
</doxygen>
