<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Telemetry Output (TO) Application on  User&#39;s Guide: TO Application Operation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Telemetry Output (TO) Application on  User&#39;s Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TO Application Operation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>1. Table Handling </h2>
<p>The channels each have a single table. Each table is designed to be self-consistent for each channel configuration, which means that all the parts of the table should all work together. TO should always load a default table for each channel when it boots. The default channel configuration tables are configured to support safe/proper initial TO output while interacting with other system configuration operations. If TO fails to load a table, then TO will fall back to an backup table for the channel.</p>
<p>There should be different tables for the separate supported radio bandwidth configurations and different operational configurations. An "invalid" TO table is one that will not pass TO's validation routines on range-checking data values and internal data references inside the table itself. TO will not attempt to determine when a table is misconfigured. TO will only determine if the data in it is invalid.</p>
<h2>Monitoring Command Counters </h2>
<p>Note that each command successfully received, and processed, by TO from the CFE SB will increment the <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c">TO_HkTlm_t.usCmdCnt</a> counter.</p>
<p>Each command successfully received, but not successfully processed, by TO from the CFE SB will increment the <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6">TO_HkTlm_t.usCmdErrCnt</a>, but not the <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c">TO_HkTlm_t.usCmdCnt</a>.</p>
<p>If neither counter increments, then TO did not successfully receive a TO_CMD_MID command from the CFE SB.</p>
<h2>Monitoring Channel Task Housekeeping Data </h2>
<p>There is a set of housekeeping data for each channel task which provides insight into operation of each channel interface. There is a sent message count flag, queued message count flag, dropped message count flag, failed message count flag, the number of bytes sent from each channel's interface, and the channel's interface memory usuage.</p>
<p>The sent message count flag is the indicator that the message was successfully sent out of the channel interface by the TO application. This indicator is key for determining the health of the channel's interface. Incrementing if it is healthy and stagnate if it is not healthy.</p>
<ul>
<li>
Sent message count flag: <a class="el" href="struct_t_o___hk_tlm__t.html#aafaece8fa7c9a8f01408a498ddf7a12b" title="Count of telemetry messages sent out the channel interface. Counter begins at zero with app initializ...">TO_HkTlm_t.uiSentMsgCountChannel</a> </li>
</ul>
<p>The queued message count flag is the indicator of the number messages queued on the channel's priority queues. by the TO application. This indicator is key for determining if a channel's interface showing signs of pending trouble. If the queued counter keeps incrementing and not decrementing, the channel interface is starting to get behind as messages are not being sent out of the interface fast enough.</p>
<ul>
<li>
Queued message count flag: <a class="el" href="struct_t_o___hk_tlm__t.html#a22fa8088483f4cdc32cd93fe89309883" title="Count of telemetry messages queued on the TO channel&#39;s Priority Queues. Counter begins at zero with a...">TO_HkTlm_t.uiQueuedMsgCountChannel</a> </li>
</ul>
<p>The dropped message count flag is the indicator of the number messages dropped and not passed onto the channel's priority queues by the TO application. This indicator showing there might be a problem with the message. The message is be too long or the message is not valid on that particular channel. It could also indicate the channel's queue is full.</p>
<ul>
<li>
Dropped message count flag: <a class="el" href="struct_t_o___hk_tlm__t.html#aef280887ca13c11f286ce3fdff2a7bac" title="Count of telemetry messages rejected, and not passed into the channel&#39;s Priority Queues. Counter begins at zero with app initialization and rolls over. Index of array is equivalent to the relevant TO channel index. ">TO_HkTlm_t.uiDropMsgCountChannel</a> </li>
</ul>
<p>The failed message count flag is the indicator of the number messages failed on channel's interface write after being pulled from the output queue and lost.</p>
<ul>
<li>
Failed message count flag: <a class="el" href="struct_t_o___hk_tlm__t.html#a49357250cf5765c1f962246b0bb0632c" title="Count of telemetry messages failed on interface write after being pulled from the output queue...">TO_HkTlm_t.uiFailedMsgCountChannel</a> </li>
</ul>
<p>The number of bytes counter increments as data is being sent from each channel's interface.</p>
<ul>
<li>
channel interface sent byte counter: <a class="el" href="struct_t_o___hk_tlm__t.html#aa369c2829ef16c79be16ec38b9f9997f" title="The number of bytes sent out the channel&#39;s interface Counter begins at zero with app initialization a...">TO_HkTlm_t.uiBytesSentChannel</a> </li>
</ul>
<p>The channel memory is the indicator of how much memory a channel task is using to do it's job. This indicator is good for determining the health state of a channel. Steadily increasing memory is an indicator of a possible issue, particularly as it nears memory exhaustion. This indicator can flucuate up and down or remain steady. This indicates the channel state is nominal.</p>
<ul>
<li>
channel interface memory usuage information: <a class="el" href="struct_t_o___hk_tlm__t.html#ab03e0ece9af140690542b0aca532d7ca" title="Memory information per channel. ">TO_HkTlm_t.ChannelMemInfo</a> </li>
</ul>
<h2>Monitoring Command Counters </h2>
<p>Note that each command successfully received, and processed, by TO from the CFE SB will increment the <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c">TO_HkTlm_t.usCmdCnt</a> counter.</p>
<p>Each command successfully received, but not successfully processed, by TO from the CFE SB will increment the <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6">TO_HkTlm_t.usCmdErrCnt</a>, but not the <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c">TO_HkTlm_t.usCmdCnt</a>.</p>
<p>If neither counter increments, then TO did not successfully receive a TO_CMD_MID command from the CFE SB.</p>
<h1>Commands </h1>
<h2>No-op </h2>
<p>This command performs no other function than to increment the command execution counter. The command may be used to verify general aliveness of the Telemetry Output task.</p>
<p>Successful execution of this command may be verified with the following telemetry:</p>
<ul>
<li>Command counter <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> will increment</li>
<li>The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a201685e24a8678a43257c6d9a5cd733d">TO_CMD_NOOP_INF_EID</a> informational event message will be generated</li>
</ul>
<p>Failure to execute this command will result in no change of the command counter.</p>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>Command packet length not as expected</li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#aebe128165e10c0247518108d5e4e6607">TO_NOOP_CC</a></p>
<h2>Reset Counters </h2>
<p>This command resets the TO housekeeping and channel telemetry counters.</p>
<p>The following housekeeping telemetry items will be reset to zero:</p>
<ul>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> </li>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6" title="Count of failed commands. ">TO_HkTlm_t.usCmdErrCnt</a> </li>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#a643113768d36f31ebc22b6f121663650" title="Count of all messages dropped. ">TO_HkTlm_t.usTotalMsgDropped</a> </li>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#a8f1afdfeb80d219e1f4f943d315fdab8" title="Count of all bytes sent on all output channels. ">TO_HkTlm_t.SentBytes</a> </li>
</ul>
<p>The following telemetry items for each channel will be set to zero:</p>
<ul>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#ab03e0ece9af140690542b0aca532d7ca" title="Memory information per channel. ">TO_HkTlm_t.ChannelMemInfo</a> </li>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#aafaece8fa7c9a8f01408a498ddf7a12b" title="Count of telemetry messages sent out the channel interface. Counter begins at zero with app initializ...">TO_HkTlm_t.uiSentMsgCountChannel</a> </li>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#a22fa8088483f4cdc32cd93fe89309883" title="Count of telemetry messages queued on the TO channel&#39;s Priority Queues. Counter begins at zero with a...">TO_HkTlm_t.uiQueuedMsgCountChannel</a> </li>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#aef280887ca13c11f286ce3fdff2a7bac" title="Count of telemetry messages rejected, and not passed into the channel&#39;s Priority Queues. Counter begins at zero with app initialization and rolls over. Index of array is equivalent to the relevant TO channel index. ">TO_HkTlm_t.uiDropMsgCountChannel</a> </li>
<li>
<a class="el" href="struct_t_o___hk_tlm__t.html#a49357250cf5765c1f962246b0bb0632c" title="Count of telemetry messages failed on interface write after being pulled from the output queue...">TO_HkTlm_t.uiFailedMsgCountChannel</a> </li>
<li>
<a class="el" href="struct_t_o___channel_diag_tlm__t.html#a224abed005ba84481770cdf34cd7fe5b" title="Memory full count. ">TO_ChannelDiagTlm_t.MemFullCount</a> </li>
<li>
<a class="el" href="struct_t_o___message_flow_diag_tlm__t.html#a92fa7763613f7f0e82255465016e9bad" title="Message Flow Dropped Message Count. ">TO_MessageFlowDiagTlm_t.DroppedMsgCnt</a> </li>
<li>
<a class="el" href="struct_t_o___message_flow_diag_tlm__t.html#aac1a5865060b90a20eff81d1b002ace0" title="Message Flow Queued Message Count. ">TO_MessageFlowDiagTlm_t.QueuedMsgCnt</a> </li>
<li>
<a class="el" href="struct_t_o___priority_diag_tlm__t.html#a6d855915affa1d6c118ec72a47030f91" title="Priority Queue dropped message Count. ">TO_PriorityDiagTlm_t.DroppedMsgCnt</a> </li>
<li>
<a class="el" href="struct_t_o___priority_diag_tlm__t.html#aff211fbb4e1661ce53b3711371253941" title="Priority Queue queued message Count. ">TO_PriorityDiagTlm_t.QueuedMsgCnt</a> </li>
<li>
<a class="el" href="struct_t_o___priority_diag_tlm__t.html#adcf5355fb715a9dca3977b9ff1e22956" title="Priority Queue highest recorded queued count. ">TO_PriorityDiagTlm_t.HighwaterMark</a> </li>
<li>
<a class="el" href="struct_t_o___priority_diag_tlm__t.html#a5eadcee79b433d5c24040289cf1773d7" title="Priority Queue currently queued count. ">TO_PriorityDiagTlm_t.CurrentlyQueuedCnt</a> </li>
<li>
<a class="el" href="struct_t_o___output_queue_diag_tlm__t.html#a0daf92141649508b8ad782288affd16f" title="Count of the number of messages sent from the output queue. ">TO_OutputQueueDiagTlm_t.SentCount</a> </li>
<li>
<a class="el" href="struct_t_o___output_queue_diag_tlm__t.html#a2b46bde0b0871ec68b4df5903b21248a" title="Highest recorded number of messages queued on output queue. ">TO_OutputQueueDiagTlm_t.HighwaterMark</a> </li>
<li>
<a class="el" href="struct_t_o___output_queue_diag_tlm__t.html#ac5ddeee45cae137299a395591c9e88f7" title="Count of the number of bytes sent from the output queue. ">TO_OutputQueueDiagTlm_t.SentBytes</a> </li>
<li>
<a class="el" href="struct_t_o___output_queue_diag_tlm__t.html#a7afc46a110fa367bc6682d7f78407a75" title="Count of the number of messages currently queued on output queue. ">TO_OutputQueueDiagTlm_t.CurrentlyQueuedCnt</a> </li>
</ul>
<p>Successful execution of this command may be verified with the following telemetry: </p><ul>
<li>
<a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a0303e80543a0bbf463e1510cd7ecee8b">TO_CMD_RESET_INF_EID</a> info event message will be generated when the command is executed </li>
</ul>
<p>Failure to execute this command will result in no change of any of the specified counters above.</p>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>
Command packet length not as expected </li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#ad43912271800c5f649c8e1b48f4f9a7b">TO_RESET_CC</a></p>
<h2>Add Message Flow </h2>
<p>This command adds a message flow to the configuration table, which will add that message to the downlink for the channel specified.</p>
<p>Successful execution of this command may be verified with the following telemetry:</p>
<ul>
<li>
Command counter <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> will increment </li>
<li>
The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a6d1255245142cd60ae70d6c8127fae4e">TO_CMD_ADD_MSG_FLOW_EID</a> informational event message will be generated </li>
</ul>
<p>Failure to execute this command will result in:</p>
<ul>
<li>
Command error counter <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6" title="Count of failed commands. ">TO_HkTlm_t.usCmdErrCnt</a> will increment </li>
</ul>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>
Message flow already defined. The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a4d7dc687f69d84d7d525703a8876c0be">TO_CMD_ADD_MSG_FLOW_ERR_EID</a> error event will be sent in this case. </li>
<li>
Command packet length not as expected </li>
<li>
Invalid channel specified </li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#a8f59d14562f119776c16d579894ef368">TO_ADD_MESSAGE_FLOW_CC</a></p>
<h2>Remove Message Flow </h2>
<p>This command removes a message flow to the configuration table, which will remove that message from the downlink for the channel specified.</p>
<p>Successful execution of this command may be verified with the following telemetry:</p>
<ul>
<li>
Command counter <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> will increment </li>
<li>
The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a52dfca50ec5d188691b057d0a4a48156">TO_CMD_REMOVE_MSG_FLOW_EID</a> informational event message will be generated </li>
</ul>
<p>Failure to execute this command will result in:</p>
<ul>
<li>
Command error counter <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6" title="Count of failed commands. ">TO_HkTlm_t.usCmdErrCnt</a> will increment </li>
</ul>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>
Message flow not defined. The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568acd2c4495c1727093c64a0857cd05e9a5">TO_CMD_REMOVE_MSG_FLOW_ERR_EID</a> error event will be sent in this case. </li>
<li>
Command packet length not as expected </li>
<li>
Invalid channel specified </li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#a85dde8ca77ee9cd17fd687bd221d10c8">TO_REMOVE_MESSAGE_FLOW_CC</a></p>
<h2>Query Message Flow </h2>
<p>This command queries a specified message flow configuration for a specified channel. Querying will not change any downlink behavior. A <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a5a6f832de06f0614259617443d1485d0">TO_MSG_FLOW_INFO_EID</a> informational event will be generated containing all the message flow configuration option details, which includes:</p>
<ul>
<li>
Message ID </li>
<li>
Message limit </li>
<li>
Priority queue ID </li>
<li>
Dropped message count </li>
<li>
Queued message count </li>
<li>
Software Bus message count </li>
<li>
Failed message count </li>
<li>
Sent message count </li>
</ul>
<p>Successful execution of this command may be verified with the following telemetry:</p>
<ul>
<li>
Command counter <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> will increment </li>
<li>
The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a5a6f832de06f0614259617443d1485d0">TO_MSG_FLOW_INFO_EID</a> informational event message will be generated </li>
</ul>
<p>Failure to execute this command will result in:</p>
<ul>
<li>
Command error counter <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6" title="Count of failed commands. ">TO_HkTlm_t.usCmdErrCnt</a> will increment </li>
</ul>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>
Message flow not defined. The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a7d4a881e119af22f90fc0272d3968331">TO_MSG_FLOW_INFO_ERR_EID</a> error event will be sent in this case. </li>
<li>
Invalid channel specified </li>
<li>
Command packet length not as expected </li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#aa10ba1203e015a0409ede1951ad11d33">TO_QUERY_MESSAGE_FLOW_CC</a></p>
<h2>Query Priority Queue </h2>
<p>This command queries a specified priority queue for a specified channel. Querying will not change any downlink behavior. A <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a75e0435c01d5edc1b9c8bdc6a61d90ec">TO_PQUEUE_INFO_EID</a> informational event will be generated containing all the priority queue diagnostic details including:</p>
<ul>
<li>
State </li>
<li>
Message Limit </li>
<li>
Queue Type </li>
<li>
Dropped message count </li>
<li>
Queued message count </li>
<li>
Currently queued count </li>
<li>
Highwater mark </li>
</ul>
<p>Successful execution of this command may be verified with the following telemetry:</p>
<ul>
<li>
Command counter <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> will increment </li>
<li>
The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a5a6f832de06f0614259617443d1485d0">TO_MSG_FLOW_INFO_EID</a> informational event message will be generated </li>
</ul>
<p>Failure to execute this command will result in:</p>
<ul>
<li>
Command error counter <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6" title="Count of failed commands. ">TO_HkTlm_t.usCmdErrCnt</a> will increment </li>
</ul>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>
Message flow not defined. The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a7d4a881e119af22f90fc0272d3968331">TO_MSG_FLOW_INFO_ERR_EID</a> error event will be sent in this case. </li>
<li>
Command packet length not as expected </li>
<li>
Invalid channel specified </li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#a4770be96c1dadc1afbcbee1626ba2c26">TO_QUERY_PRIORITY_QUEUE_CC</a></p>
<h2>Query Output Channel </h2>
<p>This command queries a specified a specified output channel. Querying will not change any downlink behavior. A <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a6a3a6a37acad171e300289e0ac97422a">TO_OUT_CH_INFO_EID</a> informational event will be generated containing all the ouput channel diagnostic details including:</p>
<ul>
<li>
State </li>
<li>
Queue Depth </li>
<li>
Sent Count </li>
<li>
Currently Queued Count </li>
<li>
Highwater Mark for Queued Count </li>
</ul>
<p>Successful execution of this command may be verified with the following telemetry:</p>
<ul>
<li>
Command counter <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> will increment </li>
<li>
The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568a6a3a6a37acad171e300289e0ac97422a">TO_OUT_CH_INFO_EID</a> event is sent </li>
</ul>
<p>Failure to execute this command will result in:</p>
<ul>
<li>
Command error counter <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6" title="Count of failed commands. ">TO_HkTlm_t.usCmdErrCnt</a> will increment </li>
</ul>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>
Command packet length not as expected </li>
<li>
Invalid channel specified </li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#a111c03e1b26ccbc76b1d3f6e443c71d8">TO_QUERY_OUTPUT_CHANNEL_CC</a></p>
<h2>Send Diagnostic </h2>
<p>This command sends the full diagnostic data for TO to the SB. This includes the data that is sent from the <a class="el" href="to__msg_8h.html#a111c03e1b26ccbc76b1d3f6e443c71d8">TO_QUERY_OUTPUT_CHANNEL_CC</a> and <a class="el" href="to__msg_8h.html#a4770be96c1dadc1afbcbee1626ba2c26">TO_QUERY_PRIORITY_QUEUE_CC</a> commands, but also data on all of the message flows as well. The difference between this and the other commands is that these diagnostic packets are sent to the cFE SB, and if TO output channels include the message flows for them these diagnostic packets are sent over the downlink. The other commands send events with diagnostic data but not the packets themselves.</p>
<p>Successful execution of this command may be verified with the following telemetry:</p>
<ul>
<li>
Command counter <a class="el" href="struct_t_o___hk_tlm__t.html#a1864b6fe13642c2540ab260b32e96d2c" title="Count of accepted commands. ">TO_HkTlm_t.usCmdCnt</a> will increment </li>
<li>
The <a class="el" href="to__events_8h.html#af7348e55d652f8bd583ec57dd3cdf568ab4ff33847983f2b3ba4041b98290f552">TO_CMD_SEND_DIAG_EID</a> event is sent </li>
</ul>
<p>Failure to execute this command will result in:</p>
<ul>
<li>
Command error counter <a class="el" href="struct_t_o___hk_tlm__t.html#a4dbb975c4c71d1cc9e7fd5df3b833ec6" title="Count of failed commands. ">TO_HkTlm_t.usCmdErrCnt</a> will increment </li>
</ul>
<p>This command may fail for the following reason(s):</p>
<ul>
<li>
Command packet length not as expected </li>
<li>
Invalid channel specified </li>
</ul>
<p>See also: <a class="el" href="to__msg_8h.html#a7e0a1c3085e0a6c1cd28b2507369165a">TO_SEND_DIAG_CC</a></p>
<p>Next: <a class="el" href="cfstoreq.html">TO Application Requirements</a> <br />
 Prev: <a class="el" href="cfstoovr.html">TO Application Overview</a></p>
<h2>3. Message Flow Overflows </h2>
<p>The CFE Software Bus provides the pipe for the Message Flows. If a message is published at a faster rate than the TO executive is cycling and over flows the Message Flow message limit, the CFE Software Bus Message Limit counter will increment. This is not necessarily a problem, depending on the TO configuration design. But if the TO configuration is tuned such that the TO executive can process telemetry faster than any publisher can publish the messages, the Message Limit counter should not increment.</p>
<h2>4. Priority and Output Queue Overflow </h2>
<p>Priority Queue and Output Queues can overflow for multiple reasons. Neither of which is necessarily a problem, depending on the TO configuration. The TO prioritization algorithm is designed to be resilient to queue overflow.</p>
<p>If messages come in faster than the TO output task can transmit the messages, the Output Queue will begin to backup. Messages will not move from Priority Queue to Output Queue when the Output Queue is full. The messages in the Priority Queue will not get dropped. They just won't move until the Output Queue frees up room again.</p>
<p>A combination of message coming in faster than the TO executive cycles and Priority Queues sized to small to accomodate the fast incoming messages, will result in Priority Queues filling up. Congested Priority Queues can cause lower priority Priority Queues to not get serviced fully.</p>
<p>Ideally, Priority Queues should be sized to accomodate nominal message bursts. "Nominal" is subjective and depends on the mission. If too small, Priority Queues cannot accomodate bursty traffic as well and require TO executive to execute at a faster rate to avoid dropping messages. If too big, the telemetry downlink can buffer too much data, increasing the latency of transmitted data.</p>
<p>Ideally, Output Queues should be sized to make maximum use of throughput. Output Queues should not be so large that they buffer large amounts of data, and should not be so small that the output task empties the queue, resulting in wait states on the telemetry downlink.</p>
<p>Ideally, the TO executive should be scheduled at a rate that results in minimum dropped messages. If scheduled too fast, context switching can have negative impacts to performance. If schedule too slow, the queueing mechanisms handles bursty message traffic less efficiently and can result in increased CFE Software Bus Message Limit counter increment, and both Priority and Output queue dropped messages.</p>
<p>Use the Highwater telemetry, dropped messages counts, and memory allocation metrics in TO HK and TO diagmostic messgaes to better improve the configuration tuning.</p>
<ol type="1">
<li>Configuration Tips</li>
</ol>
<ul>
<li>If CFE Software Bus Message Limit is constantly increasing due to TO Message Flows and you want to make that stop, increase the rate that the TO executive is scheduled by SCH. The faster it executes, the faster it can service the CFE Software Bus pipes and the better TO can accomodate fast or bursty traffic.</li>
<li>If the message input rate exceeds the rate that the output task can transmit messages, messages will always be dropped. If TO executive cycles at a fast enough rate to prevent CFE Software Bus Message Limit increments, the Classifier will eventually start dropping messages as the Output Queue backs up, causing the Priority Queues to back up and eventually fill up.</li>
<li>If the Output Queue Highwater mark shows it is regularly full, but the Priority Queues are not full, you may want to increase the Output Queue size. If the Priority Queues are not filling up, the Output Queue may just be bursty and emptying out faster than the HK or diag message can show it. If so, the output task may be running into wait states while it waits for more messages to show up in the Output Queue.</li>
<li>If the Output Queue Highwater mark is regularly very low, your Output task may be experiencing excessive wait states, as the Output Queue runs dry. If CFE Software Bus Message Limit and TO dropped message counters are not incrementing, TO is just under utilized and telemetry is flowing as fast as it needs to go. If, however, Message Limit or TO dropped message counters are incrementing, the TO configuration may be getting bursts of messages that it is not configured to handle. Consider increasing the TO executive scheduled rate and/or increasing Priority Queues to accomodate the bursts.</li>
<li>Message Flow message limits cannot be adjusted directly. However, they can be changed by sending the commands to remove a message flow, followed by add a message flow.</li>
<li>You may have Message Flows configured for a nominal rate or burst of messages, but occasionally have the need to allow a temporary large burst of messages through. For example, CFE EVS messages are often bursty. For example, you may have a configuration that limits CFE EVS messages to bursts of 4, but you may be about to send a command to an application that will result in a burst of 30 event messages that you want to get through. In this case, you can remove the message flow, and readd the message flow with a limit of 30. Then after the command is sent and the 30 events are transmitted, you can remove the message flow, and readd it back to its original message limit.</li>
<li>Leave the highest and lowest Priority Queues empty. This gives the ground the ability to command a message flow to a higher or lower priority than all other messages.</li>
<li>Leave every other Priority Queue empty. This gives the ground more flexibility to command message flows to various interleaved priorities.</li>
<li>The more Priority Queues you have, the finer granularity you have to interleaving messages between each other by priority class. You could have 2 Priority Queues: High and Low. You could have a Priority Queue for each message, giving you maximum control over message priority and preemption. message </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
